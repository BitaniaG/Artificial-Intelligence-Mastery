[0m21:51:37.525626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B7383B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B7383950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B7383610>]}


============================== 21:51:37.633221 | 3a255a28-bf8b-4728-9aeb-1b8c1787fb9e ==============================
[0m21:51:37.633221 [info ] [MainThread]: Running with dbt=1.11.2
[0m21:51:37.633221 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m21:51:37.914872 [info ] [MainThread]: dbt version: 1.11.2
[0m21:51:37.914872 [info ] [MainThread]: python version: 3.11.9
[0m21:51:37.914872 [info ] [MainThread]: python path: C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\scripts\python.exe
[0m21:51:37.914872 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m21:51:38.559796 [info ] [MainThread]: Using profiles dir at .
[0m21:51:38.575419 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m21:51:38.575419 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\dbt_project.yml
[0m21:51:38.584204 [info ] [MainThread]: adapter type: postgres
[0m21:51:38.586196 [info ] [MainThread]: adapter version: 1.10.0
[0m21:51:38.846647 [info ] [MainThread]: Configuration:
[0m21:51:38.846647 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:51:38.846647 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:51:38.846647 [info ] [MainThread]: Required dependencies:
[0m21:51:38.846647 [debug] [MainThread]: Executing "git --help"
[0m21:51:39.263309 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:51:39.263309 [debug] [MainThread]: STDERR: "b''"
[0m21:51:39.263309 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:51:39.263309 [info ] [MainThread]: Connection:
[0m21:51:39.263309 [info ] [MainThread]:   host: localhost
[0m21:51:39.263309 [info ] [MainThread]:   port: 5433
[0m21:51:39.278933 [info ] [MainThread]:   user: postgres
[0m21:51:39.281587 [info ] [MainThread]:   database: medical_warehouse
[0m21:51:39.283140 [info ] [MainThread]:   schema: staging
[0m21:51:39.286822 [info ] [MainThread]:   connect_timeout: 10
[0m21:51:39.288814 [info ] [MainThread]:   role: None
[0m21:51:39.290813 [info ] [MainThread]:   search_path: None
[0m21:51:39.291572 [info ] [MainThread]:   keepalives_idle: 0
[0m21:51:39.293575 [info ] [MainThread]:   sslmode: None
[0m21:51:39.295568 [info ] [MainThread]:   sslcert: None
[0m21:51:39.298558 [info ] [MainThread]:   sslkey: None
[0m21:51:39.301552 [info ] [MainThread]:   sslrootcert: None
[0m21:51:39.304461 [info ] [MainThread]:   application_name: dbt
[0m21:51:39.305904 [info ] [MainThread]:   retries: 1
[0m21:51:39.308277 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:51:40.374833 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m21:51:40.980088 [debug] [MainThread]: Using postgres connection "debug"
[0m21:51:40.982081 [debug] [MainThread]: On debug: select 1 as id
[0m21:51:40.983114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:41.658627 [debug] [MainThread]: SQL status: SELECT 1 in 0.675 seconds
[0m21:51:41.660656 [debug] [MainThread]: On debug: Close
[0m21:51:41.661618 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:51:41.663386 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:51:41.663386 [debug] [MainThread]: Command `dbt debug` succeeded at 21:51:41.663386 after 4.84 seconds
[0m21:51:41.663386 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:51:41.663386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B8707C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B737F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223B85BAED0>]}
[0m21:51:41.663386 [debug] [MainThread]: Flushing usage events
[0m21:51:45.596920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:04:31.719375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC53ECF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5A5C7690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5A5C7590>]}


============================== 22:04:31.753837 | d094c581-148e-4ef7-9b85-e0d88d264307 ==============================
[0m22:04:31.753837 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:04:31.753837 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt ls', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m22:04:33.095541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd094c581-148e-4ef7-9b85-e0d88d264307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC59CF5310>]}
[0m22:04:33.204889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd094c581-148e-4ef7-9b85-e0d88d264307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC56D8A210>]}
[0m22:04:33.204889 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:04:34.049839 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m22:04:34.049839 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:04:34.049839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd094c581-148e-4ef7-9b85-e0d88d264307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5B81DE50>]}
[0m22:04:35.798450 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.medical_warehouse.staging
- models.medical_warehouse.marts
[0m22:04:35.813961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd094c581-148e-4ef7-9b85-e0d88d264307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5A5F9B10>]}
[0m22:04:35.935246 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m22:04:36.075842 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m22:04:36.563060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd094c581-148e-4ef7-9b85-e0d88d264307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5BB84390>]}
[0m22:04:36.564133 [info ] [MainThread]: Found 464 macros
[0m22:04:36.566129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd094c581-148e-4ef7-9b85-e0d88d264307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5BA67110>]}
[0m22:04:36.567161 [warn ] [MainThread]: No nodes selected!
[0m22:04:36.571116 [debug] [MainThread]: Command `dbt ls` succeeded at 22:04:36.571116 after 5.20 seconds
[0m22:04:36.572116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5A56A550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5A569010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5A305950>]}
[0m22:04:36.573113 [debug] [MainThread]: Flushing usage events
[0m22:04:42.201878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:01.423691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA77C27590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA77C5E3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA77C8AED0>]}


============================== 22:40:01.565258 | 8789036b-4f72-49b8-ac5c-271d30b2430e ==============================
[0m22:40:01.565258 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:40:01.568254 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'invocation_command': 'dbt run --select stg_telegram_messages', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m22:40:04.705673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8789036b-4f72-49b8-ac5c-271d30b2430e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA78E974D0>]}
[0m22:40:04.813945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8789036b-4f72-49b8-ac5c-271d30b2430e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA7445A1D0>]}
[0m22:40:04.813945 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:40:05.533916 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m22:40:07.737359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:40:07.737359 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://models\staging\stg_telegram_messages.sql
[0m22:40:08.361497 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m22:40:08.361497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8789036b-4f72-49b8-ac5c-271d30b2430e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA78EA3190>]}
[0m22:40:08.529473 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m22:40:08.561188 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m22:40:10.278979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8789036b-4f72-49b8-ac5c-271d30b2430e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA793D9F50>]}
[0m22:40:10.279983 [info ] [MainThread]: Found 1 model, 464 macros
[0m22:40:10.281186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8789036b-4f72-49b8-ac5c-271d30b2430e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA78DC1E10>]}
[0m22:40:10.284325 [info ] [MainThread]: 
[0m22:40:10.285919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:40:10.287918 [info ] [MainThread]: 
[0m22:40:10.289916 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:40:10.346361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m22:40:11.590884 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m22:40:11.591881 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m22:40:11.592879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:13.252236 [debug] [ThreadPool]: SQL status: SELECT 7 in 1.665 seconds
[0m22:40:13.252236 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m22:40:13.283383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse, now create_medical_warehouse_staging_staging)
[0m22:40:13.299041 [debug] [ThreadPool]: Creating schema "database: "medical_warehouse"
schema: "staging_staging"
"
[0m22:40:13.315374 [debug] [ThreadPool]: Using postgres connection "create_medical_warehouse_staging_staging"
[0m22:40:13.315374 [debug] [ThreadPool]: On create_medical_warehouse_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "create_medical_warehouse_staging_staging"} */
create schema if not exists "staging_staging"
[0m22:40:13.315374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:40:13.924332 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.605 seconds
[0m22:40:13.924332 [debug] [ThreadPool]: On create_medical_warehouse_staging_staging: COMMIT
[0m22:40:13.924332 [debug] [ThreadPool]: Using postgres connection "create_medical_warehouse_staging_staging"
[0m22:40:13.924332 [debug] [ThreadPool]: On create_medical_warehouse_staging_staging: COMMIT
[0m22:40:13.955563 [debug] [ThreadPool]: SQL status: COMMIT in 0.035 seconds
[0m22:40:13.955563 [debug] [ThreadPool]: On create_medical_warehouse_staging_staging: Close
[0m22:40:13.955563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_staging_staging'
[0m22:40:13.971126 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_staging_staging"
[0m22:40:13.971126 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_staging_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m22:40:13.971126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:40:14.721568 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.741 seconds
[0m22:40:14.721568 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: ROLLBACK
[0m22:40:14.721568 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: Close
[0m22:40:14.737042 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:14.737042 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:40:14.737042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:15.128160 [debug] [MainThread]: SQL status: SELECT 0 in 0.396 seconds
[0m22:40:15.128160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8789036b-4f72-49b8-ac5c-271d30b2430e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA78EBF5D0>]}
[0m22:40:15.128160 [debug] [MainThread]: On master: ROLLBACK
[0m22:40:15.128160 [debug] [MainThread]: On master: COMMIT
[0m22:40:15.143694 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:15.143694 [debug] [MainThread]: On master: COMMIT
[0m22:40:15.143694 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:40:15.143694 [debug] [MainThread]: On master: Close
[0m22:40:15.479000 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m22:40:15.479000 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_staging.stg_telegram_messages .............. [RUN]
[0m22:40:15.479000 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m22:40:15.479000 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m22:40:15.514441 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m22:40:15.544351 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m22:40:15.646918 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m22:40:15.767675 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m22:40:15.767675 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."staging_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select
        message_id,
        channel_name,
        message_date,
        message_text,
        has_media,
        media_type,
        scraped_at
    from raw.telegram_messages

),

cleaned as (

    select
        cast(message_id as bigint)              as message_id,
        trim(channel_name)                      as channel_name,
        cast(message_date as timestamp)         as message_date,
        nullif(trim(message_text), '')          as message_text,
        cast(has_media as boolean)              as has_media,
        lower(trim(media_type))                 as media_type,
        cast(scraped_at as timestamp)           as scraped_at
    from source

)

select *
from cleaned
  );
[0m22:40:15.767675 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:40:17.479367 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "has_media" does not exist
LINE 14:         has_media,
                 ^

[0m22:40:17.479367 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: ROLLBACK
[0m22:40:17.479367 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m22:40:18.346309 [debug] [Thread-1 (]: Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  column "has_media" does not exist
  LINE 14:         has_media,
                   ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m22:40:18.346309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8789036b-4f72-49b8-ac5c-271d30b2430e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA793E82D0>]}
[0m22:40:18.361837 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model staging_staging.stg_telegram_messages ..... [[31mERROR[0m in 2.87s]
[0m22:40:18.361837 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m22:40:18.361837 [debug] [Thread-7 (]: Marking all children of 'model.medical_warehouse.stg_telegram_messages' to be skipped because of status 'error'.  Reason: Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  column "has_media" does not exist
  LINE 14:         has_media,
                   ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql.
[0m22:40:18.398175 [debug] [MainThread]: On master: COMMIT
[0m22:40:18.399172 [debug] [MainThread]: Using postgres connection "master"
[0m22:40:18.400169 [debug] [MainThread]: On master: COMMIT
[0m22:40:18.401166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:18.630208 [debug] [MainThread]: SQL status: COMMIT in 0.243 seconds
[0m22:40:18.630208 [debug] [MainThread]: On master: Close
[0m22:40:18.646489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:18.646489 [debug] [MainThread]: Connection 'create_medical_warehouse_staging_staging' was properly closed.
[0m22:40:18.646489 [debug] [MainThread]: Connection 'list_medical_warehouse_staging_staging' was properly closed.
[0m22:40:18.646489 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m22:40:18.646489 [info ] [MainThread]: 
[0m22:40:18.646489 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m22:40:18.646489 [debug] [MainThread]: Command end result
[0m22:40:18.714645 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m22:40:18.718632 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m22:40:18.732464 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m22:40:18.733504 [info ] [MainThread]: 
[0m22:40:18.734465 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:40:18.736461 [info ] [MainThread]: 
[0m22:40:18.737461 [error] [MainThread]: [31mFailure in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)[0m
[0m22:40:18.739454 [error] [MainThread]:   Database Error in model stg_telegram_messages (models\staging\stg_telegram_messages.sql)
  column "has_media" does not exist
  LINE 14:         has_media,
                   ^
  compiled code at target\run\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m22:40:18.742506 [info ] [MainThread]: 
[0m22:40:18.743502 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\stg_telegram_messages.sql
[0m22:40:18.744467 [info ] [MainThread]: 
[0m22:40:18.745898 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m22:40:18.748895 [debug] [MainThread]: Command `dbt run` failed at 22:40:18.748895 after 17.94 seconds
[0m22:40:18.749893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA77C2A190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA768719D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA70F65390>]}
[0m22:40:18.752263 [debug] [MainThread]: Flushing usage events
[0m22:40:25.560691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:48:15.690972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDE36A910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDE368950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDE3CB750>]}


============================== 22:48:15.783480 | 380c0550-100b-4c26-974b-086f2e1c65d8 ==============================
[0m22:48:15.783480 [info ] [MainThread]: Running with dbt=1.11.2
[0m22:48:15.783480 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_telegram_messages', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m22:48:17.861593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '380c0550-100b-4c26-974b-086f2e1c65d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDF4A0F90>]}
[0m22:48:18.007193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '380c0550-100b-4c26-974b-086f2e1c65d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDAB98210>]}
[0m22:48:18.007193 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m22:48:18.909274 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m22:48:19.455521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:48:19.455521 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\staging\stg_telegram_messages.sql
[0m22:48:19.940634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m22:48:19.940634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '380c0550-100b-4c26-974b-086f2e1c65d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDF585D90>]}
[0m22:48:20.092648 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m22:48:20.108340 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m22:48:20.376901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '380c0550-100b-4c26-974b-086f2e1c65d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDFAC71D0>]}
[0m22:48:20.376901 [info ] [MainThread]: Found 1 model, 464 macros
[0m22:48:20.392432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '380c0550-100b-4c26-974b-086f2e1c65d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDE367D90>]}
[0m22:48:20.392432 [info ] [MainThread]: 
[0m22:48:20.392432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:48:20.398827 [info ] [MainThread]: 
[0m22:48:20.401264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:48:20.416280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m22:48:20.762570 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m22:48:20.763567 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m22:48:20.763567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:21.252575 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.496 seconds
[0m22:48:21.252575 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m22:48:21.252575 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_staging_staging'
[0m22:48:21.268122 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_staging_staging"
[0m22:48:21.268122 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_staging_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m22:48:21.268122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:21.549012 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.282 seconds
[0m22:48:21.564560 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: ROLLBACK
[0m22:48:21.564560 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: Close
[0m22:48:21.564560 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:21.564560 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m22:48:21.564560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:48:21.799111 [debug] [MainThread]: SQL status: SELECT 0 in 0.228 seconds
[0m22:48:21.799111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '380c0550-100b-4c26-974b-086f2e1c65d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDF621F90>]}
[0m22:48:21.799111 [debug] [MainThread]: On master: ROLLBACK
[0m22:48:21.799111 [debug] [MainThread]: On master: COMMIT
[0m22:48:21.799111 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:21.799111 [debug] [MainThread]: On master: COMMIT
[0m22:48:21.814628 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:48:21.814628 [debug] [MainThread]: On master: Close
[0m22:48:21.924169 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m22:48:21.924169 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_staging.stg_telegram_messages .............. [RUN]
[0m22:48:21.924169 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m22:48:21.924169 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m22:48:21.945060 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m22:48:21.948103 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m22:48:22.010984 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m22:48:22.010984 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m22:48:22.026609 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."staging_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select
        message_id,
        channel_name,
        message_date,
        sender_id,
        message_text,
        raw_json
    from raw.telegram_messages

),

cleaned as (

    select
        cast(message_id as bigint)              as message_id,
        trim(channel_name)                      as channel_name,
        cast(message_date as timestamp)         as message_date,
        cast(sender_id as bigint)               as sender_id,
        nullif(trim(message_text), '')          as message_text,
        raw_json                                as raw_json
    from source

)

select *
from cleaned
  );
[0m22:48:22.026609 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:48:22.643132 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.621 seconds
[0m22:48:22.658660 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m22:48:22.658660 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."staging_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m22:48:22.742838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.081 seconds
[0m22:48:22.774124 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m22:48:22.774124 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m22:48:22.774124 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m22:48:22.774124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:48:22.789702 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."staging_staging"."stg_telegram_messages__dbt_backup"
[0m22:48:22.789702 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m22:48:22.789702 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_warehouse"."staging_staging"."stg_telegram_messages__dbt_backup" cascade
[0m22:48:22.830472 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.030 seconds
[0m22:48:22.830472 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m22:48:22.861851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '380c0550-100b-4c26-974b-086f2e1c65d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDF5F5810>]}
[0m22:48:22.861851 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_staging.stg_telegram_messages ......... [[32mCREATE VIEW[0m in 0.91s]
[0m22:48:22.861851 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m22:48:22.880348 [debug] [MainThread]: On master: COMMIT
[0m22:48:22.881339 [debug] [MainThread]: Using postgres connection "master"
[0m22:48:22.883299 [debug] [MainThread]: On master: COMMIT
[0m22:48:22.884643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:48:23.007352 [debug] [MainThread]: SQL status: COMMIT in 0.135 seconds
[0m22:48:23.007352 [debug] [MainThread]: On master: Close
[0m22:48:23.007352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:23.022975 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m22:48:23.022975 [debug] [MainThread]: Connection 'list_medical_warehouse_staging_staging' was properly closed.
[0m22:48:23.022975 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m22:48:23.049213 [info ] [MainThread]: 
[0m22:48:23.049213 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.62 seconds (2.62s).
[0m22:48:23.049213 [debug] [MainThread]: Command end result
[0m22:48:23.111029 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m22:48:23.111029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m22:48:23.127138 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m22:48:23.127138 [info ] [MainThread]: 
[0m22:48:23.127138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:48:23.127138 [info ] [MainThread]: 
[0m22:48:23.144036 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:48:23.147134 [debug] [MainThread]: Command `dbt run` succeeded at 22:48:23.147134 after 7.84 seconds
[0m22:48:23.149128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DDD4AEE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD7973090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD76B5190>]}
[0m22:48:23.151125 [debug] [MainThread]: Flushing usage events
[0m22:48:26.541992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:13.807884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7E8078D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7E7DE510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7E7DE6D0>]}


============================== 10:33:13.862119 | d292b095-beb3-4ca4-90d8-5d503e1f5f58 ==============================
[0m10:33:13.862119 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:33:13.866795 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_telegram_messages --profiles-dir .', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m10:33:17.379032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd292b095-beb3-4ca4-90d8-5d503e1f5f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7E7A8590>]}
[0m10:33:17.593075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd292b095-beb3-4ca4-90d8-5d503e1f5f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7AFC2890>]}
[0m10:33:17.597664 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:33:20.412992 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:33:26.283366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:26.283366 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:33:26.283366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:26.308454 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m10:33:26.621426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd292b095-beb3-4ca4-90d8-5d503e1f5f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7FD2D350>]}
[0m10:33:26.891896 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:33:26.966884 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:33:28.526928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd292b095-beb3-4ca4-90d8-5d503e1f5f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7FD36E90>]}
[0m10:33:28.528925 [info ] [MainThread]: Found 1 model, 464 macros
[0m10:33:28.528925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd292b095-beb3-4ca4-90d8-5d503e1f5f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7FC7B3D0>]}
[0m10:33:28.537607 [info ] [MainThread]: 
[0m10:33:28.541209 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:33:28.545075 [info ] [MainThread]: 
[0m10:33:28.550982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:28.688956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m10:33:31.216977 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m10:33:31.219947 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:33:31.220945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:31.921736 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.698 seconds
[0m10:33:31.925821 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m10:33:31.932039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_staging_staging'
[0m10:33:31.960596 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_staging_staging"
[0m10:33:31.961879 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_staging_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m10:33:31.961879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:32.586782 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.622 seconds
[0m10:33:32.591822 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: ROLLBACK
[0m10:33:32.594816 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: Close
[0m10:33:32.616127 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:32.620745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:33:32.622959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:33.013461 [debug] [MainThread]: SQL status: SELECT 1 in 0.391 seconds
[0m10:33:33.017429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd292b095-beb3-4ca4-90d8-5d503e1f5f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7FC82350>]}
[0m10:33:33.020406 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:33.022718 [debug] [MainThread]: On master: COMMIT
[0m10:33:33.024765 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:33.024765 [debug] [MainThread]: On master: COMMIT
[0m10:33:33.028089 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:33:33.031175 [debug] [MainThread]: On master: Close
[0m10:33:33.237800 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m10:33:33.240860 [info ] [Thread-1 (]: 1 of 1 START sql view model staging_staging.stg_telegram_messages .............. [RUN]
[0m10:33:33.241908 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m10:33:33.247640 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m10:33:33.286387 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m10:33:33.292956 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m10:33:33.557742 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m10:33:33.561995 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m10:33:33.563973 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."staging_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select
        message_id,
        channel_name,
        message_date,
        sender_id,
        message_text,
        raw_json
    from raw.telegram_messages

),

cleaned as (

    select
        cast(message_id as bigint)              as message_id,
        trim(channel_name)                      as channel_name,
        cast(message_date as timestamp)         as message_date,
        cast(sender_id as bigint)               as sender_id,
        nullif(trim(message_text), '')          as message_text,
        raw_json                                as raw_json
    from source

)

select *
from cleaned
  );
[0m10:33:33.563973 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:33:34.354540 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.790 seconds
[0m10:33:34.380349 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m10:33:34.383735 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."staging_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m10:33:34.407637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m10:33:34.417971 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m10:33:34.420607 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."staging_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m10:33:34.442758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m10:33:34.490382 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m10:33:34.490382 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m10:33:34.490382 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m10:33:34.495972 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:34.511254 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."staging_staging"."stg_telegram_messages__dbt_backup"
[0m10:33:34.524797 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m10:33:34.525794 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_warehouse"."staging_staging"."stg_telegram_messages__dbt_backup" cascade
[0m10:33:34.699156 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.173 seconds
[0m10:33:34.707633 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m10:33:34.715191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd292b095-beb3-4ca4-90d8-5d503e1f5f58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E00206250>]}
[0m10:33:34.716189 [info ] [Thread-1 (]: 1 of 1 OK created sql view model staging_staging.stg_telegram_messages ......... [[32mCREATE VIEW[0m in 1.47s]
[0m10:33:34.721837 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m10:33:34.813498 [debug] [MainThread]: On master: COMMIT
[0m10:33:34.815455 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:34.817451 [debug] [MainThread]: On master: COMMIT
[0m10:33:34.822278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:34.964224 [debug] [MainThread]: SQL status: COMMIT in 0.142 seconds
[0m10:33:34.966220 [debug] [MainThread]: On master: Close
[0m10:33:34.967796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:34.969145 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m10:33:34.969947 [debug] [MainThread]: Connection 'list_medical_warehouse_staging_staging' was properly closed.
[0m10:33:34.970947 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m10:33:34.982771 [info ] [MainThread]: 
[0m10:33:34.982771 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.42 seconds (6.42s).
[0m10:33:34.987825 [debug] [MainThread]: Command end result
[0m10:33:35.063323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:33:35.070628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:33:35.086728 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m10:33:35.087757 [info ] [MainThread]: 
[0m10:33:35.088758 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:35.088758 [info ] [MainThread]: 
[0m10:33:35.088758 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:33:35.094766 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:35.094766 after 21.91 seconds
[0m10:33:35.096643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7FA09410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E00643E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015E7F9FD450>]}
[0m10:33:35.098246 [debug] [MainThread]: Flushing usage events
[0m10:33:37.666043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:34:48.095313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6425A85D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B64224BF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6425AAB90>]}


============================== 10:34:48.102100 | 73649012-6fe5-49c3-9978-03bf634dbe82 ==============================
[0m10:34:48.102100 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:34:48.106374 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test --select stg_telegram_messages --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m10:34:48.589174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73649012-6fe5-49c3-9978-03bf634dbe82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6437B8910>]}
[0m10:34:48.760539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73649012-6fe5-49c3-9978-03bf634dbe82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B63EDD8790>]}
[0m10:34:48.763054 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:34:49.350482 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:34:49.540781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:34:49.540781 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:34:49.544854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:34:49.552499 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m10:34:49.610635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73649012-6fe5-49c3-9978-03bf634dbe82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B643A98D10>]}
[0m10:34:49.752204 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:34:49.757245 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:34:49.889110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73649012-6fe5-49c3-9978-03bf634dbe82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B643D22D90>]}
[0m10:34:49.890650 [info ] [MainThread]: Found 1 model, 464 macros
[0m10:34:49.891648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73649012-6fe5-49c3-9978-03bf634dbe82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6425A87D0>]}
[0m10:34:49.894676 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:34:49.901233 [debug] [MainThread]: Command end result
[0m10:34:49.957448 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:34:49.962225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:34:49.980878 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m10:34:49.984854 [debug] [MainThread]: Command `dbt test` succeeded at 10:34:49.984854 after 2.08 seconds
[0m10:34:49.984854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6416EF290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B63B935110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B63B934D90>]}
[0m10:34:49.987700 [debug] [MainThread]: Flushing usage events
[0m10:34:51.966063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:41:08.369217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3BBA6950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3BBD5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3BBD6C50>]}


============================== 10:41:08.429394 | f51511f0-6ba0-4570-ab36-ef44a000e8d2 ==============================
[0m10:41:08.429394 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:41:08.438874 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt test --select stg_telegram_messages --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m10:41:10.167913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f51511f0-6ba0-4570-ab36-ef44a000e8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3BBA6510>]}
[0m10:41:10.349227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f51511f0-6ba0-4570-ab36-ef44a000e8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D383C2990>]}
[0m10:41:10.353397 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:41:11.551672 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:41:12.818774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:41:12.821470 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://models\staging\schema.yml
[0m10:41:13.457552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m10:41:13.472727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f51511f0-6ba0-4570-ab36-ef44a000e8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3D319450>]}
[0m10:41:13.874232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:41:13.905373 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:41:14.589704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f51511f0-6ba0-4570-ab36-ef44a000e8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3CDB59D0>]}
[0m10:41:14.590736 [info ] [MainThread]: Found 1 model, 4 data tests, 464 macros
[0m10:41:14.592359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f51511f0-6ba0-4570-ab36-ef44a000e8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3CE04110>]}
[0m10:41:14.594672 [info ] [MainThread]: 
[0m10:41:14.597601 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:41:14.601395 [info ] [MainThread]: 
[0m10:41:14.603496 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:41:14.667904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_staging_staging'
[0m10:41:14.957653 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_staging_staging"
[0m10:41:14.957653 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_staging_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'staging_staging'
  
[0m10:41:14.966313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:41:15.592028 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.625 seconds
[0m10:41:15.597137 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: ROLLBACK
[0m10:41:15.612659 [debug] [ThreadPool]: On list_medical_warehouse_staging_staging: Close
[0m10:41:15.643267 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:15.649486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:41:15.652989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:41:15.904420 [debug] [MainThread]: SQL status: SELECT 1 in 0.252 seconds
[0m10:41:15.908798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f51511f0-6ba0-4570-ab36-ef44a000e8d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3D29AFD0>]}
[0m10:41:15.911415 [debug] [MainThread]: On master: ROLLBACK
[0m10:41:15.914364 [debug] [MainThread]: On master: COMMIT
[0m10:41:15.916320 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:15.918763 [debug] [MainThread]: On master: COMMIT
[0m10:41:15.921880 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:41:15.922807 [debug] [MainThread]: On master: Close
[0m10:41:15.966282 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:41:15.968490 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:41:15.970488 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:41:15.971484 [debug] [Thread-4 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:41:15.973159 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_telegram_messages_channel_name .................. [RUN]
[0m10:41:15.975670 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_telegram_messages_message_date .................. [RUN]
[0m10:41:15.977699 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_telegram_messages_message_id .................... [RUN]
[0m10:41:15.983639 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8'
[0m10:41:15.978728 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_telegram_messages_message_id ...................... [RUN]
[0m10:41:15.986572 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14'
[0m10:41:15.998932 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:41:15.990275 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6'
[0m10:41:15.994540 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1'
[0m10:41:15.990275 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:41:16.064499 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:41:16.078616 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m10:41:16.078616 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:41:16.089110 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m10:41:16.101352 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m10:41:16.116142 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m10:41:16.129127 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:41:16.129928 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:41:16.147420 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:41:16.159725 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m10:41:16.165522 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:41:16.172594 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m10:41:16.177967 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m10:41:16.183163 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m10:41:16.209871 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m10:41:16.215116 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m10:41:16.217346 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "medical_warehouse"."staging_staging"."stg_telegram_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m10:41:16.219580 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."staging_staging"."stg_telegram_messages"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m10:41:16.221833 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:41:16.223288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:41:16.229550 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m10:41:16.232864 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m10:41:16.234126 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_warehouse"."staging_staging"."stg_telegram_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m10:41:16.236068 [debug] [Thread-4 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "medical_warehouse"."staging_staging"."stg_telegram_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:41:16.238619 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:41:16.240905 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:41:18.103100 [debug] [Thread-1 (]: SQL status: SELECT 1 in 1.880 seconds
[0m10:41:18.132721 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m10:41:18.138898 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m10:41:18.142589 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_telegram_messages_channel_name ........................ [[32mPASS[0m in 2.16s]
[0m10:41:18.145741 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:41:18.175337 [debug] [Thread-3 (]: SQL status: SELECT 1 in 1.936 seconds
[0m10:41:18.177686 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.953 seconds
[0m10:41:18.185343 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m10:41:18.193081 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: ROLLBACK
[0m10:41:18.196900 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m10:41:18.198943 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: Close
[0m10:41:18.200939 [error] [Thread-3 (]: 3 of 4 FAIL 400 not_null_stg_telegram_messages_message_id ...................... [[31mFAIL 400[0m in 2.21s]
[0m10:41:18.210316 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:41:18.206338 [error] [Thread-2 (]: 2 of 4 FAIL 400 not_null_stg_telegram_messages_message_date .................... [[31mFAIL 400[0m in 2.22s]
[0m10:41:18.213681 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:41:18.288037 [debug] [Thread-4 (]: SQL status: SELECT 1 in 2.047 seconds
[0m10:41:18.293090 [debug] [Thread-4 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: ROLLBACK
[0m10:41:18.296395 [debug] [Thread-4 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: Close
[0m10:41:18.300238 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_telegram_messages_message_id ............................ [[32mPASS[0m in 2.30s]
[0m10:41:18.309742 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:41:18.325888 [debug] [MainThread]: On master: COMMIT
[0m10:41:18.327654 [debug] [MainThread]: Using postgres connection "master"
[0m10:41:18.329910 [debug] [MainThread]: On master: COMMIT
[0m10:41:18.331899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:41:19.323455 [debug] [MainThread]: SQL status: COMMIT in 0.991 seconds
[0m10:41:19.324587 [debug] [MainThread]: On master: Close
[0m10:41:19.325582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:41:19.327619 [debug] [MainThread]: Connection 'list_medical_warehouse_staging_staging' was properly closed.
[0m10:41:19.327619 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8' was properly closed.
[0m10:41:19.330117 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14' was properly closed.
[0m10:41:19.331974 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6' was properly closed.
[0m10:41:19.332585 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1' was properly closed.
[0m10:41:19.427889 [info ] [MainThread]: 
[0m10:41:19.435941 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m10:41:19.443579 [debug] [MainThread]: Command end result
[0m10:41:19.557323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:41:19.565610 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:41:19.587484 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m10:41:19.588479 [info ] [MainThread]: 
[0m10:41:19.591076 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:41:19.592558 [info ] [MainThread]: 
[0m10:41:19.595611 [error] [MainThread]: [31mFailure in test not_null_stg_telegram_messages_message_id (models\staging\schema.yml)[0m
[0m10:41:19.601613 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m10:41:19.605541 [info ] [MainThread]: 
[0m10:41:19.610197 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\schema.yml\not_null_stg_telegram_messages_message_id.sql
[0m10:41:19.610197 [info ] [MainThread]: 
[0m10:41:19.617528 [error] [MainThread]: [31mFailure in test not_null_stg_telegram_messages_message_date (models\staging\schema.yml)[0m
[0m10:41:19.626334 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m10:41:19.627880 [info ] [MainThread]: 
[0m10:41:19.630796 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\schema.yml\not_null_stg_telegram_messages_message_date.sql
[0m10:41:19.631792 [info ] [MainThread]: 
[0m10:41:19.631792 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m10:41:19.640569 [debug] [MainThread]: Command `dbt test` failed at 10:41:19.640569 after 12.05 seconds
[0m10:41:19.640569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D383ABE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D34EC5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D3B93B150>]}
[0m10:41:19.647806 [debug] [MainThread]: Flushing usage events
[0m10:41:24.374656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:03.122535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BD696AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BC754290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BD694750>]}


============================== 10:50:03.272275 | 85d5b8a2-c7ba-49e2-894c-90736eada06f ==============================
[0m10:50:03.272275 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:50:03.336140 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt run --select stg_telegram_messages --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m10:50:04.800096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85d5b8a2-c7ba-49e2-894c-90736eada06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BE886790>]}
[0m10:50:04.939930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85d5b8a2-c7ba-49e2-894c-90736eada06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148B9EC8710>]}
[0m10:50:04.943820 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:50:06.178490 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:50:06.581754 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:50:06.584653 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:50:06.586546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '85d5b8a2-c7ba-49e2-894c-90736eada06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BA482B10>]}
[0m10:50:09.699208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m10:50:09.704100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85d5b8a2-c7ba-49e2-894c-90736eada06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BEBA4D50>]}
[0m10:50:09.853918 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:50:09.870865 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:50:10.191975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85d5b8a2-c7ba-49e2-894c-90736eada06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BD502BD0>]}
[0m10:50:10.192550 [info ] [MainThread]: Found 1 model, 4 data tests, 464 macros
[0m10:50:10.196187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85d5b8a2-c7ba-49e2-894c-90736eada06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BECF6610>]}
[0m10:50:10.196187 [info ] [MainThread]: 
[0m10:50:10.201746 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:50:10.205148 [info ] [MainThread]: 
[0m10:50:10.208869 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:50:10.240725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m10:50:10.644285 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m10:50:10.644285 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m10:50:10.644285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:11.504312 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.855 seconds
[0m10:50:11.504312 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m10:50:11.524090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse, now create_medical_warehouse_public_staging)
[0m10:50:11.545043 [debug] [ThreadPool]: Creating schema "database: "medical_warehouse"
schema: "public_staging"
"
[0m10:50:11.550854 [debug] [ThreadPool]: Using postgres connection "create_medical_warehouse_public_staging"
[0m10:50:11.550854 [debug] [ThreadPool]: On create_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "create_medical_warehouse_public_staging"} */
create schema if not exists "public_staging"
[0m10:50:11.550854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:50:11.883779 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.320 seconds
[0m10:50:11.886697 [debug] [ThreadPool]: On create_medical_warehouse_public_staging: COMMIT
[0m10:50:11.886697 [debug] [ThreadPool]: Using postgres connection "create_medical_warehouse_public_staging"
[0m10:50:11.886697 [debug] [ThreadPool]: On create_medical_warehouse_public_staging: COMMIT
[0m10:50:11.893624 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m10:50:11.894623 [debug] [ThreadPool]: On create_medical_warehouse_public_staging: Close
[0m10:50:11.900119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m10:50:11.918788 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m10:50:11.918788 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m10:50:11.918788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:50:12.173525 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.261 seconds
[0m10:50:12.173525 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m10:50:12.190541 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m10:50:12.201816 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:12.201816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:50:12.211280 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:12.366906 [debug] [MainThread]: SQL status: SELECT 1 in 0.167 seconds
[0m10:50:12.366906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85d5b8a2-c7ba-49e2-894c-90736eada06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BD6A38D0>]}
[0m10:50:12.385471 [debug] [MainThread]: On master: ROLLBACK
[0m10:50:12.387553 [debug] [MainThread]: On master: COMMIT
[0m10:50:12.388551 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:12.390361 [debug] [MainThread]: On master: COMMIT
[0m10:50:12.392306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:50:12.393306 [debug] [MainThread]: On master: Close
[0m10:50:12.459524 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m10:50:12.462128 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_telegram_messages ............... [RUN]
[0m10:50:12.465156 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m10:50:12.466204 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m10:50:12.477935 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m10:50:12.488899 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m10:50:12.582710 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m10:50:12.591371 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m10:50:12.592370 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select
        message_id,
        channel_name,
        message_date,
        sender_id,
        message_text,
        raw_json
    from raw.telegram_messages

),

cleaned as (

    select
        cast(message_id as bigint)              as message_id,
        trim(channel_name)                      as channel_name,
        cast(message_date as timestamp)         as message_date,
        cast(sender_id as bigint)               as sender_id,
        nullif(trim(message_text), '')          as message_text,
        raw_json                                as raw_json
    from source

)

select *
from cleaned
  );
[0m10:50:12.593367 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:50:12.996316 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.403 seconds
[0m10:50:12.997313 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m10:50:13.008623 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m10:50:13.052442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.042 seconds
[0m10:50:13.071695 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m10:50:13.071695 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m10:50:13.077086 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m10:50:13.111454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.045 seconds
[0m10:50:13.138192 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_backup"
[0m10:50:13.148714 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m10:50:13.148714 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_backup" cascade
[0m10:50:13.185529 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.020 seconds
[0m10:50:13.186581 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m10:50:13.199130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85d5b8a2-c7ba-49e2-894c-90736eada06f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BEEEF710>]}
[0m10:50:13.200171 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_telegram_messages .......... [[32mCREATE VIEW[0m in 0.72s]
[0m10:50:13.205052 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m10:50:13.221736 [debug] [MainThread]: On master: COMMIT
[0m10:50:13.228052 [debug] [MainThread]: Using postgres connection "master"
[0m10:50:13.232117 [debug] [MainThread]: On master: COMMIT
[0m10:50:13.235980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:50:13.372189 [debug] [MainThread]: SQL status: COMMIT in 0.137 seconds
[0m10:50:13.374184 [debug] [MainThread]: On master: Close
[0m10:50:13.375574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:50:13.376988 [debug] [MainThread]: Connection 'create_medical_warehouse_public_staging' was properly closed.
[0m10:50:13.378285 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m10:50:13.378285 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m10:50:13.384859 [info ] [MainThread]: 
[0m10:50:13.393336 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m10:50:13.396488 [debug] [MainThread]: Command end result
[0m10:50:13.450233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:50:13.465668 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:50:13.479313 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m10:50:13.481997 [info ] [MainThread]: 
[0m10:50:13.483739 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:50:13.485256 [info ] [MainThread]: 
[0m10:50:13.486709 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:50:13.489169 [debug] [MainThread]: Command `dbt run` succeeded at 10:50:13.489169 after 10.96 seconds
[0m10:50:13.492953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BD6CDD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BD3538D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148BD694F90>]}
[0m10:50:13.493950 [debug] [MainThread]: Flushing usage events
[0m10:50:17.037161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:06.310057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2ACC47090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AC88BFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2ACBE5B50>]}


============================== 10:51:06.311055 | 84620cf6-e68f-4c70-a385-15244c0d1a15 ==============================
[0m10:51:06.311055 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:51:06.311055 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test --select stg_telegram_messages --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m10:51:06.791382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84620cf6-e68f-4c70-a385-15244c0d1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2ADD823D0>]}
[0m10:51:06.951717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84620cf6-e68f-4c70-a385-15244c0d1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A9418710>]}
[0m10:51:06.951717 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:51:07.751903 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:51:08.085291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:08.085291 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:51:08.085291 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:08.102414 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m10:51:08.203247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84620cf6-e68f-4c70-a385-15244c0d1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2ADE3EB50>]}
[0m10:51:08.385652 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:51:08.402756 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:51:08.511032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84620cf6-e68f-4c70-a385-15244c0d1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AE3BFAD0>]}
[0m10:51:08.512031 [info ] [MainThread]: Found 1 model, 4 data tests, 464 macros
[0m10:51:08.512031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84620cf6-e68f-4c70-a385-15244c0d1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AE059D50>]}
[0m10:51:08.512031 [info ] [MainThread]: 
[0m10:51:08.512031 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:51:08.523144 [info ] [MainThread]: 
[0m10:51:08.525301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:08.531864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m10:51:08.783349 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m10:51:08.783349 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m10:51:08.799426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:08.931191 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.136 seconds
[0m10:51:08.931191 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m10:51:08.931191 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m10:51:08.953972 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:08.954971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:51:08.956217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:09.077253 [debug] [MainThread]: SQL status: SELECT 2 in 0.122 seconds
[0m10:51:09.077253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84620cf6-e68f-4c70-a385-15244c0d1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AE0A3DD0>]}
[0m10:51:09.083414 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:09.083414 [debug] [MainThread]: On master: COMMIT
[0m10:51:09.083414 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:09.083414 [debug] [MainThread]: On master: COMMIT
[0m10:51:09.092549 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:09.093548 [debug] [MainThread]: On master: Close
[0m10:51:09.101583 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:51:09.101583 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:51:09.101583 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:51:09.101583 [debug] [Thread-4 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:51:09.101583 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_telegram_messages_channel_name .................. [RUN]
[0m10:51:09.110524 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_telegram_messages_message_date .................. [RUN]
[0m10:51:09.110524 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_telegram_messages_message_id .................... [RUN]
[0m10:51:09.117309 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_telegram_messages_message_id ...................... [RUN]
[0m10:51:09.120972 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8'
[0m10:51:09.121969 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14'
[0m10:51:09.121969 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6'
[0m10:51:09.121969 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1'
[0m10:51:09.121969 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:51:09.130126 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:51:09.132472 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:51:09.133477 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:51:09.222847 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m10:51:09.222847 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m10:51:09.222847 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m10:51:09.239890 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m10:51:09.258652 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:51:09.260193 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:51:09.316305 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:51:09.318301 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m10:51:09.318301 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:51:09.327722 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m10:51:09.332222 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m10:51:09.349530 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m10:51:09.365154 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m10:51:09.365154 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m10:51:09.365154 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:51:09.377196 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m10:51:09.381463 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m10:51:09.382777 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m10:51:09.382777 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m10:51:09.382777 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m10:51:09.382777 [debug] [Thread-4 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:51:09.382777 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:51:09.382777 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:51:09.382777 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:51:09.629753 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.257 seconds
[0m10:51:09.631847 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.240 seconds
[0m10:51:09.644119 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: ROLLBACK
[0m10:51:09.648397 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m10:51:09.650936 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: Close
[0m10:51:09.651964 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m10:51:09.655183 [error] [Thread-2 (]: 2 of 4 FAIL 400 not_null_stg_telegram_messages_message_date .................... [[31mFAIL 400[0m in 0.53s]
[0m10:51:09.660828 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:51:09.657174 [error] [Thread-3 (]: 3 of 4 FAIL 400 not_null_stg_telegram_messages_message_id ...................... [[31mFAIL 400[0m in 0.53s]
[0m10:51:09.664681 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:51:09.755642 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.362 seconds
[0m10:51:09.755642 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m10:51:09.755642 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m10:51:09.766075 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.370 seconds
[0m10:51:09.765079 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_telegram_messages_channel_name ........................ [[32mPASS[0m in 0.64s]
[0m10:51:09.768107 [debug] [Thread-4 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: ROLLBACK
[0m10:51:09.768107 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:51:09.768107 [debug] [Thread-4 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: Close
[0m10:51:09.768107 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_telegram_messages_message_id ............................ [[32mPASS[0m in 0.65s]
[0m10:51:09.779868 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:51:09.786805 [debug] [MainThread]: On master: COMMIT
[0m10:51:09.786805 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:09.786805 [debug] [MainThread]: On master: COMMIT
[0m10:51:09.786805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:09.905532 [debug] [MainThread]: SQL status: COMMIT in 0.112 seconds
[0m10:51:09.906529 [debug] [MainThread]: On master: Close
[0m10:51:09.906529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:09.909743 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m10:51:09.910301 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8' was properly closed.
[0m10:51:09.911298 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14' was properly closed.
[0m10:51:09.911298 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6' was properly closed.
[0m10:51:09.911298 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1' was properly closed.
[0m10:51:09.911298 [info ] [MainThread]: 
[0m10:51:09.911298 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m10:51:09.911298 [debug] [MainThread]: Command end result
[0m10:51:09.993444 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:51:10.000614 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:51:10.023557 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m10:51:10.023557 [info ] [MainThread]: 
[0m10:51:10.023557 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:51:10.031500 [info ] [MainThread]: 
[0m10:51:10.031500 [error] [MainThread]: [31mFailure in test not_null_stg_telegram_messages_message_date (models\staging\schema.yml)[0m
[0m10:51:10.031500 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m10:51:10.031500 [info ] [MainThread]: 
[0m10:51:10.041147 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\schema.yml\not_null_stg_telegram_messages_message_date.sql
[0m10:51:10.041147 [info ] [MainThread]: 
[0m10:51:10.054279 [error] [MainThread]: [31mFailure in test not_null_stg_telegram_messages_message_id (models\staging\schema.yml)[0m
[0m10:51:10.058897 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m10:51:10.059896 [info ] [MainThread]: 
[0m10:51:10.059896 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\schema.yml\not_null_stg_telegram_messages_message_id.sql
[0m10:51:10.065995 [info ] [MainThread]: 
[0m10:51:10.066996 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m10:51:10.075020 [debug] [MainThread]: Command `dbt test` failed at 10:51:10.066996 after 3.99 seconds
[0m10:51:10.078425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2AC8A3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A61F3410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A61F2ED0>]}
[0m10:51:10.081058 [debug] [MainThread]: Flushing usage events
[0m10:51:12.504406 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:51:44.945897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015208FE6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015208FE4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015208FE2F50>]}


============================== 10:51:44.946940 | 6d3c0603-04aa-438b-abd6-dee8fde1bdf5 ==============================
[0m10:51:44.946940 [info ] [MainThread]: Running with dbt=1.11.2
[0m10:51:44.958673 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt test --select stg_telegram_messages --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m10:51:45.306994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d3c0603-04aa-438b-abd6-dee8fde1bdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520A202590>]}
[0m10:51:45.425565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d3c0603-04aa-438b-abd6-dee8fde1bdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015205800A10>]}
[0m10:51:45.425565 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m10:51:45.993094 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m10:51:46.217228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:51:46.217228 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m10:51:46.217228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:51:46.238782 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m10:51:46.334852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d3c0603-04aa-438b-abd6-dee8fde1bdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520A23E410>]}
[0m10:51:46.469063 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:51:46.475376 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:51:46.525109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d3c0603-04aa-438b-abd6-dee8fde1bdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520A7BFED0>]}
[0m10:51:46.526295 [info ] [MainThread]: Found 1 model, 4 data tests, 464 macros
[0m10:51:46.527294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d3c0603-04aa-438b-abd6-dee8fde1bdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520A4AF450>]}
[0m10:51:46.530174 [info ] [MainThread]: 
[0m10:51:46.532051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:51:46.533487 [info ] [MainThread]: 
[0m10:51:46.534917 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:46.537988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m10:51:46.751396 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m10:51:46.752094 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m10:51:46.753126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:46.944475 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.195 seconds
[0m10:51:46.950886 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m10:51:46.952538 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m10:51:46.955871 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:46.955871 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m10:51:46.955871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:47.077987 [debug] [MainThread]: SQL status: SELECT 2 in 0.116 seconds
[0m10:51:47.081748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d3c0603-04aa-438b-abd6-dee8fde1bdf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520A7BF850>]}
[0m10:51:47.081748 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:47.083682 [debug] [MainThread]: On master: COMMIT
[0m10:51:47.083682 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:47.084714 [debug] [MainThread]: On master: COMMIT
[0m10:51:47.086855 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:51:47.087852 [debug] [MainThread]: On master: Close
[0m10:51:47.094784 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:51:47.095778 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:51:47.097111 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:51:47.097647 [debug] [Thread-4 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:51:47.098644 [info ] [Thread-1 (]: 1 of 4 START test not_null_stg_telegram_messages_channel_name .................. [RUN]
[0m10:51:47.100023 [info ] [Thread-2 (]: 2 of 4 START test not_null_stg_telegram_messages_message_date .................. [RUN]
[0m10:51:47.102018 [info ] [Thread-3 (]: 3 of 4 START test not_null_stg_telegram_messages_message_id .................... [RUN]
[0m10:51:47.103119 [info ] [Thread-4 (]: 4 of 4 START test unique_stg_telegram_messages_message_id ...................... [RUN]
[0m10:51:47.105858 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8'
[0m10:51:47.108498 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14'
[0m10:51:47.110245 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6'
[0m10:51:47.112145 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1'
[0m10:51:47.113812 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:51:47.114913 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:51:47.117589 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:51:47.117708 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:51:47.153368 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m10:51:47.168175 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m10:51:47.175326 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m10:51:47.185456 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m10:51:47.195914 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:51:47.197909 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:51:47.199000 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:51:47.200438 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:51:47.224735 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m10:51:47.233839 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m10:51:47.244071 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m10:51:47.255512 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m10:51:47.259974 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"
[0m10:51:47.260973 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m10:51:47.262966 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m10:51:47.264014 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"
[0m10:51:47.265012 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"
[0m10:51:47.266885 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m10:51:47.268112 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:51:47.269432 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_id
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_id is null



  
  
      
    ) dbt_internal_test
[0m10:51:47.270712 [debug] [Thread-4 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_id as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_id is not null
group by message_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m10:51:47.271711 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:51:47.273008 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:51:47.275032 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:51:47.421570 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.153 seconds
[0m10:51:47.424459 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: ROLLBACK
[0m10:51:47.437264 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14: Close
[0m10:51:47.438261 [error] [Thread-2 (]: 2 of 4 FAIL 400 not_null_stg_telegram_messages_message_date .................... [[31mFAIL 400[0m in 0.33s]
[0m10:51:47.451357 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14
[0m10:51:47.512204 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.240 seconds
[0m10:51:47.512204 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m10:51:47.512204 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m10:51:47.533788 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.261 seconds
[0m10:51:47.540137 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: ROLLBACK
[0m10:51:47.520307 [info ] [Thread-1 (]: 1 of 4 PASS not_null_stg_telegram_messages_channel_name ........................ [[32mPASS[0m in 0.41s]
[0m10:51:47.543120 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6: Close
[0m10:51:47.545475 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m10:51:47.548106 [error] [Thread-3 (]: 3 of 4 FAIL 400 not_null_stg_telegram_messages_message_id ...................... [[31mFAIL 400[0m in 0.44s]
[0m10:51:47.552406 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6
[0m10:51:47.594391 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.322 seconds
[0m10:51:47.602551 [debug] [Thread-4 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: ROLLBACK
[0m10:51:47.604544 [debug] [Thread-4 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1: Close
[0m10:51:47.606938 [info ] [Thread-4 (]: 4 of 4 PASS unique_stg_telegram_messages_message_id ............................ [[32mPASS[0m in 0.49s]
[0m10:51:47.609952 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1
[0m10:51:47.614039 [debug] [MainThread]: On master: COMMIT
[0m10:51:47.615039 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:47.616886 [debug] [MainThread]: On master: COMMIT
[0m10:51:47.616886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:47.754121 [debug] [MainThread]: SQL status: COMMIT in 0.135 seconds
[0m10:51:47.755119 [debug] [MainThread]: On master: Close
[0m10:51:47.755119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:47.758057 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m10:51:47.759187 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8' was properly closed.
[0m10:51:47.760184 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_date.5e47e63b14' was properly closed.
[0m10:51:47.760184 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_id.9b3fea71d6' was properly closed.
[0m10:51:47.764607 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_id.1c7c22c9a1' was properly closed.
[0m10:51:47.767561 [info ] [MainThread]: 
[0m10:51:47.770866 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m10:51:47.779919 [debug] [MainThread]: Command end result
[0m10:51:47.874759 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m10:51:47.883693 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m10:51:47.910240 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m10:51:47.911240 [info ] [MainThread]: 
[0m10:51:47.914915 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m10:51:47.920537 [info ] [MainThread]: 
[0m10:51:47.923081 [error] [MainThread]: [31mFailure in test not_null_stg_telegram_messages_message_date (models\staging\schema.yml)[0m
[0m10:51:47.924077 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m10:51:47.925880 [info ] [MainThread]: 
[0m10:51:47.927245 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\schema.yml\not_null_stg_telegram_messages_message_date.sql
[0m10:51:47.928792 [info ] [MainThread]: 
[0m10:51:47.930420 [error] [MainThread]: [31mFailure in test not_null_stg_telegram_messages_message_id (models\staging\schema.yml)[0m
[0m10:51:47.932906 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m10:51:47.935638 [info ] [MainThread]: 
[0m10:51:47.937858 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\schema.yml\not_null_stg_telegram_messages_message_id.sql
[0m10:51:47.939288 [info ] [MainThread]: 
[0m10:51:47.940903 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=4
[0m10:51:47.945541 [debug] [MainThread]: Command `dbt test` failed at 10:51:47.945541 after 3.20 seconds
[0m10:51:47.946538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001520A7EC310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015202335550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015208FE2A10>]}
[0m10:51:47.947589 [debug] [MainThread]: Flushing usage events
[0m10:51:49.896218 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:06.720656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001937594EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001937591AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001937591A790>]}


============================== 11:07:06.767616 | 830bb847-438f-44dc-b800-ba83b798423f ==============================
[0m11:07:06.767616 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:07:06.767616 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt run --select stg_telegram_messages --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m11:07:07.912288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '830bb847-438f-44dc-b800-ba83b798423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019376B36010>]}
[0m11:07:08.037265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '830bb847-438f-44dc-b800-ba83b798423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019376A23C10>]}
[0m11:07:08.037265 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:07:08.837655 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:07:09.370627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m11:07:09.370627 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\staging\schema.yml
[0m11:07:09.370627 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\staging\stg_telegram_messages.sql
[0m11:07:10.294606 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m11:07:10.294606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '830bb847-438f-44dc-b800-ba83b798423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019376F83C90>]}
[0m11:07:10.484139 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m11:07:10.484139 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m11:07:10.812283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '830bb847-438f-44dc-b800-ba83b798423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019376D70F50>]}
[0m11:07:10.812283 [info ] [MainThread]: Found 1 model, 3 data tests, 464 macros
[0m11:07:10.812283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '830bb847-438f-44dc-b800-ba83b798423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193770A5690>]}
[0m11:07:10.812283 [info ] [MainThread]: 
[0m11:07:10.812283 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:10.823729 [info ] [MainThread]: 
[0m11:07:10.825724 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:07:10.846083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m11:07:11.096712 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m11:07:11.096712 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:07:11.096712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:11.597859 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.498 seconds
[0m11:07:11.597859 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m11:07:11.613372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m11:07:11.613372 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m11:07:11.628995 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m11:07:11.628995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:11.753999 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.135 seconds
[0m11:07:11.753999 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m11:07:11.769586 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m11:07:11.769586 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:11.769586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:07:11.769586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:11.941510 [debug] [MainThread]: SQL status: SELECT 2 in 0.162 seconds
[0m11:07:11.941510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '830bb847-438f-44dc-b800-ba83b798423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019375842210>]}
[0m11:07:11.941510 [debug] [MainThread]: On master: ROLLBACK
[0m11:07:11.941510 [debug] [MainThread]: On master: COMMIT
[0m11:07:11.941510 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:11.941510 [debug] [MainThread]: On master: COMMIT
[0m11:07:11.941510 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:07:11.941510 [debug] [MainThread]: On master: Close
[0m11:07:11.972756 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m11:07:11.972756 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_telegram_messages ............... [RUN]
[0m11:07:11.989042 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m11:07:11.989042 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m11:07:11.989042 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m11:07:12.004111 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m11:07:12.072470 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m11:07:12.072470 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m11:07:12.072470 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select
        id,
        channel_name,
        sender_id,
        message_text,
        message_date,
        raw_json
    from raw.telegram_messages

),

cleaned as (

    select
        cast(id as bigint)                    as message_pk,
        trim(channel_name)                    as channel_name,
        cast(sender_id as bigint)             as sender_id,
        cast(message_date as timestamp)       as message_date,
        nullif(trim(message_text), '')        as message_text,
        raw_json
    from source

)

select *
from cleaned
  );
[0m11:07:12.072470 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:12.478707 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.402 seconds
[0m11:07:12.478707 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m11:07:12.494249 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."public_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m11:07:12.509959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.025 seconds
[0m11:07:12.526218 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m11:07:12.526218 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m11:07:12.526218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:07:12.554093 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m11:07:12.554093 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m11:07:12.554093 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m11:07:12.554093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:07:12.569718 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_backup"
[0m11:07:12.585338 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m11:07:12.585338 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_backup" cascade
[0m11:07:12.663536 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.079 seconds
[0m11:07:12.663536 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m11:07:12.663536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '830bb847-438f-44dc-b800-ba83b798423f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019377144B50>]}
[0m11:07:12.679065 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_telegram_messages .......... [[32mCREATE VIEW[0m in 0.67s]
[0m11:07:12.679065 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m11:07:12.679065 [debug] [MainThread]: On master: COMMIT
[0m11:07:12.679065 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:12.679065 [debug] [MainThread]: On master: COMMIT
[0m11:07:12.679065 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:12.787855 [debug] [MainThread]: SQL status: COMMIT in 0.110 seconds
[0m11:07:12.787855 [debug] [MainThread]: On master: Close
[0m11:07:12.787855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:12.787855 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m11:07:12.787855 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m11:07:12.803478 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m11:07:12.881717 [info ] [MainThread]: 
[0m11:07:12.897204 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m11:07:12.897204 [debug] [MainThread]: Command end result
[0m11:07:12.955647 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m11:07:12.955647 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m11:07:12.979144 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m11:07:12.980146 [info ] [MainThread]: 
[0m11:07:12.982119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:12.983079 [info ] [MainThread]: 
[0m11:07:12.984561 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:07:12.989741 [debug] [MainThread]: Command `dbt run` succeeded at 11:07:12.989741 after 6.68 seconds
[0m11:07:12.991734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001937591A6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936EC2B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001936EEC2ED0>]}
[0m11:07:12.992734 [debug] [MainThread]: Flushing usage events
[0m11:07:15.501089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:07:19.672961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BE1728950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BDECCDAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BE17560D0>]}


============================== 11:07:19.688639 | 3095d8c7-dc7c-4005-a066-482ff4179cda ==============================
[0m11:07:19.688639 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:07:19.688639 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test --select stg_telegram_messages --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m11:07:20.165770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3095d8c7-dc7c-4005-a066-482ff4179cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BE28C4F90>]}
[0m11:07:20.337640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3095d8c7-dc7c-4005-a066-482ff4179cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BDDF50C10>]}
[0m11:07:20.337640 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:07:20.920489 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:07:21.145948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:07:21.145948 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:07:21.161572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:07:21.161572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.medical_warehouse.marts
[0m11:07:21.253877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3095d8c7-dc7c-4005-a066-482ff4179cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BE1788910>]}
[0m11:07:21.380940 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m11:07:21.396516 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m11:07:21.474629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3095d8c7-dc7c-4005-a066-482ff4179cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BE2F82710>]}
[0m11:07:21.474629 [info ] [MainThread]: Found 1 model, 3 data tests, 464 macros
[0m11:07:21.474629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3095d8c7-dc7c-4005-a066-482ff4179cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BE297E910>]}
[0m11:07:21.490244 [info ] [MainThread]: 
[0m11:07:21.490244 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:21.497244 [info ] [MainThread]: 
[0m11:07:21.499202 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:07:21.505495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m11:07:21.711509 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m11:07:21.711509 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m11:07:21.711509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:21.836479 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.123 seconds
[0m11:07:21.836479 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m11:07:21.836479 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m11:07:21.852095 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:21.852095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:07:21.852095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:21.961449 [debug] [MainThread]: SQL status: SELECT 2 in 0.114 seconds
[0m11:07:21.961449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3095d8c7-dc7c-4005-a066-482ff4179cda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BE2E51510>]}
[0m11:07:21.961449 [debug] [MainThread]: On master: ROLLBACK
[0m11:07:21.961449 [debug] [MainThread]: On master: COMMIT
[0m11:07:21.977100 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:21.977100 [debug] [MainThread]: On master: COMMIT
[0m11:07:21.977100 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:07:21.977100 [debug] [MainThread]: On master: Close
[0m11:07:21.977100 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m11:07:21.977100 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m11:07:21.977100 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m11:07:21.977100 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_telegram_messages_channel_name .................. [RUN]
[0m11:07:21.977100 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_telegram_messages_message_pk .................... [RUN]
[0m11:07:21.992687 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8'
[0m11:07:21.992687 [info ] [Thread-3 (]: 3 of 3 START test unique_stg_telegram_messages_message_pk ...................... [RUN]
[0m11:07:21.998975 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1'
[0m11:07:21.999972 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m11:07:22.004277 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5'
[0m11:07:22.006526 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m11:07:22.039501 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m11:07:22.039501 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m11:07:22.039501 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m11:07:22.068140 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m11:07:22.071384 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m11:07:22.086383 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m11:07:22.109432 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m11:07:22.114386 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m11:07:22.115716 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m11:07:22.120964 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m11:07:22.120964 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m11:07:22.120964 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m11:07:22.120964 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m11:07:22.120964 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m11:07:22.120964 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m11:07:22.120964 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:22.120964 [debug] [Thread-3 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:07:22.120964 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:07:22.120964 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:07:22.402149 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.282 seconds
[0m11:07:22.417771 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m11:07:22.417771 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.295 seconds
[0m11:07:22.417771 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m11:07:22.433394 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: ROLLBACK
[0m11:07:22.433394 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: Close
[0m11:07:22.433394 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_telegram_messages_channel_name ........................ [[32mPASS[0m in 0.44s]
[0m11:07:22.433394 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m11:07:22.433394 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_telegram_messages_message_pk .......................... [[32mPASS[0m in 0.44s]
[0m11:07:22.449027 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m11:07:22.506479 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.373 seconds
[0m11:07:22.506479 [debug] [Thread-3 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: ROLLBACK
[0m11:07:22.506479 [debug] [Thread-3 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: Close
[0m11:07:22.506479 [info ] [Thread-3 (]: 3 of 3 PASS unique_stg_telegram_messages_message_pk ............................ [[32mPASS[0m in 0.50s]
[0m11:07:22.506479 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m11:07:22.506479 [debug] [MainThread]: On master: COMMIT
[0m11:07:22.522230 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:22.524227 [debug] [MainThread]: On master: COMMIT
[0m11:07:22.525223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:22.684455 [debug] [MainThread]: SQL status: COMMIT in 0.167 seconds
[0m11:07:22.684455 [debug] [MainThread]: On master: Close
[0m11:07:22.684455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:22.684455 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m11:07:22.700075 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8' was properly closed.
[0m11:07:22.700075 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1' was properly closed.
[0m11:07:22.700075 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5' was properly closed.
[0m11:07:22.700075 [info ] [MainThread]: 
[0m11:07:22.700075 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.20 seconds (1.20s).
[0m11:07:22.700075 [debug] [MainThread]: Command end result
[0m11:07:22.961288 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m11:07:22.976910 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m11:07:22.992533 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m11:07:22.992533 [info ] [MainThread]: 
[0m11:07:23.008153 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:07:23.008153 [info ] [MainThread]: 
[0m11:07:23.008153 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:07:23.016580 [debug] [MainThread]: Command `dbt test` succeeded at 11:07:23.016580 after 3.53 seconds
[0m11:07:23.018575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BE14C5BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BDAA75110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012BDAA74D90>]}
[0m11:07:23.020500 [debug] [MainThread]: Flushing usage events
[0m11:07:24.580487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:26:39.112137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4E30EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4E33AD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4E33B750>]}


============================== 11:26:39.179110 | 2d3131e0-d739-4199-a3d5-baf89f00d123 ==============================
[0m11:26:39.179110 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:26:39.181108 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt run --select dim_channels --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m11:26:40.376757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d3131e0-d739-4199-a3d5-baf89f00d123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4DAB7C90>]}
[0m11:26:40.487111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d3131e0-d739-4199-a3d5-baf89f00d123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4F3E3C10>]}
[0m11:26:40.487111 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:26:41.245154 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:26:41.533345 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'models' in "<unicode string>", line 17, column 1 in file
`models\staging\schema.yml`
[0m11:26:41.533345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d3131e0-d739-4199-a3d5-baf89f00d123', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4F870C90>]}
[0m11:26:41.970223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:26:41.970223 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://models\marts\dimensions\dim_channels.sql
[0m11:26:41.970223 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\staging\schema.yml
[0m11:26:42.842600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d3131e0-d739-4199-a3d5-baf89f00d123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4ADC9AD0>]}
[0m11:26:43.001560 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m11:26:43.032852 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m11:26:43.346214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d3131e0-d739-4199-a3d5-baf89f00d123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4B8D5850>]}
[0m11:26:43.346214 [info ] [MainThread]: Found 2 models, 3 data tests, 464 macros
[0m11:26:43.346214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3131e0-d739-4199-a3d5-baf89f00d123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4F49AB50>]}
[0m11:26:43.346214 [info ] [MainThread]: 
[0m11:26:43.346214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:26:43.361695 [info ] [MainThread]: 
[0m11:26:43.363960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:26:43.371572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m11:26:43.643391 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m11:26:43.643391 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:26:43.643391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:44.173766 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.519 seconds
[0m11:26:44.173766 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m11:26:44.173766 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_medical_warehouse, now create_medical_warehouse_public_marts)
[0m11:26:44.189375 [debug] [ThreadPool]: Creating schema "database: "medical_warehouse"
schema: "public_marts"
"
[0m11:26:44.189375 [debug] [ThreadPool]: Using postgres connection "create_medical_warehouse_public_marts"
[0m11:26:44.189375 [debug] [ThreadPool]: On create_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "create_medical_warehouse_public_marts"} */
create schema if not exists "public_marts"
[0m11:26:44.204947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:44.350563 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.154 seconds
[0m11:26:44.350563 [debug] [ThreadPool]: On create_medical_warehouse_public_marts: COMMIT
[0m11:26:44.350563 [debug] [ThreadPool]: Using postgres connection "create_medical_warehouse_public_marts"
[0m11:26:44.350563 [debug] [ThreadPool]: On create_medical_warehouse_public_marts: COMMIT
[0m11:26:44.350563 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m11:26:44.350563 [debug] [ThreadPool]: On create_medical_warehouse_public_marts: Close
[0m11:26:44.369424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m11:26:44.371419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m11:26:44.377518 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m11:26:44.377518 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m11:26:44.377518 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m11:26:44.377518 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m11:26:44.377518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:44.393143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:44.595676 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.213 seconds
[0m11:26:44.595676 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.213 seconds
[0m11:26:44.595676 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m11:26:44.595676 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m11:26:44.611299 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m11:26:44.611299 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m11:26:44.611299 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:44.611299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:26:44.626924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:44.783633 [debug] [MainThread]: SQL status: SELECT 2 in 0.155 seconds
[0m11:26:44.785663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d3131e0-d739-4199-a3d5-baf89f00d123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4F752850>]}
[0m11:26:44.786658 [debug] [MainThread]: On master: ROLLBACK
[0m11:26:44.787659 [debug] [MainThread]: On master: COMMIT
[0m11:26:44.788653 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:44.789616 [debug] [MainThread]: On master: COMMIT
[0m11:26:44.790650 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:26:44.791612 [debug] [MainThread]: On master: Close
[0m11:26:44.835991 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m11:26:44.836969 [info ] [Thread-1 (]: 1 of 1 START sql view model public_marts.dim_channels .......................... [RUN]
[0m11:26:44.836969 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m11:26:44.836969 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m11:26:44.983486 [debug] [Thread-1 (]: Compilation Error in model dim_channels (models\marts\dimensions\dim_channels.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:26:44.983486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d3131e0-d739-4199-a3d5-baf89f00d123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4E2E3490>]}
[0m11:26:44.983486 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_marts.dim_channels ................. [[31mERROR[0m in 0.15s]
[0m11:26:44.983486 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m11:26:44.983486 [debug] [Thread-7 (]: Marking all children of 'model.medical_warehouse.dim_channels' to be skipped because of status 'error'.  Reason: Compilation Error in model dim_channels (models\marts\dimensions\dim_channels.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m11:26:45.009913 [debug] [MainThread]: On master: COMMIT
[0m11:26:45.009913 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:45.009913 [debug] [MainThread]: On master: COMMIT
[0m11:26:45.009913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:45.122002 [debug] [MainThread]: SQL status: COMMIT in 0.105 seconds
[0m11:26:45.123004 [debug] [MainThread]: On master: Close
[0m11:26:45.124002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:45.124999 [debug] [MainThread]: Connection 'create_medical_warehouse_public_marts' was properly closed.
[0m11:26:45.125998 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m11:26:45.127073 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m11:26:45.127073 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m11:26:45.142792 [info ] [MainThread]: 
[0m11:26:45.142792 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m11:26:45.142792 [debug] [MainThread]: Command end result
[0m11:26:45.221379 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m11:26:45.229342 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m11:26:45.245300 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m11:26:45.246335 [info ] [MainThread]: 
[0m11:26:45.248293 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:26:45.249160 [info ] [MainThread]: 
[0m11:26:45.251159 [error] [MainThread]: [31mFailure in model dim_channels (models\marts\dimensions\dim_channels.sql)[0m
[0m11:26:45.254153 [error] [MainThread]:   Compilation Error in model dim_channels (models\marts\dimensions\dim_channels.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m11:26:45.256433 [info ] [MainThread]: 
[0m11:26:45.257519 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m11:26:45.259519 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:26:45.263544 [debug] [MainThread]: Command `dbt run` failed at 11:26:45.263544 after 6.54 seconds
[0m11:26:45.264544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4E2102D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4E210410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4FF6DCD0>]}
[0m11:26:45.265503 [debug] [MainThread]: Flushing usage events
[0m11:26:48.267858 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:47.594148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C7AE1AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C7AE4CB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C7AE1A950>]}


============================== 11:29:47.677816 | 89e6a937-be1d-4ca9-a41f-afacce8b10b1 ==============================
[0m11:29:47.677816 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:29:47.680932 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt deps --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m11:29:48.898409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89e6a937-be1d-4ca9-a41f-afacce8b10b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C7AE33510>]}
[0m11:29:49.206493 [debug] [MainThread]: Set downloads directory='C:\Users\bia\AppData\Local\Temp\dbt-downloads-6w23xfww'
[0m11:29:49.208491 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:29:51.425887 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:29:51.429874 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:29:52.626604 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:29:52.657887 [info ] [MainThread]: Updating lock file in file path: C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse/package-lock.yml
[0m11:29:52.657887 [debug] [MainThread]: Set downloads directory='C:\Users\bia\AppData\Local\Temp\dbt-downloads-uk1xbxs6'
[0m11:29:52.677706 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m11:29:57.296078 [info ] [MainThread]: Installed from version 1.1.1
[0m11:29:57.298076 [info ] [MainThread]: Updated version available: 1.3.3
[0m11:29:57.299420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '89e6a937-be1d-4ca9-a41f-afacce8b10b1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C7BEE27D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C7BF44050>]}
[0m11:29:57.300424 [info ] [MainThread]: 
[0m11:29:57.301750 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m11:29:57.330812 [debug] [MainThread]: Command `dbt deps` succeeded at 11:29:57.330812 after 10.20 seconds
[0m11:29:57.331811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C743C30D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C74105210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C74105650>]}
[0m11:29:57.332807 [debug] [MainThread]: Flushing usage events
[0m11:29:59.989150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:41.502513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2780EFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2780DC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D278375D0>]}


============================== 11:35:41.502513 | 3d48aa98-429d-4636-a2ae-978ad5802621 ==============================
[0m11:35:41.502513 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:35:41.502513 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_telegram_messages --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m11:35:42.219557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d48aa98-429d-4636-a2ae-978ad5802621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D27869D10>]}
[0m11:35:42.352823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d48aa98-429d-4636-a2ae-978ad5802621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D24006850>]}
[0m11:35:42.352823 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:35:43.486007 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:35:43.706528 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m11:35:43.706528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d48aa98-429d-4636-a2ae-978ad5802621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D2783A0D0>]}
[0m11:35:46.768925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d48aa98-429d-4636-a2ae-978ad5802621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D28F76390>]}
[0m11:35:46.955038 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m11:35:46.970755 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m11:35:47.220572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d48aa98-429d-4636-a2ae-978ad5802621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D29246350>]}
[0m11:35:47.220572 [info ] [MainThread]: Found 2 models, 3 data tests, 578 macros
[0m11:35:47.220572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d48aa98-429d-4636-a2ae-978ad5802621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D28F11F50>]}
[0m11:35:47.236107 [info ] [MainThread]: 
[0m11:35:47.236107 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:35:47.236107 [info ] [MainThread]: 
[0m11:35:47.236107 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:35:47.286601 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m11:35:47.657804 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m11:35:47.657804 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m11:35:47.657804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:48.605749 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.944 seconds
[0m11:35:48.607737 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m11:35:48.610730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m11:35:48.611727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m11:35:48.623694 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m11:35:48.629905 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m11:35:48.631451 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m11:35:48.632454 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m11:35:48.633486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:48.635560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:48.846040 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.220 seconds
[0m11:35:48.846040 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.223 seconds
[0m11:35:48.846040 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m11:35:48.861696 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m11:35:48.861696 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m11:35:48.861696 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m11:35:48.861696 [debug] [MainThread]: Using postgres connection "master"
[0m11:35:48.877286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:35:48.877286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:49.018401 [debug] [MainThread]: SQL status: SELECT 2 in 0.145 seconds
[0m11:35:49.018401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d48aa98-429d-4636-a2ae-978ad5802621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D294BB810>]}
[0m11:35:49.018401 [debug] [MainThread]: On master: ROLLBACK
[0m11:35:49.018401 [debug] [MainThread]: On master: COMMIT
[0m11:35:49.018401 [debug] [MainThread]: Using postgres connection "master"
[0m11:35:49.018401 [debug] [MainThread]: On master: COMMIT
[0m11:35:49.018401 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:35:49.018401 [debug] [MainThread]: On master: Close
[0m11:35:49.063979 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m11:35:49.063979 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_telegram_messages ............... [RUN]
[0m11:35:49.063979 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m11:35:49.063979 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m11:35:49.102890 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m11:35:49.102890 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m11:35:49.187063 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m11:35:49.187063 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m11:35:49.187063 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select
        id,
        channel_name,
        sender_id,
        message_text,
        message_date,
        raw_json
    from raw.telegram_messages

),

cleaned as (

    select
        cast(id as bigint)                    as message_pk,
        trim(channel_name)                    as channel_name,
        cast(sender_id as bigint)             as sender_id,
        cast(message_date as timestamp)       as message_date,
        nullif(trim(message_text), '')        as message_text,
        raw_json
    from source

)

select *
from cleaned
  );
[0m11:35:49.203270 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:35:49.517571 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.315 seconds
[0m11:35:49.517571 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m11:35:49.517571 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."public_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m11:35:49.533279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m11:35:49.548796 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m11:35:49.548796 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m11:35:49.564508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m11:35:49.605234 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m11:35:49.607234 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m11:35:49.609222 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m11:35:49.611217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m11:35:49.629390 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_backup"
[0m11:35:49.643403 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m11:35:49.643403 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_backup" cascade
[0m11:35:50.103397 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.461 seconds
[0m11:35:50.103397 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m11:35:50.103397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d48aa98-429d-4636-a2ae-978ad5802621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D28CB9550>]}
[0m11:35:50.119814 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_telegram_messages .......... [[32mCREATE VIEW[0m in 1.04s]
[0m11:35:50.119814 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m11:35:50.139796 [debug] [MainThread]: On master: COMMIT
[0m11:35:50.140794 [debug] [MainThread]: Using postgres connection "master"
[0m11:35:50.141790 [debug] [MainThread]: On master: COMMIT
[0m11:35:50.142789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:50.274642 [debug] [MainThread]: SQL status: COMMIT in 0.132 seconds
[0m11:35:50.275643 [debug] [MainThread]: On master: Close
[0m11:35:50.276641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:50.277640 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m11:35:50.278638 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m11:35:50.279633 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m11:35:50.280631 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m11:35:50.332621 [info ] [MainThread]: 
[0m11:35:50.332621 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m11:35:50.332621 [debug] [MainThread]: Command end result
[0m11:35:50.486195 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m11:35:50.501817 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m11:35:50.501817 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m11:35:50.501817 [info ] [MainThread]: 
[0m11:35:50.517436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:35:50.517436 [info ] [MainThread]: 
[0m11:35:50.524979 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:35:50.530709 [debug] [MainThread]: Command `dbt run` succeeded at 11:35:50.529710 after 9.21 seconds
[0m11:35:50.534353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D20DB34D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D20AF5110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D20AF5310>]}
[0m11:35:50.536714 [debug] [MainThread]: Flushing usage events
[0m11:35:52.361134 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:35:56.473347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF3C17A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF3C17B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF3BBAA10>]}


============================== 11:35:56.481326 | 62217632-d540-4eef-9719-3e280a8ccb5e ==============================
[0m11:35:56.481326 [info ] [MainThread]: Running with dbt=1.11.2
[0m11:35:56.483022 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt test --select stg_telegram_messages --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m11:35:56.886277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62217632-d540-4eef-9719-3e280a8ccb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF3C48AD0>]}
[0m11:35:57.012715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62217632-d540-4eef-9719-3e280a8ccb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF03E09D0>]}
[0m11:35:57.014710 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m11:35:58.074949 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m11:35:58.460403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:35:58.460403 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m11:35:58.460403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:35:58.577224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62217632-d540-4eef-9719-3e280a8ccb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF4CCE090>]}
[0m11:35:58.745372 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m11:35:58.745372 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m11:35:58.877519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62217632-d540-4eef-9719-3e280a8ccb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF53F2FD0>]}
[0m11:35:58.877519 [info ] [MainThread]: Found 2 models, 3 data tests, 578 macros
[0m11:35:58.893103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62217632-d540-4eef-9719-3e280a8ccb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF51D2190>]}
[0m11:35:58.893103 [info ] [MainThread]: 
[0m11:35:58.893103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:35:58.901337 [info ] [MainThread]: 
[0m11:35:58.904815 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:35:58.911902 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m11:35:58.914898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m11:35:59.142023 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m11:35:59.142023 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m11:35:59.142023 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m11:35:59.142023 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m11:35:59.142023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:59.157602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:59.356217 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.200 seconds
[0m11:35:59.359072 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m11:35:59.359072 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m11:35:59.372055 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.220 seconds
[0m11:35:59.372055 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m11:35:59.372055 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m11:35:59.392711 [debug] [MainThread]: Using postgres connection "master"
[0m11:35:59.392711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m11:35:59.392711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:59.555781 [debug] [MainThread]: SQL status: SELECT 2 in 0.157 seconds
[0m11:35:59.558772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62217632-d540-4eef-9719-3e280a8ccb5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF50B5010>]}
[0m11:35:59.562762 [debug] [MainThread]: On master: ROLLBACK
[0m11:35:59.564792 [debug] [MainThread]: On master: COMMIT
[0m11:35:59.564792 [debug] [MainThread]: Using postgres connection "master"
[0m11:35:59.564792 [debug] [MainThread]: On master: COMMIT
[0m11:35:59.564792 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:35:59.569154 [debug] [MainThread]: On master: Close
[0m11:35:59.576094 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m11:35:59.576094 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m11:35:59.588897 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m11:35:59.589895 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_telegram_messages_channel_name .................. [RUN]
[0m11:35:59.592834 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_telegram_messages_message_pk .................... [RUN]
[0m11:35:59.602066 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8'
[0m11:35:59.606057 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1'
[0m11:35:59.592834 [info ] [Thread-3 (]: 3 of 3 START test unique_stg_telegram_messages_message_pk ...................... [RUN]
[0m11:35:59.607053 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m11:35:59.611042 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m11:35:59.614035 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5'
[0m11:35:59.675493 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m11:35:59.683474 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m11:35:59.685465 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m11:35:59.701422 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m11:35:59.703468 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m11:35:59.719093 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m11:35:59.750337 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m11:35:59.750337 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m11:35:59.768134 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m11:35:59.781097 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m11:35:59.784089 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m11:35:59.784951 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m11:35:59.784951 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:35:59.784951 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m11:35:59.784951 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m11:35:59.784951 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m11:35:59.784951 [debug] [Thread-3 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m11:35:59.784951 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:35:59.784951 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:36:00.000477 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.218 seconds
[0m11:36:00.016067 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: ROLLBACK
[0m11:36:00.016067 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: Close
[0m11:36:00.016067 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_telegram_messages_message_pk .......................... [[32mPASS[0m in 0.41s]
[0m11:36:00.016067 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m11:36:00.016067 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.233 seconds
[0m11:36:00.034121 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m11:36:00.036060 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m11:36:00.037391 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_telegram_messages_channel_name ........................ [[32mPASS[0m in 0.44s]
[0m11:36:00.037391 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m11:36:00.053223 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.264 seconds
[0m11:36:00.053223 [debug] [Thread-3 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: ROLLBACK
[0m11:36:00.053223 [debug] [Thread-3 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: Close
[0m11:36:00.053223 [info ] [Thread-3 (]: 3 of 3 PASS unique_stg_telegram_messages_message_pk ............................ [[32mPASS[0m in 0.44s]
[0m11:36:00.072181 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m11:36:00.075174 [debug] [MainThread]: On master: COMMIT
[0m11:36:00.076155 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:00.079631 [debug] [MainThread]: On master: COMMIT
[0m11:36:00.080636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:00.185363 [debug] [MainThread]: SQL status: COMMIT in 0.107 seconds
[0m11:36:00.185363 [debug] [MainThread]: On master: Close
[0m11:36:00.185363 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:00.185363 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m11:36:00.185363 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m11:36:00.185363 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8' was properly closed.
[0m11:36:00.185363 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1' was properly closed.
[0m11:36:00.185363 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5' was properly closed.
[0m11:36:00.185363 [info ] [MainThread]: 
[0m11:36:00.185363 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m11:36:00.185363 [debug] [MainThread]: Command end result
[0m11:36:00.289865 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m11:36:00.295847 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m11:36:00.314937 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m11:36:00.315937 [info ] [MainThread]: 
[0m11:36:00.317929 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:00.320922 [info ] [MainThread]: 
[0m11:36:00.322917 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m11:36:00.325908 [debug] [MainThread]: Command `dbt test` succeeded at 11:36:00.325908 after 4.14 seconds
[0m11:36:00.328900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF3BBA710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF3BB8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF3955BD0>]}
[0m11:36:00.329899 [debug] [MainThread]: Flushing usage events
[0m11:36:02.064541 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:14.032079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB90ECA890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB90EC7AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB90EFD5D0>]}


============================== 16:16:14.119633 | 8f28cc34-6819-4eaa-8b31-8af986386507 ==============================
[0m16:16:14.119633 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:16:14.124930 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select stg_telegram_messages --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m16:16:17.917593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f28cc34-6819-4eaa-8b31-8af986386507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB92067710>]}
[0m16:16:18.119536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f28cc34-6819-4eaa-8b31-8af986386507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8D6F09D0>]}
[0m16:16:18.127058 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:16:20.833634 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:16:22.585992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:22.585992 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:16:22.599115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:22.694194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f28cc34-6819-4eaa-8b31-8af986386507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB924DB8D0>]}
[0m16:16:22.897048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:16:23.027401 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:16:23.687477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f28cc34-6819-4eaa-8b31-8af986386507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9259FB50>]}
[0m16:16:23.690467 [info ] [MainThread]: Found 2 models, 3 data tests, 578 macros
[0m16:16:23.693701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f28cc34-6819-4eaa-8b31-8af986386507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB925011D0>]}
[0m16:16:23.697649 [info ] [MainThread]: 
[0m16:16:23.703201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:16:23.707889 [info ] [MainThread]: 
[0m16:16:23.713826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:16:23.837936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m16:16:26.075691 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m16:16:26.075691 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:16:26.075691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:36.938561 [debug] [ThreadPool]: SQL status: SELECT 10 in 10.856 seconds
[0m16:16:36.938561 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m16:16:36.977780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m16:16:36.980940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m16:16:37.005600 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m16:16:37.013075 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m16:16:37.014999 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:16:37.017349 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:16:37.018643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:37.020720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:38.546636 [debug] [ThreadPool]: SQL status: SELECT 0 in 1.526 seconds
[0m16:16:38.547672 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.530 seconds
[0m16:16:38.553501 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m16:16:38.558816 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m16:16:38.586963 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m16:16:38.586963 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m16:16:38.615919 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:38.617965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:16:38.621902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:40.754514 [debug] [MainThread]: SQL status: SELECT 2 in 2.143 seconds
[0m16:16:40.754514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f28cc34-6819-4eaa-8b31-8af986386507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB929B07D0>]}
[0m16:16:40.770494 [debug] [MainThread]: On master: ROLLBACK
[0m16:16:40.772981 [debug] [MainThread]: On master: COMMIT
[0m16:16:40.773979 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:40.776478 [debug] [MainThread]: On master: COMMIT
[0m16:16:40.792725 [debug] [MainThread]: SQL status: COMMIT in 0.021 seconds
[0m16:16:40.792725 [debug] [MainThread]: On master: Close
[0m16:16:40.990768 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m16:16:40.993679 [info ] [Thread-1 (]: 1 of 1 START sql view model public_staging.stg_telegram_messages ............... [RUN]
[0m16:16:40.997407 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m16:16:40.997407 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m16:16:41.075471 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m16:16:41.126171 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m16:16:41.209114 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m16:16:41.220046 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m16:16:41.221041 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select
        id,
        channel_name,
        sender_id,
        message_text,
        message_date,
        raw_json
    from raw.telegram_messages

),

cleaned as (

    select
        cast(id as bigint)                    as message_pk,
        trim(channel_name)                    as channel_name,
        cast(sender_id as bigint)             as sender_id,
        cast(message_date as timestamp)       as message_date,
        nullif(trim(message_text), '')        as message_text,
        raw_json
    from source

)

select *
from cleaned
  );
[0m16:16:41.223387 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:16:41.761707 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.538 seconds
[0m16:16:41.786639 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m16:16:41.786639 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."public_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m16:16:41.946030 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.154 seconds
[0m16:16:41.962328 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m16:16:41.962328 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m16:16:41.968006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:16:42.038462 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m16:16:42.042904 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m16:16:42.045440 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m16:16:42.048656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:16:42.061064 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_backup"
[0m16:16:42.077316 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m16:16:42.079821 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_backup" cascade
[0m16:16:42.256176 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.175 seconds
[0m16:16:42.262138 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m16:16:42.275844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f28cc34-6819-4eaa-8b31-8af986386507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB929A2B50>]}
[0m16:16:42.278971 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_staging.stg_telegram_messages .......... [[32mCREATE VIEW[0m in 1.27s]
[0m16:16:42.283591 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m16:16:42.476397 [debug] [MainThread]: On master: COMMIT
[0m16:16:42.476397 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:42.479476 [debug] [MainThread]: On master: COMMIT
[0m16:16:42.479476 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:42.713211 [debug] [MainThread]: SQL status: COMMIT in 0.233 seconds
[0m16:16:42.714207 [debug] [MainThread]: On master: Close
[0m16:16:42.714976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:42.717148 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m16:16:42.718328 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m16:16:42.718793 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m16:16:42.719999 [debug] [MainThread]: Connection 'model.medical_warehouse.stg_telegram_messages' was properly closed.
[0m16:16:42.845034 [info ] [MainThread]: 
[0m16:16:42.847722 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 19.01 seconds (19.01s).
[0m16:16:42.852441 [debug] [MainThread]: Command end result
[0m16:16:43.014532 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:16:43.019208 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:16:43.036827 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m16:16:43.038139 [info ] [MainThread]: 
[0m16:16:43.041419 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:43.043776 [info ] [MainThread]: 
[0m16:16:43.045775 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:16:43.050932 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:43.050932 after 29.76 seconds
[0m16:16:43.053218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB90C5B250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB90EC7AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB90EC6C90>]}
[0m16:16:43.053218 [debug] [MainThread]: Flushing usage events
[0m16:16:47.478056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:17.875743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA1FAA9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA1FAA790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA1FAAD10>]}


============================== 16:17:18.070576 | d33964f4-ed78-4234-923f-e87ac3750c14 ==============================
[0m16:17:18.070576 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:17:18.085771 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt test --select stg_telegram_messages --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m16:17:20.096384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd33964f4-ed78-4234-923f-e87ac3750c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA3164C90>]}
[0m16:17:20.283106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd33964f4-ed78-4234-923f-e87ac3750c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD9E7D20D0>]}
[0m16:17:20.285405 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:17:21.262183 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:17:22.363244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:17:22.363244 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:17:22.369392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:17:22.458546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd33964f4-ed78-4234-923f-e87ac3750c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA31C6E50>]}
[0m16:17:22.620579 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:17:22.625638 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:17:23.292742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd33964f4-ed78-4234-923f-e87ac3750c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA37E2F50>]}
[0m16:17:23.293742 [info ] [MainThread]: Found 2 models, 3 data tests, 578 macros
[0m16:17:23.297145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd33964f4-ed78-4234-923f-e87ac3750c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA36D52D0>]}
[0m16:17:23.298186 [info ] [MainThread]: 
[0m16:17:23.303897 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:17:23.307061 [info ] [MainThread]: 
[0m16:17:23.309822 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:17:23.318322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m16:17:23.323245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m16:17:23.914816 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m16:17:23.914816 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m16:17:23.925134 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:17:23.928888 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:17:23.931181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:23.932207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:24.262782 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.336 seconds
[0m16:17:24.262782 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m16:17:24.262782 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.339 seconds
[0m16:17:24.272219 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m16:17:24.275938 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m16:17:24.278703 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m16:17:24.286005 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:24.294838 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:17:24.297022 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:24.411182 [debug] [MainThread]: SQL status: SELECT 2 in 0.124 seconds
[0m16:17:24.411182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd33964f4-ed78-4234-923f-e87ac3750c14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA36D5290>]}
[0m16:17:24.411182 [debug] [MainThread]: On master: ROLLBACK
[0m16:17:24.425949 [debug] [MainThread]: On master: COMMIT
[0m16:17:24.427707 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:24.428725 [debug] [MainThread]: On master: COMMIT
[0m16:17:24.429996 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:17:24.431025 [debug] [MainThread]: On master: Close
[0m16:17:24.438250 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:17:24.439658 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:17:24.440697 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:17:24.442694 [info ] [Thread-1 (]: 1 of 3 START test not_null_stg_telegram_messages_channel_name .................. [RUN]
[0m16:17:24.444902 [info ] [Thread-2 (]: 2 of 3 START test not_null_stg_telegram_messages_message_pk .................... [RUN]
[0m16:17:24.446886 [info ] [Thread-3 (]: 3 of 3 START test unique_stg_telegram_messages_message_pk ...................... [RUN]
[0m16:17:24.448929 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8'
[0m16:17:24.451019 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1'
[0m16:17:24.452229 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5'
[0m16:17:24.453552 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:17:24.454631 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:17:24.455981 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:17:24.497218 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m16:17:24.500752 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m16:17:24.513125 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m16:17:24.535450 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:17:24.570515 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m16:17:24.577135 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m16:17:24.578166 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m16:17:24.578166 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:17:24.619711 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:17:24.627725 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:17:24.644507 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m16:17:24.657695 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m16:17:24.814144 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m16:17:24.814144 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m16:17:24.818370 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m16:17:24.821449 [debug] [Thread-3 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:17:24.823717 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:17:24.826548 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:17:25.198608 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.382 seconds
[0m16:17:25.212760 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: ROLLBACK
[0m16:17:25.212760 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: Close
[0m16:17:25.212760 [info ] [Thread-2 (]: 2 of 3 PASS not_null_stg_telegram_messages_message_pk .......................... [[32mPASS[0m in 0.76s]
[0m16:17:25.223879 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:17:25.232711 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.653 seconds
[0m16:17:25.232711 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m16:17:25.232711 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m16:17:25.232711 [info ] [Thread-1 (]: 1 of 3 PASS not_null_stg_telegram_messages_channel_name ........................ [[32mPASS[0m in 0.78s]
[0m16:17:25.253704 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:17:25.267786 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.442 seconds
[0m16:17:25.270173 [debug] [Thread-3 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: ROLLBACK
[0m16:17:25.275962 [debug] [Thread-3 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: Close
[0m16:17:25.275962 [info ] [Thread-3 (]: 3 of 3 PASS unique_stg_telegram_messages_message_pk ............................ [[32mPASS[0m in 0.82s]
[0m16:17:25.302334 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:17:25.309251 [debug] [MainThread]: On master: COMMIT
[0m16:17:25.312850 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:25.313848 [debug] [MainThread]: On master: COMMIT
[0m16:17:25.313848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:25.513438 [debug] [MainThread]: SQL status: COMMIT in 0.197 seconds
[0m16:17:25.514434 [debug] [MainThread]: On master: Close
[0m16:17:25.514434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:25.514434 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m16:17:25.514434 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m16:17:25.514434 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8' was properly closed.
[0m16:17:25.514434 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1' was properly closed.
[0m16:17:25.514434 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5' was properly closed.
[0m16:17:25.514434 [info ] [MainThread]: 
[0m16:17:25.525626 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m16:17:25.529936 [debug] [MainThread]: Command end result
[0m16:17:25.651422 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:17:25.657198 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:17:25.671500 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m16:17:25.672498 [info ] [MainThread]: 
[0m16:17:25.674493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:25.675490 [info ] [MainThread]: 
[0m16:17:25.677081 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m16:17:25.681306 [debug] [MainThread]: Command `dbt test` succeeded at 16:17:25.680302 after 8.28 seconds
[0m16:17:25.681306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA1FAAE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA1FA9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDA10EF1D0>]}
[0m16:17:25.684341 [debug] [MainThread]: Flushing usage events
[0m16:17:27.604550 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:32.578606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FDA68050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FDA6AB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FDA69C90>]}


============================== 16:23:32.582006 | 70b8a4bb-7fa8-44f9-a990-89a931f3b07f ==============================
[0m16:23:32.582006 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:23:32.589915 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_channels --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m16:23:32.955354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70b8a4bb-7fa8-44f9-a990-89a931f3b07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FC9E7910>]}
[0m16:23:33.305605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70b8a4bb-7fa8-44f9-a990-89a931f3b07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FA29A290>]}
[0m16:23:33.305605 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:23:33.904651 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:23:34.139819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:23:34.195657 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:23:34.196981 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:23:34.285693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70b8a4bb-7fa8-44f9-a990-89a931f3b07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FEFE6850>]}
[0m16:23:34.428074 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:23:34.433681 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:23:34.468036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70b8a4bb-7fa8-44f9-a990-89a931f3b07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FEF605D0>]}
[0m16:23:34.469542 [info ] [MainThread]: Found 2 models, 3 data tests, 578 macros
[0m16:23:34.470556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b8a4bb-7fa8-44f9-a990-89a931f3b07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FF07A810>]}
[0m16:23:34.473651 [info ] [MainThread]: 
[0m16:23:34.475316 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:23:34.478130 [info ] [MainThread]: 
[0m16:23:34.480503 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:23:34.484337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m16:23:34.690040 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m16:23:34.705870 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:23:34.706904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:34.833317 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.128 seconds
[0m16:23:34.837957 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m16:23:34.840444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m16:23:34.842330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m16:23:34.844603 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m16:23:34.859944 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m16:23:34.862017 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:23:34.863129 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:23:34.864126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:34.864201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:35.015888 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.152 seconds
[0m16:23:35.019498 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m16:23:35.020878 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m16:23:35.027222 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.162 seconds
[0m16:23:35.030213 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m16:23:35.031671 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m16:23:35.041903 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:35.042935 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:23:35.044215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:35.161447 [debug] [MainThread]: SQL status: SELECT 2 in 0.132 seconds
[0m16:23:35.177069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70b8a4bb-7fa8-44f9-a990-89a931f3b07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FDAC8F10>]}
[0m16:23:35.177069 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:35.177069 [debug] [MainThread]: On master: COMMIT
[0m16:23:35.177069 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:35.177069 [debug] [MainThread]: On master: COMMIT
[0m16:23:35.177069 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:23:35.177069 [debug] [MainThread]: On master: Close
[0m16:23:35.192692 [debug] [Thread-1 (]: Began running node model.medical_warehouse.dim_channels
[0m16:23:35.192692 [info ] [Thread-1 (]: 1 of 1 START sql view model public_marts.dim_channels .......................... [RUN]
[0m16:23:35.192692 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m16:23:35.192692 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.dim_channels
[0m16:23:35.238820 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m16:23:35.397934 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.dim_channels
[0m16:23:35.500368 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m16:23:35.747619 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m16:23:35.747619 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  create view "medical_warehouse"."public_marts"."dim_channels__dbt_tmp"
    
    
  as (
    with source as (

    select
        channel_name
    from "medical_warehouse"."public_staging"."stg_telegram_messages"
    where channel_name is not null

),

deduplicated as (

    select distinct
        channel_name
    from source

)

select
    md5(cast(coalesce(cast(channel_name as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as channel_pk,
    channel_name
from deduplicated
  );
[0m16:23:35.747619 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:23:40.289561 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 4.534 seconds
[0m16:23:40.308650 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m16:23:40.310611 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "medical_warehouse"."public_marts"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m16:23:41.058780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.748 seconds
[0m16:23:41.090031 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m16:23:41.090031 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m16:23:41.090031 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m16:23:41.090031 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:23:41.106517 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."public_marts"."dim_channels__dbt_backup"
[0m16:23:41.106517 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m16:23:41.106517 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop view if exists "medical_warehouse"."public_marts"."dim_channels__dbt_backup" cascade
[0m16:23:41.199048 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.085 seconds
[0m16:23:41.199048 [debug] [Thread-1 (]: On model.medical_warehouse.dim_channels: Close
[0m16:23:41.214574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70b8a4bb-7fa8-44f9-a990-89a931f3b07f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FF57AE90>]}
[0m16:23:41.214574 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_marts.dim_channels ..................... [[32mCREATE VIEW[0m in 6.01s]
[0m16:23:41.214574 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.dim_channels
[0m16:23:41.214574 [debug] [MainThread]: On master: COMMIT
[0m16:23:41.214574 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:41.214574 [debug] [MainThread]: On master: COMMIT
[0m16:23:41.214574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:41.351464 [debug] [MainThread]: SQL status: COMMIT in 0.125 seconds
[0m16:23:41.352466 [debug] [MainThread]: On master: Close
[0m16:23:41.355456 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:41.356453 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m16:23:41.358447 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m16:23:41.359445 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m16:23:41.361438 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m16:23:41.362436 [info ] [MainThread]: 
[0m16:23:41.364432 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.88 seconds (6.88s).
[0m16:23:41.370414 [debug] [MainThread]: Command end result
[0m16:23:41.508751 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:23:41.515798 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:23:41.531824 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m16:23:41.533818 [info ] [MainThread]: 
[0m16:23:41.535813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:41.536810 [info ] [MainThread]: 
[0m16:23:41.538806 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:23:41.541801 [debug] [MainThread]: Command `dbt run` succeeded at 16:23:41.540799 after 9.24 seconds
[0m16:23:41.543794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F6FF2F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212F6FF3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212FDA66DD0>]}
[0m16:23:41.544790 [debug] [MainThread]: Flushing usage events
[0m16:23:43.315886 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:29:50.060273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7C08AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7C0BDF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7C0BD510>]}


============================== 16:29:50.140266 | 3c3294ec-48ae-4e78-99c8-37273a0c957a ==============================
[0m16:29:50.140266 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:29:50.142261 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt run --select fact_messages --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m16:29:52.491378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c3294ec-48ae-4e78-99c8-37273a0c957a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7D2531D0>]}
[0m16:29:52.829143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c3294ec-48ae-4e78-99c8-37273a0c957a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D788A85D0>]}
[0m16:29:52.833133 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:29:53.580772 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:29:53.989851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:29:53.991849 [debug] [MainThread]: Partial parsing: added file: medical_warehouse://models\marts\facts\fact_messages.sql
[0m16:29:54.950961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c3294ec-48ae-4e78-99c8-37273a0c957a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7D57E550>]}
[0m16:29:55.294019 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:29:55.294019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:29:55.356507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c3294ec-48ae-4e78-99c8-37273a0c957a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7B8F22D0>]}
[0m16:29:55.356507 [info ] [MainThread]: Found 3 models, 3 data tests, 578 macros
[0m16:29:55.356507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c3294ec-48ae-4e78-99c8-37273a0c957a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7D894310>]}
[0m16:29:55.372129 [info ] [MainThread]: 
[0m16:29:55.375124 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:29:55.376861 [info ] [MainThread]: 
[0m16:29:55.379412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:55.386458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m16:29:55.695022 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m16:29:55.695022 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:29:55.695022 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:55.914010 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.205 seconds
[0m16:29:55.914727 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m16:29:55.914727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m16:29:55.947844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m16:29:55.947844 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m16:29:55.964361 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:29:55.964361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:55.964361 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m16:29:55.964361 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:29:55.964361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:56.248478 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.277 seconds
[0m16:29:56.252795 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m16:29:56.253795 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.277 seconds
[0m16:29:56.254792 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m16:29:56.257783 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m16:29:56.261773 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m16:29:56.279128 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:56.282144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:29:56.285113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:56.431064 [debug] [MainThread]: SQL status: SELECT 3 in 0.156 seconds
[0m16:29:56.446686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c3294ec-48ae-4e78-99c8-37273a0c957a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7D7D1E90>]}
[0m16:29:56.447886 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:56.447886 [debug] [MainThread]: On master: COMMIT
[0m16:29:56.447886 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:56.447886 [debug] [MainThread]: On master: COMMIT
[0m16:29:56.447886 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:29:56.447886 [debug] [MainThread]: On master: Close
[0m16:29:56.464361 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fact_messages
[0m16:29:56.464361 [info ] [Thread-1 (]: 1 of 1 START sql view model public_marts.fact_messages ......................... [RUN]
[0m16:29:56.464361 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.fact_messages'
[0m16:29:56.464361 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fact_messages
[0m16:29:56.509744 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fact_messages"
[0m16:29:56.516713 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fact_messages
[0m16:29:56.608042 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fact_messages"
[0m16:29:56.612031 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m16:29:56.614026 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */

  create view "medical_warehouse"."public_marts"."fact_messages__dbt_tmp"
    
    
  as (
    with messages as (

    select
        message_pk,
        channel_name,
        message_id,
        message_date,
        sender_id,
        message_text
    from "medical_warehouse"."public_staging"."stg_telegram_messages"

),

channels as (

    select
        channel_pk,
        channel_name
    from "medical_warehouse"."public_marts"."dim_channels"

)

select
    m.message_pk,
    c.channel_pk,
    m.message_id,
    m.message_date,
    m.sender_id,
    m.message_text
from messages m
left join channels c
    on m.channel_name = c.channel_name
  );
[0m16:29:56.616021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:29:57.031310 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "message_id" does not exist
LINE 12:         message_id,
                 ^
HINT:  Perhaps you meant to reference the column "stg_telegram_messages.message_pk".

[0m16:29:57.031310 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: ROLLBACK
[0m16:29:57.031310 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: Close
[0m16:29:57.464983 [debug] [Thread-1 (]: Database Error in model fact_messages (models\marts\facts\fact_messages.sql)
  column "message_id" does not exist
  LINE 12:         message_id,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_telegram_messages.message_pk".
  compiled code at target\run\medical_warehouse\models\marts\facts\fact_messages.sql
[0m16:29:57.481421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c3294ec-48ae-4e78-99c8-37273a0c957a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7D8A89D0>]}
[0m16:29:57.483452 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public_marts.fact_messages ................ [[31mERROR[0m in 1.00s]
[0m16:29:57.485413 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fact_messages
[0m16:29:57.487405 [debug] [Thread-7 (]: Marking all children of 'model.medical_warehouse.fact_messages' to be skipped because of status 'error'.  Reason: Database Error in model fact_messages (models\marts\facts\fact_messages.sql)
  column "message_id" does not exist
  LINE 12:         message_id,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_telegram_messages.message_pk".
  compiled code at target\run\medical_warehouse\models\marts\facts\fact_messages.sql.
[0m16:29:57.490396 [debug] [MainThread]: On master: COMMIT
[0m16:29:57.491429 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:57.492397 [debug] [MainThread]: On master: COMMIT
[0m16:29:57.493432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:58.097840 [debug] [MainThread]: SQL status: COMMIT in 0.612 seconds
[0m16:29:58.097840 [debug] [MainThread]: On master: Close
[0m16:29:58.097840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:58.097840 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m16:29:58.097840 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m16:29:58.097840 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m16:29:58.114383 [debug] [MainThread]: Connection 'model.medical_warehouse.fact_messages' was properly closed.
[0m16:29:58.114383 [info ] [MainThread]: 
[0m16:29:58.114383 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m16:29:58.114383 [debug] [MainThread]: Command end result
[0m16:29:58.201077 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:29:58.209059 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:29:58.223019 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m16:29:58.225015 [info ] [MainThread]: 
[0m16:29:58.227013 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:29:58.229006 [info ] [MainThread]: 
[0m16:29:58.230677 [error] [MainThread]: [31mFailure in model fact_messages (models\marts\facts\fact_messages.sql)[0m
[0m16:29:58.232675 [error] [MainThread]:   Database Error in model fact_messages (models\marts\facts\fact_messages.sql)
  column "message_id" does not exist
  LINE 12:         message_id,
                   ^
  HINT:  Perhaps you meant to reference the column "stg_telegram_messages.message_pk".
  compiled code at target\run\medical_warehouse\models\marts\facts\fact_messages.sql
[0m16:29:58.234669 [info ] [MainThread]: 
[0m16:29:58.236662 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\marts\facts\fact_messages.sql
[0m16:29:58.237660 [info ] [MainThread]: 
[0m16:29:58.239653 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:29:58.241650 [debug] [MainThread]: Command `dbt run` failed at 16:29:58.241650 after 8.58 seconds
[0m16:29:58.242645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7D8ABB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D753F5390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D7BE1B310>]}
[0m16:29:58.243643 [debug] [MainThread]: Flushing usage events
[0m16:30:00.249467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:16.596834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A991C542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A991C56990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A991C56E10>]}


============================== 16:32:16.604813 | 4b31ecb7-eeeb-4bbc-a621-92f7efebb68f ==============================
[0m16:32:16.604813 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:32:16.606844 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select fact_messages --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m16:32:16.949901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b31ecb7-eeeb-4bbc-a621-92f7efebb68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A992EA65D0>]}
[0m16:32:17.059981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b31ecb7-eeeb-4bbc-a621-92f7efebb68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A98E48A350>]}
[0m16:32:17.075605 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:32:17.654671 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:32:17.960519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:32:17.960519 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\staging\schema.yml
[0m16:32:17.960519 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\marts\facts\fact_messages.sql
[0m16:32:18.809668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b31ecb7-eeeb-4bbc-a621-92f7efebb68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A991478F50>]}
[0m16:32:18.980287 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:32:18.980287 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:32:19.028125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b31ecb7-eeeb-4bbc-a621-92f7efebb68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9933A3350>]}
[0m16:32:19.029163 [info ] [MainThread]: Found 3 models, 10 data tests, 578 macros
[0m16:32:19.031123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b31ecb7-eeeb-4bbc-a621-92f7efebb68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A99337E8D0>]}
[0m16:32:19.045218 [info ] [MainThread]: 
[0m16:32:19.047156 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:32:19.049150 [info ] [MainThread]: 
[0m16:32:19.052710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:32:19.060486 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m16:32:19.215828 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m16:32:19.215828 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:32:19.215828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:19.324184 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.117 seconds
[0m16:32:19.324184 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m16:32:19.339846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m16:32:19.339846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m16:32:19.355471 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m16:32:19.355471 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m16:32:19.355471 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:32:19.355471 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:32:19.355471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:19.355471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:19.497903 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.140 seconds
[0m16:32:19.497903 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m16:32:19.497903 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m16:32:19.526742 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.157 seconds
[0m16:32:19.529737 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m16:32:19.531729 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m16:32:19.541703 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:19.542701 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:32:19.543743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:19.669232 [debug] [MainThread]: SQL status: SELECT 3 in 0.113 seconds
[0m16:32:19.669232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b31ecb7-eeeb-4bbc-a621-92f7efebb68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A992E326D0>]}
[0m16:32:19.669232 [debug] [MainThread]: On master: ROLLBACK
[0m16:32:19.669232 [debug] [MainThread]: On master: COMMIT
[0m16:32:19.669232 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:19.669232 [debug] [MainThread]: On master: COMMIT
[0m16:32:19.669232 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:32:19.669232 [debug] [MainThread]: On master: Close
[0m16:32:19.684853 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fact_messages
[0m16:32:19.684853 [info ] [Thread-1 (]: 1 of 1 START sql view model public_marts.fact_messages ......................... [RUN]
[0m16:32:19.684853 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.fact_messages'
[0m16:32:19.684853 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fact_messages
[0m16:32:19.711837 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fact_messages"
[0m16:32:19.711837 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fact_messages
[0m16:32:19.785100 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fact_messages"
[0m16:32:19.785100 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m16:32:19.785100 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */

  create view "medical_warehouse"."public_marts"."fact_messages__dbt_tmp"
    
    
  as (
    with messages as (

    select
        message_pk,
        channel_name,
        message_date,
        sender_id,
        message_text
    from "medical_warehouse"."public_staging"."stg_telegram_messages"

),

channels as (

    select
        channel_pk,
        channel_name
    from "medical_warehouse"."public_marts"."dim_channels"

)

select
    m.message_pk,
    c.channel_pk,
    m.message_date,
    m.sender_id,
    m.message_text
from messages m
left join channels c
    on m.channel_name = c.channel_name
  );
[0m16:32:19.785100 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:32:20.121187 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.333 seconds
[0m16:32:20.136747 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m16:32:20.136747 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */
alter table "medical_warehouse"."public_marts"."fact_messages__dbt_tmp" rename to "fact_messages"
[0m16:32:20.230269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.090 seconds
[0m16:32:20.245868 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: COMMIT
[0m16:32:20.245868 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m16:32:20.245868 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: COMMIT
[0m16:32:20.261416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:32:20.261416 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."public_marts"."fact_messages__dbt_backup"
[0m16:32:20.277041 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m16:32:20.277041 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */
drop view if exists "medical_warehouse"."public_marts"."fact_messages__dbt_backup" cascade
[0m16:32:20.277041 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:32:20.277041 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: Close
[0m16:32:20.292660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b31ecb7-eeeb-4bbc-a621-92f7efebb68f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A993491D90>]}
[0m16:32:20.292660 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_marts.fact_messages .................... [[32mCREATE VIEW[0m in 0.61s]
[0m16:32:20.292660 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fact_messages
[0m16:32:20.292660 [debug] [MainThread]: On master: COMMIT
[0m16:32:20.292660 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:20.292660 [debug] [MainThread]: On master: COMMIT
[0m16:32:20.292660 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:32:20.415502 [debug] [MainThread]: SQL status: COMMIT in 0.109 seconds
[0m16:32:20.415502 [debug] [MainThread]: On master: Close
[0m16:32:20.415502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:20.415502 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m16:32:20.415502 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m16:32:20.415502 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m16:32:20.415502 [debug] [MainThread]: Connection 'model.medical_warehouse.fact_messages' was properly closed.
[0m16:32:20.415502 [info ] [MainThread]: 
[0m16:32:20.415502 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m16:32:20.415502 [debug] [MainThread]: Command end result
[0m16:32:20.510597 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:32:20.515583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:32:20.526552 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m16:32:20.527557 [info ] [MainThread]: 
[0m16:32:20.529546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:20.531542 [info ] [MainThread]: 
[0m16:32:20.533538 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:32:20.537523 [debug] [MainThread]: Command `dbt run` succeeded at 16:32:20.537523 after 4.13 seconds
[0m16:32:20.539519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A98B004E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A98B0051D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A98B005610>]}
[0m16:32:20.541514 [debug] [MainThread]: Flushing usage events
[0m16:32:22.284663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:49.168308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4C397590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4C333E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4C332ED0>]}


============================== 16:32:49.168308 | 35e6fca3-502d-4452-b2bc-2e2d9b9791e9 ==============================
[0m16:32:49.168308 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:32:49.168308 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'invocation_command': 'dbt test --profiles-dir .', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m16:32:49.559987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35e6fca3-502d-4452-b2bc-2e2d9b9791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4C334A50>]}
[0m16:32:49.684967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35e6fca3-502d-4452-b2bc-2e2d9b9791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C48B88450>]}
[0m16:32:49.684967 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:32:50.267135 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:32:50.528486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:50.528486 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:32:50.528486 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:50.620804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35e6fca3-502d-4452-b2bc-2e2d9b9791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4D5F9690>]}
[0m16:32:50.815284 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:32:50.818593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:32:50.927945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35e6fca3-502d-4452-b2bc-2e2d9b9791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4DBF6790>]}
[0m16:32:50.927945 [info ] [MainThread]: Found 3 models, 10 data tests, 578 macros
[0m16:32:50.927945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35e6fca3-502d-4452-b2bc-2e2d9b9791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4DA7FC10>]}
[0m16:32:50.944722 [info ] [MainThread]: 
[0m16:32:50.946876 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:32:50.948870 [info ] [MainThread]: 
[0m16:32:50.951862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:32:50.963830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m16:32:50.965824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m16:32:51.183968 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m16:32:51.183968 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m16:32:51.183968 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:32:51.183968 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:32:51.183968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:51.183968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:51.367581 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.174 seconds
[0m16:32:51.367581 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m16:32:51.367581 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m16:32:51.367581 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.184 seconds
[0m16:32:51.367581 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m16:32:51.367581 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m16:32:51.383199 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:51.383199 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:32:51.383199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:51.497452 [debug] [MainThread]: SQL status: SELECT 5 in 0.111 seconds
[0m16:32:51.513076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35e6fca3-502d-4452-b2bc-2e2d9b9791e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4DF8DD10>]}
[0m16:32:51.513076 [debug] [MainThread]: On master: ROLLBACK
[0m16:32:51.513076 [debug] [MainThread]: On master: COMMIT
[0m16:32:51.513076 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:51.513076 [debug] [MainThread]: On master: COMMIT
[0m16:32:51.513076 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:32:51.513076 [debug] [MainThread]: On master: Close
[0m16:32:51.513076 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:32:51.513076 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:32:51.513076 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:32:51.528695 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:32:51.528695 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m16:32:51.528695 [info ] [Thread-2 (]: 2 of 10 START test not_null_dim_channels_channel_pk ............................ [RUN]
[0m16:32:51.528695 [info ] [Thread-3 (]: 3 of 10 START test not_null_fact_messages_channel_pk ........................... [RUN]
[0m16:32:51.528695 [info ] [Thread-4 (]: 4 of 10 START test not_null_fact_messages_message_date ......................... [RUN]
[0m16:32:51.536535 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b'
[0m16:32:51.538529 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43'
[0m16:32:51.541067 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48'
[0m16:32:51.543058 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf'
[0m16:32:51.545068 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:32:51.545068 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:32:51.551578 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:32:51.553571 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:32:51.589663 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m16:32:51.597641 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m16:32:51.607205 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m16:32:51.615183 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m16:32:51.620206 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:32:51.620206 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:32:51.620206 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:32:51.620206 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:32:51.651454 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m16:32:51.651454 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m16:32:51.667073 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m16:32:51.667073 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m16:32:51.682698 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m16:32:51.682698 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_marts"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m16:32:51.682698 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m16:32:51.682698 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:32:51.682698 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m16:32:51.682698 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m16:32:51.682698 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_pk
from "medical_warehouse"."public_marts"."dim_channels"
where channel_pk is null



  
  
      
    ) dbt_internal_test
[0m16:32:51.682698 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_pk
from "medical_warehouse"."public_marts"."fact_messages"
where channel_pk is null



  
  
      
    ) dbt_internal_test
[0m16:32:51.698324 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "medical_warehouse"."public_marts"."fact_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m16:32:51.698324 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:32:51.698324 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:32:51.698324 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:32:52.167993 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.483 seconds
[0m16:32:52.167993 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.476 seconds
[0m16:32:52.167993 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.475 seconds
[0m16:32:52.167993 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.475 seconds
[0m16:32:52.183500 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m16:32:52.183500 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43: ROLLBACK
[0m16:32:52.183500 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48: ROLLBACK
[0m16:32:52.183500 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf: ROLLBACK
[0m16:32:52.183500 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m16:32:52.183500 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43: Close
[0m16:32:52.183500 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48: Close
[0m16:32:52.183500 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf: Close
[0m16:32:52.199123 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.67s]
[0m16:32:52.199123 [info ] [Thread-2 (]: 2 of 10 PASS not_null_dim_channels_channel_pk .................................. [[32mPASS[0m in 0.66s]
[0m16:32:52.199123 [info ] [Thread-3 (]: 3 of 10 PASS not_null_fact_messages_channel_pk ................................. [[32mPASS[0m in 0.66s]
[0m16:32:52.199123 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:32:52.199123 [error] [Thread-4 (]: 4 of 10 FAIL 400 not_null_fact_messages_message_date ........................... [[31mFAIL 400[0m in 0.66s]
[0m16:32:52.211936 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:32:52.213928 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:32:52.216917 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:32:52.218822 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:32:52.221128 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:32:52.223123 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:32:52.227112 [debug] [Thread-4 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:32:52.225117 [info ] [Thread-1 (]: 5 of 10 START test not_null_fact_messages_message_pk ........................... [RUN]
[0m16:32:52.240171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923)
[0m16:32:52.240171 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:32:52.262765 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m16:32:52.229899 [info ] [Thread-2 (]: 6 of 10 START test not_null_stg_telegram_messages_channel_name ................. [RUN]
[0m16:32:52.232797 [info ] [Thread-3 (]: 7 of 10 START test not_null_stg_telegram_messages_message_pk ................... [RUN]
[0m16:32:52.267565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43, now test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8)
[0m16:32:52.235253 [info ] [Thread-4 (]: 8 of 10 START test unique_dim_channels_channel_pk .............................. [RUN]
[0m16:32:52.269291 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48, now test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1)
[0m16:32:52.269291 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:32:52.269291 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:32:52.269291 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf, now test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936)
[0m16:32:52.269291 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:32:52.288868 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m16:32:52.294590 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m16:32:52.294590 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:32:52.302638 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m16:32:52.319259 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m16:32:52.319259 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m16:32:52.334880 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:32:52.336256 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_warehouse"."public_marts"."fact_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m16:32:52.336256 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:32:52.336256 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m16:32:52.336256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:52.336256 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:32:52.355260 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m16:32:52.367228 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m16:32:52.369882 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m16:32:52.371877 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m16:32:52.373872 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m16:32:52.374870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:32:52.376877 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m16:32:52.378859 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m16:32:52.380853 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:32:52.381851 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_marts"."dim_channels"
where channel_pk is not null
group by channel_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:32:52.384152 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:32:52.512381 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.175 seconds
[0m16:32:52.528002 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923: ROLLBACK
[0m16:32:52.528002 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923: Close
[0m16:32:52.528002 [info ] [Thread-1 (]: 5 of 10 PASS not_null_fact_messages_message_pk ................................. [[32mPASS[0m in 0.29s]
[0m16:32:52.528002 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:32:52.528002 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:32:52.528002 [info ] [Thread-1 (]: 9 of 10 START test unique_fact_messages_message_pk ............................. [RUN]
[0m16:32:52.543622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923, now test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d)
[0m16:32:52.543622 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:32:52.559245 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m16:32:52.559245 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.190 seconds
[0m16:32:52.570480 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m16:32:52.572475 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m16:32:52.575468 [info ] [Thread-2 (]: 6 of 10 PASS not_null_stg_telegram_messages_channel_name ....................... [[32mPASS[0m in 0.31s]
[0m16:32:52.577289 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:32:52.577289 [debug] [Thread-2 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:32:52.577289 [info ] [Thread-2 (]: 10 of 10 START test unique_stg_telegram_messages_message_pk .................... [RUN]
[0m16:32:52.577289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8, now test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5)
[0m16:32:52.577289 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:32:52.592910 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m16:32:52.624155 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:32:52.624155 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m16:32:52.624155 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:32:52.639774 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m16:32:52.639774 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m16:32:52.639774 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m16:32:52.639774 [debug] [Thread-1 (]: On test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_marts"."fact_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:32:52.639774 [debug] [Thread-2 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:32:52.656202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:52.658197 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:32:52.664178 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.284 seconds
[0m16:32:52.667173 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: ROLLBACK
[0m16:32:52.668168 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: Close
[0m16:32:52.669214 [info ] [Thread-3 (]: 7 of 10 PASS not_null_stg_telegram_messages_message_pk ......................... [[32mPASS[0m in 0.40s]
[0m16:32:52.669214 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:32:52.809629 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.428 seconds
[0m16:32:52.809629 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936: ROLLBACK
[0m16:32:52.809629 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936: Close
[0m16:32:52.809629 [info ] [Thread-4 (]: 8 of 10 PASS unique_dim_channels_channel_pk .................................... [[32mPASS[0m in 0.54s]
[0m16:32:52.809629 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:32:52.935378 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.287 seconds
[0m16:32:52.935378 [debug] [Thread-1 (]: On test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d: ROLLBACK
[0m16:32:52.935378 [debug] [Thread-1 (]: On test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d: Close
[0m16:32:52.951000 [info ] [Thread-1 (]: 9 of 10 PASS unique_fact_messages_message_pk ................................... [[32mPASS[0m in 0.39s]
[0m16:32:52.951000 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:32:52.951000 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.302 seconds
[0m16:32:52.951000 [debug] [Thread-2 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: ROLLBACK
[0m16:32:52.951000 [debug] [Thread-2 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: Close
[0m16:32:52.966622 [info ] [Thread-2 (]: 10 of 10 PASS unique_stg_telegram_messages_message_pk .......................... [[32mPASS[0m in 0.37s]
[0m16:32:52.966622 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:32:52.966622 [debug] [MainThread]: On master: COMMIT
[0m16:32:52.966622 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:52.966622 [debug] [MainThread]: On master: COMMIT
[0m16:32:52.966622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:32:53.081213 [debug] [MainThread]: SQL status: COMMIT in 0.105 seconds
[0m16:32:53.082253 [debug] [MainThread]: On master: Close
[0m16:32:53.084208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:53.085240 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m16:32:53.087201 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m16:32:53.088195 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d' was properly closed.
[0m16:32:53.089194 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5' was properly closed.
[0m16:32:53.090190 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1' was properly closed.
[0m16:32:53.091286 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936' was properly closed.
[0m16:32:53.093291 [info ] [MainThread]: 
[0m16:32:53.094283 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m16:32:53.098306 [debug] [MainThread]: Command end result
[0m16:32:53.238677 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:32:53.243665 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:32:53.253718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m16:32:53.253718 [info ] [MainThread]: 
[0m16:32:53.253718 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:32:53.253718 [info ] [MainThread]: 
[0m16:32:53.253718 [error] [MainThread]: [31mFailure in test not_null_fact_messages_message_date (models\staging\schema.yml)[0m
[0m16:32:53.253718 [error] [MainThread]:   Got 400 results, configured to fail if != 0
[0m16:32:53.268899 [info ] [MainThread]: 
[0m16:32:53.270894 [info ] [MainThread]:   compiled code at target\compiled\medical_warehouse\models\staging\schema.yml\not_null_fact_messages_message_date.sql
[0m16:32:53.273886 [info ] [MainThread]: 
[0m16:32:53.276123 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m16:32:53.279116 [debug] [MainThread]: Command `dbt test` failed at 16:32:53.279116 after 4.31 seconds
[0m16:32:53.280118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4C334FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4C3362D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C4C334790>]}
[0m16:32:53.281111 [debug] [MainThread]: Flushing usage events
[0m16:32:54.745996 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:20.669418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD7A178D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD79BB1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD79B8210>]}


============================== 16:39:20.892504 | a303a4f8-e9cd-470a-8799-3657fec3ad6e ==============================
[0m16:39:20.892504 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:39:20.904662 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select fact_messages --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m16:39:29.479699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a303a4f8-e9cd-470a-8799-3657fec3ad6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD8B756D0>]}
[0m16:39:29.606761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a303a4f8-e9cd-470a-8799-3657fec3ad6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD41DA3D0>]}
[0m16:39:29.606761 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:39:30.680750 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:39:33.512210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:39:33.512210 [debug] [MainThread]: Partial parsing: updated file: medical_warehouse://models\marts\facts\fact_messages.sql
[0m16:39:34.463548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a303a4f8-e9cd-470a-8799-3657fec3ad6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD79B8050>]}
[0m16:39:34.653610 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:39:34.706431 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:39:36.403028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a303a4f8-e9cd-470a-8799-3657fec3ad6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD9152F50>]}
[0m16:39:36.403028 [info ] [MainThread]: Found 3 models, 10 data tests, 578 macros
[0m16:39:36.403028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a303a4f8-e9cd-470a-8799-3657fec3ad6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD4FA0210>]}
[0m16:39:36.403028 [info ] [MainThread]: 
[0m16:39:36.403028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:36.415267 [info ] [MainThread]: 
[0m16:39:36.418458 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:36.464649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m16:39:37.414410 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m16:39:37.414410 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:39:37.414410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:46.363769 [debug] [ThreadPool]: SQL status: SELECT 10 in 8.952 seconds
[0m16:39:46.379390 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m16:39:46.410634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m16:39:46.410634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m16:39:46.410634 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m16:39:46.426254 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m16:39:46.426254 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:39:46.426254 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:39:46.426254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:46.426254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:46.975180 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.555 seconds
[0m16:39:46.975180 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.556 seconds
[0m16:39:46.990838 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m16:39:46.990838 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m16:39:47.006517 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m16:39:47.006517 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m16:39:47.022083 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:47.022083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:39:47.022083 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:47.236568 [debug] [MainThread]: SQL status: SELECT 5 in 0.212 seconds
[0m16:39:47.240598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a303a4f8-e9cd-470a-8799-3657fec3ad6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD96FF2D0>]}
[0m16:39:47.241558 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:47.242558 [debug] [MainThread]: On master: COMMIT
[0m16:39:47.242558 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:47.243553 [debug] [MainThread]: On master: COMMIT
[0m16:39:47.245547 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:39:47.246548 [debug] [MainThread]: On master: Close
[0m16:39:47.371120 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fact_messages
[0m16:39:47.371120 [info ] [Thread-1 (]: 1 of 1 START sql view model public_marts.fact_messages ......................... [RUN]
[0m16:39:47.371120 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.fact_messages'
[0m16:39:47.371120 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fact_messages
[0m16:39:47.398538 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fact_messages"
[0m16:39:47.398538 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fact_messages
[0m16:39:47.484469 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fact_messages"
[0m16:39:47.487423 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m16:39:47.488456 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */

  create view "medical_warehouse"."public_marts"."fact_messages__dbt_tmp"
    
    
  as (
    with messages as (

    select
        message_pk,
        channel_name,
        message_date,
        sender_id,
        message_text
    from "medical_warehouse"."public_staging"."stg_telegram_messages"
    where message_date is not null

),

channels as (

    select
        channel_pk,
        channel_name
    from "medical_warehouse"."public_marts"."dim_channels"

)

select
    m.message_pk,
    c.channel_pk,
    m.message_date,
    m.sender_id,
    m.message_text
from messages m
left join channels c
    on m.channel_name = c.channel_name
  );
[0m16:39:47.490419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:39:47.886667 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.402 seconds
[0m16:39:47.905069 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m16:39:47.906065 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */
alter table "medical_warehouse"."public_marts"."fact_messages" rename to "fact_messages__dbt_backup"
[0m16:39:47.909064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:39:47.915913 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m16:39:47.915913 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */
alter table "medical_warehouse"."public_marts"."fact_messages__dbt_tmp" rename to "fact_messages"
[0m16:39:47.915913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:39:47.949154 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: COMMIT
[0m16:39:47.949154 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m16:39:47.949154 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: COMMIT
[0m16:39:48.015836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.052 seconds
[0m16:39:48.030916 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."public_marts"."fact_messages__dbt_backup"
[0m16:39:48.042881 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m16:39:48.043958 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */
drop view if exists "medical_warehouse"."public_marts"."fact_messages__dbt_backup" cascade
[0m16:39:48.163859 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.118 seconds
[0m16:39:48.164590 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: Close
[0m16:39:48.164590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a303a4f8-e9cd-470a-8799-3657fec3ad6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD9725A10>]}
[0m16:39:48.164590 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public_marts.fact_messages .................... [[32mCREATE VIEW[0m in 0.79s]
[0m16:39:48.164590 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fact_messages
[0m16:39:48.215654 [debug] [MainThread]: On master: COMMIT
[0m16:39:48.216652 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:48.218660 [debug] [MainThread]: On master: COMMIT
[0m16:39:48.219642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:48.329335 [debug] [MainThread]: SQL status: COMMIT in 0.119 seconds
[0m16:39:48.329335 [debug] [MainThread]: On master: Close
[0m16:39:48.329335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:48.329335 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m16:39:48.329335 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m16:39:48.329335 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m16:39:48.329335 [debug] [MainThread]: Connection 'model.medical_warehouse.fact_messages' was properly closed.
[0m16:39:48.370899 [info ] [MainThread]: 
[0m16:39:48.370899 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 11.93 seconds (11.93s).
[0m16:39:48.370899 [debug] [MainThread]: Command end result
[0m16:39:48.497009 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:39:48.497009 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:39:48.512631 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m16:39:48.528253 [info ] [MainThread]: 
[0m16:39:48.528253 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:39:48.528253 [info ] [MainThread]: 
[0m16:39:48.528253 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:39:48.538333 [debug] [MainThread]: Command `dbt run` succeeded at 16:39:48.538333 after 28.62 seconds
[0m16:39:48.540327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD7755410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD0D36690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BD78F0210>]}
[0m16:39:48.542321 [debug] [MainThread]: Flushing usage events
[0m16:39:51.387297 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:07.949225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE85DE7A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE85D86FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE85D87CD0>]}


============================== 16:40:07.964847 | 45939cc7-4153-453e-a94e-370725f9154d ==============================
[0m16:40:07.964847 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:40:07.964847 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'invocation_command': 'dbt test --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m16:40:08.403354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45939cc7-4153-453e-a94e-370725f9154d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE86F22510>]}
[0m16:40:08.512518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45939cc7-4153-453e-a94e-370725f9154d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE825A82D0>]}
[0m16:40:08.512518 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:40:09.148758 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:40:09.423045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:09.424042 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:40:09.425040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:09.497118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45939cc7-4153-453e-a94e-370725f9154d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE871B3950>]}
[0m16:40:09.647771 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:40:09.653933 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:40:10.543835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45939cc7-4153-453e-a94e-370725f9154d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE87646810>]}
[0m16:40:10.543835 [info ] [MainThread]: Found 3 models, 10 data tests, 578 macros
[0m16:40:10.543835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45939cc7-4153-453e-a94e-370725f9154d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE874D7410>]}
[0m16:40:10.543835 [info ] [MainThread]: 
[0m16:40:10.543835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:10.559856 [info ] [MainThread]: 
[0m16:40:10.561882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:10.572869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m16:40:10.572869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m16:40:10.810142 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m16:40:10.810142 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m16:40:10.810142 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:40:10.810142 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:40:10.810142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:10.825844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:10.997446 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.182 seconds
[0m16:40:10.997446 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m16:40:10.997446 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m16:40:11.119253 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.294 seconds
[0m16:40:11.122270 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m16:40:11.122270 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m16:40:11.122270 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:11.122270 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:40:11.137894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:11.283352 [debug] [MainThread]: SQL status: SELECT 5 in 0.145 seconds
[0m16:40:11.287342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45939cc7-4153-453e-a94e-370725f9154d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8556E250>]}
[0m16:40:11.288339 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:11.289335 [debug] [MainThread]: On master: COMMIT
[0m16:40:11.290335 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:11.291331 [debug] [MainThread]: On master: COMMIT
[0m16:40:11.293373 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:40:11.293373 [debug] [MainThread]: On master: Close
[0m16:40:11.293373 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:40:11.293373 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:40:11.293373 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:40:11.293373 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:40:11.293373 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m16:40:11.293373 [info ] [Thread-2 (]: 2 of 10 START test not_null_dim_channels_channel_pk ............................ [RUN]
[0m16:40:11.293373 [info ] [Thread-3 (]: 3 of 10 START test not_null_fact_messages_channel_pk ........................... [RUN]
[0m16:40:11.308995 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b'
[0m16:40:11.308995 [info ] [Thread-4 (]: 4 of 10 START test not_null_fact_messages_message_date ......................... [RUN]
[0m16:40:11.313724 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43'
[0m16:40:11.315847 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48'
[0m16:40:11.315847 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:40:11.315847 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf'
[0m16:40:11.315847 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:40:11.315847 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:40:11.347640 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:40:11.351249 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m16:40:11.366313 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m16:40:11.385223 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m16:40:11.393202 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m16:40:11.396194 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:40:11.412919 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:40:11.431564 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m16:40:11.447186 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m16:40:11.447186 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:40:11.447186 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:40:11.447186 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m16:40:11.462807 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m16:40:11.462807 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m16:40:11.462807 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m16:40:11.462807 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_pk
from "medical_warehouse"."public_marts"."dim_channels"
where channel_pk is null



  
  
      
    ) dbt_internal_test
[0m16:40:11.462807 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_marts"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m16:40:11.462807 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m16:40:11.462807 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:40:11.462807 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:11.462807 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m16:40:11.462807 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "medical_warehouse"."public_marts"."fact_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m16:40:11.478427 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_pk
from "medical_warehouse"."public_marts"."fact_messages"
where channel_pk is null



  
  
      
    ) dbt_internal_test
[0m16:40:11.478427 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:40:11.478427 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:40:11.950280 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.477 seconds
[0m16:40:11.951281 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.468 seconds
[0m16:40:11.952312 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.472 seconds
[0m16:40:11.953272 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.481 seconds
[0m16:40:11.962249 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m16:40:11.966313 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48: ROLLBACK
[0m16:40:11.966313 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf: ROLLBACK
[0m16:40:11.966313 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43: ROLLBACK
[0m16:40:11.966313 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m16:40:11.966313 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48: Close
[0m16:40:11.966313 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf: Close
[0m16:40:11.966313 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43: Close
[0m16:40:11.981934 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 0.67s]
[0m16:40:11.981934 [info ] [Thread-3 (]: 3 of 10 PASS not_null_fact_messages_channel_pk ................................. [[32mPASS[0m in 0.67s]
[0m16:40:11.981934 [info ] [Thread-4 (]: 4 of 10 PASS not_null_fact_messages_message_date ............................... [[32mPASS[0m in 0.67s]
[0m16:40:11.992683 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:40:11.995124 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:40:11.999621 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:40:12.000415 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:40:11.981934 [info ] [Thread-2 (]: 2 of 10 PASS not_null_dim_channels_channel_pk .................................. [[32mPASS[0m in 0.67s]
[0m16:40:12.000415 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:40:12.000415 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:40:12.000415 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:40:12.000415 [info ] [Thread-1 (]: 5 of 10 START test not_null_fact_messages_message_pk ........................... [RUN]
[0m16:40:12.018084 [debug] [Thread-2 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:40:12.018783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923)
[0m16:40:12.000415 [info ] [Thread-3 (]: 6 of 10 START test not_null_stg_telegram_messages_channel_name ................. [RUN]
[0m16:40:12.018783 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:40:12.016125 [info ] [Thread-4 (]: 7 of 10 START test not_null_stg_telegram_messages_message_pk ................... [RUN]
[0m16:40:12.028016 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48, now test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8)
[0m16:40:12.018783 [info ] [Thread-2 (]: 8 of 10 START test unique_dim_channels_channel_pk .............................. [RUN]
[0m16:40:12.035119 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf, now test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1)
[0m16:40:12.035119 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:40:12.035119 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43, now test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936)
[0m16:40:12.080290 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:40:12.079292 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m16:40:12.035119 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:40:12.050179 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m16:40:12.101188 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m16:40:12.116645 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m16:40:12.138991 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:40:12.156947 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m16:40:12.165966 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:40:12.165966 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m16:40:12.181588 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:40:12.181588 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:40:12.206461 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m16:40:12.194493 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m16:40:12.196488 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m16:40:12.208456 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m16:40:12.211121 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m16:40:12.213117 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m16:40:12.217108 [debug] [Thread-2 (]: On test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_marts"."dim_channels"
where channel_pk is not null
group by channel_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:12.218102 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m16:40:12.219100 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m16:40:12.220096 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:12.221094 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:12.222091 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_warehouse"."public_marts"."fact_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m16:40:12.223089 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:12.227079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:12.378926 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.160 seconds
[0m16:40:12.378926 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m16:40:12.378926 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m16:40:12.378926 [info ] [Thread-3 (]: 6 of 10 PASS not_null_stg_telegram_messages_channel_name ....................... [[32mPASS[0m in 0.35s]
[0m16:40:12.394548 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:40:12.394548 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:40:12.394548 [info ] [Thread-3 (]: 9 of 10 START test unique_fact_messages_message_pk ............................. [RUN]
[0m16:40:12.440432 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8, now test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d)
[0m16:40:12.449677 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:40:12.451636 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.231 seconds
[0m16:40:12.466340 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m16:40:12.466340 [debug] [Thread-2 (]: On test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936: ROLLBACK
[0m16:40:12.466340 [debug] [Thread-2 (]: On test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936: Close
[0m16:40:12.487268 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:40:12.482306 [info ] [Thread-2 (]: 8 of 10 PASS unique_dim_channels_channel_pk .................................... [[32mPASS[0m in 0.45s]
[0m16:40:12.502973 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m16:40:12.504966 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:40:12.506962 [debug] [Thread-2 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:40:12.510951 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m16:40:12.512947 [debug] [Thread-3 (]: On test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_marts"."fact_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:12.514436 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:12.533228 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.316 seconds
[0m16:40:12.533228 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: ROLLBACK
[0m16:40:12.508957 [info ] [Thread-2 (]: 10 of 10 START test unique_stg_telegram_messages_message_pk .................... [RUN]
[0m16:40:12.547673 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: Close
[0m16:40:12.550755 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936, now test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5)
[0m16:40:12.556374 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:40:12.566441 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m16:40:12.552747 [info ] [Thread-4 (]: 7 of 10 PASS not_null_stg_telegram_messages_message_pk ......................... [[32mPASS[0m in 0.52s]
[0m16:40:12.566441 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.350 seconds
[0m16:40:12.566441 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:40:12.584289 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923: ROLLBACK
[0m16:40:12.587606 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923: Close
[0m16:40:12.588233 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:40:12.599517 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m16:40:12.588233 [info ] [Thread-1 (]: 5 of 10 PASS not_null_fact_messages_message_pk ................................. [[32mPASS[0m in 0.57s]
[0m16:40:12.599517 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:40:12.599517 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m16:40:12.616226 [debug] [Thread-2 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:40:12.618220 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:12.825230 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.218 seconds
[0m16:40:12.840852 [debug] [Thread-2 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: ROLLBACK
[0m16:40:12.840852 [debug] [Thread-2 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: Close
[0m16:40:12.840852 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.333 seconds
[0m16:40:12.840852 [debug] [Thread-3 (]: On test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d: ROLLBACK
[0m16:40:12.840852 [info ] [Thread-2 (]: 10 of 10 PASS unique_stg_telegram_messages_message_pk .......................... [[32mPASS[0m in 0.29s]
[0m16:40:12.856972 [debug] [Thread-3 (]: On test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d: Close
[0m16:40:12.857479 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:40:12.860246 [info ] [Thread-3 (]: 9 of 10 PASS unique_fact_messages_message_pk ................................... [[32mPASS[0m in 0.42s]
[0m16:40:12.863237 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:40:12.867746 [debug] [MainThread]: On master: COMMIT
[0m16:40:12.871629 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:12.873623 [debug] [MainThread]: On master: COMMIT
[0m16:40:12.874620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:12.996629 [debug] [MainThread]: SQL status: COMMIT in 0.131 seconds
[0m16:40:12.996629 [debug] [MainThread]: On master: Close
[0m16:40:12.996629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:12.996629 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m16:40:12.996629 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m16:40:13.012251 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923' was properly closed.
[0m16:40:13.012251 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5' was properly closed.
[0m16:40:13.012251 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d' was properly closed.
[0m16:40:13.012251 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1' was properly closed.
[0m16:40:13.012251 [info ] [MainThread]: 
[0m16:40:13.012251 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m16:40:13.012251 [debug] [MainThread]: Command end result
[0m16:40:13.104938 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:40:13.112917 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:40:13.132655 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m16:40:13.132655 [info ] [MainThread]: 
[0m16:40:13.132655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:13.132655 [info ] [MainThread]: 
[0m16:40:13.148278 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m16:40:13.153495 [debug] [MainThread]: Command `dbt test` succeeded at 16:40:13.152499 after 5.55 seconds
[0m16:40:13.155739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE85E0F9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE85E0FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE84600050>]}
[0m16:40:13.156746 [debug] [MainThread]: Flushing usage events
[0m16:40:14.668259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:27.285907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001183C3095D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001183C367B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001183C336550>]}


============================== 16:48:27.385368 | 9acb260a-2177-4544-9803-4b7186d98590 ==============================
[0m16:48:27.385368 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:48:27.385368 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs generate --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m16:48:28.830956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9acb260a-2177-4544-9803-4b7186d98590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001183D5034D0>]}
[0m16:48:28.950659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9acb260a-2177-4544-9803-4b7186d98590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011838B39F10>]}
[0m16:48:28.950659 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:48:29.745896 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:48:30.543287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:48:30.543287 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:48:30.543287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:48:30.622066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9acb260a-2177-4544-9803-4b7186d98590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001183D781810>]}
[0m16:48:30.985236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9acb260a-2177-4544-9803-4b7186d98590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001183DAB3F90>]}
[0m16:48:30.985236 [info ] [MainThread]: Found 3 models, 10 data tests, 578 macros
[0m16:48:30.985236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9acb260a-2177-4544-9803-4b7186d98590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001183D77CCD0>]}
[0m16:48:30.996031 [info ] [MainThread]: 
[0m16:48:30.999024 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:48:31.000032 [info ] [MainThread]: 
[0m16:48:31.007001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:31.052046 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m16:48:31.081371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m16:48:31.404135 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m16:48:31.405108 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m16:48:31.407101 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m16:48:31.408056 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m16:48:31.409122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:31.410127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:32.777649 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.371 seconds
[0m16:48:32.777649 [debug] [ThreadPool]: SQL status: SELECT 2 in 1.371 seconds
[0m16:48:32.777649 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m16:48:32.777649 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m16:48:32.777649 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m16:48:32.777649 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m16:48:32.808825 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:32.808825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:48:32.808825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:32.964619 [debug] [MainThread]: SQL status: SELECT 5 in 0.162 seconds
[0m16:48:32.964619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9acb260a-2177-4544-9803-4b7186d98590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001183C350F50>]}
[0m16:48:32.964619 [debug] [MainThread]: On master: ROLLBACK
[0m16:48:32.964619 [debug] [MainThread]: On master: Close
[0m16:48:33.042725 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m16:48:33.042725 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m16:48:33.042725 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m16:48:33.120840 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m16:48:33.152076 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m16:48:33.152076 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m16:48:33.167793 [debug] [Thread-3 (]: Began running node model.medical_warehouse.dim_channels
[0m16:48:33.167793 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:48:33.167793 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:48:33.167793 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m16:48:33.167793 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:48:33.167793 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8'
[0m16:48:33.167793 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1'
[0m16:48:33.167793 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.dim_channels
[0m16:48:33.167793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5)
[0m16:48:33.183318 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:48:33.183318 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:48:33.214563 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m16:48:33.214563 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:48:33.230211 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m16:48:33.249021 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m16:48:33.263047 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m16:48:33.265044 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.dim_channels
[0m16:48:33.268366 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.dim_channels
[0m16:48:33.269363 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:48:33.271357 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:48:33.272355 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:48:33.274384 [debug] [Thread-3 (]: Began running node model.medical_warehouse.fact_messages
[0m16:48:33.275346 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m16:48:33.277373 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m16:48:33.277373 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m16:48:33.277373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now model.medical_warehouse.fact_messages)
[0m16:48:33.277373 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:48:33.277373 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:48:33.277373 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:48:33.277373 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.fact_messages
[0m16:48:33.277373 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8, now test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m16:48:33.277373 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1, now test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43)
[0m16:48:33.277373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5, now test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936)
[0m16:48:33.293037 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.fact_messages"
[0m16:48:33.293037 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:48:33.293037 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:48:33.293037 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:48:33.293037 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m16:48:33.308633 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m16:48:33.308633 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.fact_messages
[0m16:48:33.324283 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m16:48:33.324283 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.fact_messages
[0m16:48:33.324283 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:48:33.324283 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:48:33.324283 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:48:33.339865 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m16:48:33.339865 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:48:33.339865 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m16:48:33.339865 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fact_messages, now test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48)
[0m16:48:33.339865 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:48:33.339865 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m16:48:33.339865 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:48:33.339865 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:48:33.339865 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf)
[0m16:48:33.339865 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:48:33.339865 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43, now test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923)
[0m16:48:33.355483 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m16:48:33.355483 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:48:33.355483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936, now test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d)
[0m16:48:33.355483 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:48:33.371103 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m16:48:33.371103 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:48:33.412447 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m16:48:33.413041 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:48:33.423189 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m16:48:33.425182 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:48:33.427178 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m16:48:33.429171 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:48:33.431168 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m16:48:33.434204 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m16:48:33.434204 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:48:33.434204 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m16:48:33.434204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:33.434204 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m16:48:33.434204 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m16:48:33.434204 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d' was properly closed.
[0m16:48:33.434204 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48' was properly closed.
[0m16:48:33.434204 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf' was properly closed.
[0m16:48:33.449827 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923' was properly closed.
[0m16:48:33.449827 [debug] [MainThread]: Command end result
[0m16:48:33.683783 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:48:33.713751 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:48:33.714853 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m16:48:33.761811 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m16:48:33.761811 [info ] [MainThread]: Building catalog
[0m16:48:33.777373 [debug] [ThreadPool]: Acquiring new postgres connection 'medical_warehouse.information_schema'
[0m16:48:33.798639 [debug] [ThreadPool]: Using postgres connection "medical_warehouse.information_schema"
[0m16:48:33.798639 [debug] [ThreadPool]: On medical_warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "medical_warehouse.information_schema"} */

    
    

    select
        'medical_warehouse' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_telegram_messages')) or (upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('fact_messages')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m16:48:33.798639 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:34.440259 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.633 seconds
[0m16:48:34.449235 [debug] [ThreadPool]: On medical_warehouse.information_schema: ROLLBACK
[0m16:48:34.450232 [debug] [ThreadPool]: On medical_warehouse.information_schema: Close
[0m16:48:34.481312 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\catalog.json
[0m16:48:34.580318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m16:48:34.586297 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m16:48:34.587294 [info ] [MainThread]: Catalog written to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\catalog.json
[0m16:48:34.590286 [debug] [MainThread]: Command `dbt docs generate` succeeded at 16:48:34.590286 after 7.74 seconds
[0m16:48:34.591327 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m16:48:34.591327 [debug] [MainThread]: Connection 'medical_warehouse.information_schema' was properly closed.
[0m16:48:34.591327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011835625910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011835625210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001183D575B90>]}
[0m16:48:34.599006 [debug] [MainThread]: Flushing usage events
[0m16:48:37.871315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:43.407170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016438DFAA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016438DFBB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016438DF96D0>]}


============================== 16:48:43.415152 | eb33ab68-39b7-4bb4-9ce0-1b35cd340b2b ==============================
[0m16:48:43.415152 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:48:43.417145 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt docs serve --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m16:48:43.763025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb33ab68-39b7-4bb4-9ce0-1b35cd340b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016438E83D90>]}
[0m16:48:43.909440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb33ab68-39b7-4bb4-9ce0-1b35cd340b2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016435619F50>]}
[0m16:48:48.172035 [error] [MainThread]: Encountered an error:
[WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions
[0m16:48:48.229786 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 456, in __init__
    self.server_bind()
  File "C:\Users\bia\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
PermissionError: [WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions

[0m16:48:48.331713 [debug] [MainThread]: Command `dbt docs serve` failed at 16:48:48.331713 after 5.13 seconds
[0m16:48:48.332708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016438E5F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016438E5DD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016438DFBC10>]}
[0m16:48:48.333708 [debug] [MainThread]: Flushing usage events
[0m16:48:50.175833 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:50.126729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E3AF7B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E2BDEFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E3AC6B90>]}


============================== 23:05:50.310946 | b8274223-fb9b-4c1e-9207-e5d6d1288909 ==============================
[0m23:05:50.310946 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:05:50.323086 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --select dim_dates --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:05:52.237605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8274223-fb9b-4c1e-9207-e5d6d1288909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E4C2FDD0>]}
[0m23:05:52.381331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8274223-fb9b-4c1e-9207-e5d6d1288909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E02CA2D0>]}
[0m23:05:52.388993 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:05:53.753377 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:05:54.819886 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:05:54.828023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8274223-fb9b-4c1e-9207-e5d6d1288909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E111B710>]}
[0m23:05:58.367832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.medical_warehouse.marts
- models.medical_warehouse.staging
[0m23:05:58.384024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8274223-fb9b-4c1e-9207-e5d6d1288909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E3B1FDD0>]}
[0m23:05:58.554864 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m23:05:58.579776 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m23:05:59.025257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8274223-fb9b-4c1e-9207-e5d6d1288909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E520DA10>]}
[0m23:05:59.026419 [info ] [MainThread]: Found 578 macros
[0m23:05:59.030080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8274223-fb9b-4c1e-9207-e5d6d1288909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E4C8B150>]}
[0m23:05:59.031979 [warn ] [MainThread]: The selection criterion 'dim_dates' does not match any enabled nodes
[0m23:05:59.035740 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:05:59.054378 [debug] [MainThread]: Command end result
[0m23:05:59.369075 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m23:05:59.380568 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m23:05:59.707737 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m23:05:59.718472 [debug] [MainThread]: Command `dbt run` succeeded at 23:05:59.717474 after 10.07 seconds
[0m23:05:59.723859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E3A9A010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6E3A991D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6DD023590>]}
[0m23:05:59.726351 [debug] [MainThread]: Flushing usage events
[0m23:06:02.976309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:15:50.055909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9C7E7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9C783FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9C783BD0>]}


============================== 23:15:50.118245 | 4a15a2fd-75ef-4d69-affd-b6e4ad2f110d ==============================
[0m23:15:50.118245 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:15:50.135698 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'invocation_command': 'dbt clean', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:15:51.280364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a15a2fd-75ef-4d69-affd-b6e4ad2f110d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9C7E9FD0>]}
[0m23:15:52.315860 [debug] [MainThread]: Command `dbt clean` succeeded at 23:15:52.315860 after 2.76 seconds
[0m23:15:52.322010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9C80FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9C785150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C9D85B550>]}
[0m23:15:52.326195 [debug] [MainThread]: Flushing usage events
[0m23:15:57.548168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:06.249661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263011FA6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026300F95110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263011FA7D0>]}


============================== 23:16:06.250659 | 3ee30a1b-7bdd-440b-94b2-c9c195838adb ==============================
[0m23:16:06.250659 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:16:06.258380 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:16:06.540789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ee30a1b-7bdd-440b-94b2-c9c195838adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263012589D0>]}
[0m23:16:11.798896 [debug] [MainThread]: Set downloads directory='C:\Users\bia\AppData\Local\Temp\dbt-downloads-1ge6np40'
[0m23:16:11.799894 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:16:13.376386 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:16:13.376386 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:16:14.600349 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:16:14.618702 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:16:29.011817 [info ] [MainThread]: Installed from version 1.1.1
[0m23:16:29.014189 [info ] [MainThread]: Updated version available: 1.3.3
[0m23:16:29.016319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3ee30a1b-7bdd-440b-94b2-c9c195838adb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002630234DA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002637DC71410>]}
[0m23:16:29.017577 [info ] [MainThread]: 
[0m23:16:29.019714 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:16:29.027095 [debug] [MainThread]: Command `dbt deps` succeeded at 23:16:29.027095 after 23.37 seconds
[0m23:16:29.028890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026301256A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002637A485210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002637A485910>]}
[0m23:16:29.031044 [debug] [MainThread]: Flushing usage events
[0m23:16:31.090548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:16:36.715905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFBB6C1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFC042B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFC38AB10>]}


============================== 23:16:36.725962 | 303451e2-7847-4d99-89b2-d1a59f9a81fb ==============================
[0m23:16:36.725962 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:16:36.728941 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --select dim_dates --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:16:37.355587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '303451e2-7847-4d99-89b2-d1a59f9a81fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFD51FED0>]}
[0m23:16:37.479543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '303451e2-7847-4d99-89b2-d1a59f9a81fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABF8BAA850>]}
[0m23:16:37.486078 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:16:38.330711 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:16:38.330711 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:16:38.338830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '303451e2-7847-4d99-89b2-d1a59f9a81fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFC3D2690>]}
[0m23:16:40.890287 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.medical_warehouse.marts
- models.medical_warehouse.staging
[0m23:16:40.896050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '303451e2-7847-4d99-89b2-d1a59f9a81fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFBB98050>]}
[0m23:16:41.170275 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m23:16:41.200258 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m23:16:41.352802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '303451e2-7847-4d99-89b2-d1a59f9a81fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFD9585D0>]}
[0m23:16:41.353798 [info ] [MainThread]: Found 578 macros
[0m23:16:41.357310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303451e2-7847-4d99-89b2-d1a59f9a81fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFB4BEF90>]}
[0m23:16:41.360263 [warn ] [MainThread]: The selection criterion 'dim_dates' does not match any enabled nodes
[0m23:16:41.364658 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:16:41.370318 [debug] [MainThread]: Command end result
[0m23:16:41.461169 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m23:16:41.468038 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m23:16:41.476711 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m23:16:41.478704 [debug] [MainThread]: Command `dbt run` succeeded at 23:16:41.478704 after 4.96 seconds
[0m23:16:41.478704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFB4BEFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFBB11690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABFD7AFA50>]}
[0m23:16:41.482206 [debug] [MainThread]: Flushing usage events
[0m23:16:43.799463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:28.911326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA2C07210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA2BAAB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA2BA9790>]}


============================== 23:21:28.989488 | c1a79126-954c-4f5d-9c62-4ddfc8c643dc ==============================
[0m23:21:28.989488 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:21:28.993560 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'invocation_command': 'dbt run --select dim_dates', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:21:30.330344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1a79126-954c-4f5d-9c62-4ddfc8c643dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA2C2FDD0>]}
[0m23:21:30.470189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1a79126-954c-4f5d-9c62-4ddfc8c643dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9F3EA590>]}
[0m23:21:30.487600 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:21:31.922979 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:21:33.619415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:21:33.619415 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:21:33.624745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:21:33.626708 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.medical_warehouse.marts
- models.medical_warehouse.staging
[0m23:21:33.671976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1a79126-954c-4f5d-9c62-4ddfc8c643dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA41A4F90>]}
[0m23:21:33.850930 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m23:21:33.911865 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m23:21:34.435528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1a79126-954c-4f5d-9c62-4ddfc8c643dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA4143910>]}
[0m23:21:34.436187 [info ] [MainThread]: Found 578 macros
[0m23:21:34.440370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a79126-954c-4f5d-9c62-4ddfc8c643dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA4056AD0>]}
[0m23:21:34.459460 [warn ] [MainThread]: The selection criterion 'dim_dates' does not match any enabled nodes
[0m23:21:34.469368 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:21:34.482680 [debug] [MainThread]: Command end result
[0m23:21:34.574077 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m23:21:34.576073 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m23:21:34.585876 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m23:21:34.587996 [debug] [MainThread]: Command `dbt run` succeeded at 23:21:34.587949 after 6.11 seconds
[0m23:21:34.589305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028FA2BAA850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9BF85650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F9BF85210>]}
[0m23:21:34.590304 [debug] [MainThread]: Flushing usage events
[0m23:21:37.502328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:32.970532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249F2F023D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249F6FE6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249F701AA10>]}


============================== 23:25:32.973838 | 6b99bea4-27f8-4def-96c9-4f68ad925276 ==============================
[0m23:25:32.973838 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:25:32.980950 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'invocation_command': 'dbt clean', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:25:33.293942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b99bea4-27f8-4def-96c9-4f68ad925276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249F80D3FD0>]}
[0m23:25:33.408133 [debug] [MainThread]: Command `dbt clean` succeeded at 23:25:33.407136 after 0.69 seconds
[0m23:25:33.409944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249F6FEAA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249F6FE8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249F6D7A110>]}
[0m23:25:33.412223 [debug] [MainThread]: Flushing usage events
[0m23:25:35.712970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:40.046445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B5165FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B4EBD9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B51623E90>]}


============================== 23:25:40.048490 | 0b3fe4be-e83c-49d6-902e-26123ab1dcdf ==============================
[0m23:25:40.048490 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:25:40.059271 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:25:40.306415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b3fe4be-e83c-49d6-902e-26123ab1dcdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B527704D0>]}
[0m23:25:40.992426 [debug] [MainThread]: Set downloads directory='C:\Users\bia\AppData\Local\Temp\dbt-downloads-e4tnaiy7'
[0m23:25:40.993428 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:25:42.663899 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:25:42.680628 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:25:43.747572 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:25:43.764562 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:25:49.951567 [info ] [MainThread]: Installed from version 1.1.1
[0m23:25:49.954308 [info ] [MainThread]: Updated version available: 1.3.3
[0m23:25:49.955974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0b3fe4be-e83c-49d6-902e-26123ab1dcdf', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B505C95D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B52725290>]}
[0m23:25:49.958539 [info ] [MainThread]: 
[0m23:25:49.959534 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:25:49.980814 [debug] [MainThread]: Command `dbt deps` succeeded at 23:25:49.980814 after 10.14 seconds
[0m23:25:49.980814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B516AD890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B512E2BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B51627ED0>]}
[0m23:25:49.988445 [debug] [MainThread]: Flushing usage events
[0m23:25:51.828133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:25:57.631015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A58D7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A5937310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A5937210>]}


============================== 23:25:57.634511 | 8dc13232-a47b-42f2-8856-e396d9b121f5 ==============================
[0m23:25:57.634511 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:25:57.645555 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'indirect_selection': 'eager', 'invocation_command': 'dbt ls --resource-type model', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:25:57.987126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8dc13232-a47b-42f2-8856-e396d9b121f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A6AC7710>]}
[0m23:25:58.100074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8dc13232-a47b-42f2-8856-e396d9b121f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A2108450>]}
[0m23:25:58.100074 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:25:58.901889 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:25:58.901889 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:25:58.905711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8dc13232-a47b-42f2-8856-e396d9b121f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A6AD8190>]}
[0m23:26:00.941758 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.staging
- models.marts
- models
[0m23:26:00.944714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8dc13232-a47b-42f2-8856-e396d9b121f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A239C210>]}
[0m23:26:01.088199 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m23:26:01.094807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m23:26:01.160839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8dc13232-a47b-42f2-8856-e396d9b121f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A6E34990>]}
[0m23:26:01.161834 [info ] [MainThread]: Found 578 macros
[0m23:26:01.164135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8dc13232-a47b-42f2-8856-e396d9b121f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A27F4610>]}
[0m23:26:01.165472 [warn ] [MainThread]: No nodes selected!
[0m23:26:01.168604 [debug] [MainThread]: Command `dbt ls` succeeded at 23:26:01.168604 after 3.74 seconds
[0m23:26:01.169602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A58D8F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A58DA190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001489EC753D0>]}
[0m23:26:01.169602 [debug] [MainThread]: Flushing usage events
[0m23:26:03.304481 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:27:36.251214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD9F7AE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD9F7AB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD9FADE10>]}


============================== 23:27:36.260076 | 867b0da2-7d59-47a9-afe4-eeb13afa4dce ==============================
[0m23:27:36.260076 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:27:36.266962 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'invocation_command': 'dbt run --select dim_dates', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:27:36.644757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '867b0da2-7d59-47a9-afe4-eeb13afa4dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDB145F10>]}
[0m23:27:36.769224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '867b0da2-7d59-47a9-afe4-eeb13afa4dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD679A390>]}
[0m23:27:36.776880 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:27:37.364212 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:27:37.722721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:27:37.722721 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m23:27:37.722721 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:27:37.735280 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models
- models.marts
- models.staging
[0m23:27:37.752387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '867b0da2-7d59-47a9-afe4-eeb13afa4dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDB4EE310>]}
[0m23:27:37.884568 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m23:27:37.891458 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m23:27:37.931753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '867b0da2-7d59-47a9-afe4-eeb13afa4dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDB559990>]}
[0m23:27:37.932751 [info ] [MainThread]: Found 578 macros
[0m23:27:37.934515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '867b0da2-7d59-47a9-afe4-eeb13afa4dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DDB42A750>]}
[0m23:27:37.936173 [warn ] [MainThread]: The selection criterion 'dim_dates' does not match any enabled nodes
[0m23:27:37.938345 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:27:37.942785 [debug] [MainThread]: Command end result
[0m23:27:38.024175 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m23:27:38.028944 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m23:27:38.036539 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m23:27:38.038618 [debug] [MainThread]: Command `dbt run` succeeded at 23:27:38.038618 after 2.09 seconds
[0m23:27:38.039649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD90BEC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD3522F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028DD3265210>]}
[0m23:27:38.039649 [debug] [MainThread]: Flushing usage events
[0m23:27:40.278611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:30:32.326839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002495C4421D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249605279D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024960526ED0>]}


============================== 23:30:32.392396 | 5c52068c-2360-4c2b-a89c-e950f75b95fe ==============================
[0m23:30:32.392396 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:30:32.401176 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt clean', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:30:33.316253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c52068c-2360-4c2b-a89c-e950f75b95fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002496163FB10>]}
[0m23:30:33.919500 [debug] [MainThread]: Command `dbt clean` succeeded at 23:30:33.918501 after 2.04 seconds
[0m23:30:33.920044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249602C5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249601E3810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024959895910>]}
[0m23:30:33.921042 [debug] [MainThread]: Flushing usage events
[0m23:30:37.572624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:30:46.723436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A200377390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A20031B610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2003182D0>]}


============================== 23:30:46.724433 | bb8363cb-30ac-4a36-8422-4b0564290c6c ==============================
[0m23:30:46.724433 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:30:46.735299 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:30:47.017207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb8363cb-30ac-4a36-8422-4b0564290c6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2013E85D0>]}
[0m23:30:47.304135 [debug] [MainThread]: Set downloads directory='C:\Users\bia\AppData\Local\Temp\dbt-downloads-k9eb9bo6'
[0m23:30:47.305135 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m23:30:50.233682 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m23:30:50.239464 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m23:30:51.671664 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m23:30:51.688852 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m23:30:56.542643 [info ] [MainThread]: Installed from version 1.1.1
[0m23:30:56.544990 [info ] [MainThread]: Updated version available: 1.3.3
[0m23:30:56.546432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'bb8363cb-30ac-4a36-8422-4b0564290c6c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A27CDC6F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A27F36C650>]}
[0m23:30:56.546432 [info ] [MainThread]: 
[0m23:30:56.550214 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m23:30:56.560851 [debug] [MainThread]: Command `dbt deps` succeeded at 23:30:56.559853 after 10.20 seconds
[0m23:30:56.562132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A20034DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A200316A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A200317DD0>]}
[0m23:30:56.567047 [debug] [MainThread]: Flushing usage events
[0m23:30:58.623709 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:31:04.226983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93F48A910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93F48AED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93F48B450>]}


============================== 23:31:04.237321 | 0de2a1c0-e26c-4baa-be2c-6cd7d4515386 ==============================
[0m23:31:04.237321 [info ] [MainThread]: Running with dbt=1.11.2
[0m23:31:04.240396 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt ls --resource-type model', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m23:31:05.064820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0de2a1c0-e26c-4baa-be2c-6cd7d4515386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93F2258D0>]}
[0m23:31:05.174363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0de2a1c0-e26c-4baa-be2c-6cd7d4515386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93BCB82D0>]}
[0m23:31:05.179652 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m23:31:05.955945 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m23:31:05.955945 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:31:05.966134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0de2a1c0-e26c-4baa-be2c-6cd7d4515386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9408F9E10>]}
[0m23:31:09.536410 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `relationships` defined on 'fact_messages' in
package 'medical_warehouse' (models\marts\schema.yml). Arguments to generic
tests should be nested under the `arguments` property.
[0m23:31:09.544501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0de2a1c0-e26c-4baa-be2c-6cd7d4515386', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F940D74C90>]}
[0m23:31:09.608672 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named dim_channels. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for dim_channels in one of these files:
   - models\staging\schema.yml
  models\marts\schema.yml
[0m23:31:09.613727 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 2 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:31:09.616848 [debug] [MainThread]: Command `dbt ls` failed at 23:31:09.616848 after 5.59 seconds
[0m23:31:09.618002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93F50FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93F225690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F940B00C90>]}
[0m23:31:09.621397 [debug] [MainThread]: Flushing usage events
[0m23:31:13.780853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:16:42.652922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206156B7C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002061565B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002061565BC10>]}


============================== 01:16:42.746758 | 60ee32f6-886b-4268-9ad4-63a9adaa5da5 ==============================
[0m01:16:42.746758 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:16:42.762265 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt clean', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m01:16:44.248197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60ee32f6-886b-4268-9ad4-63a9adaa5da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020616732610>]}
[0m01:16:48.705028 [debug] [MainThread]: Command `dbt clean` succeeded at 01:16:48.705028 after 6.41 seconds
[0m01:16:48.705028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206156B7150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002061568B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002060E9B5910>]}
[0m01:16:48.705028 [debug] [MainThread]: Flushing usage events
[0m01:16:55.433561 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:17:02.174164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532DCE7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532DCE3B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532DD11ED0>]}


============================== 01:17:02.174164 | 0b56e411-da99-4dbd-a542-5d880583d4b1 ==============================
[0m01:17:02.174164 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:17:02.174164 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m01:17:02.457458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b56e411-da99-4dbd-a542-5d880583d4b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532EDBEB90>]}
[0m01:17:02.691747 [debug] [MainThread]: Set downloads directory='C:\Users\bia\AppData\Local\Temp\dbt-downloads-_ebobq1o'
[0m01:17:02.691747 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:17:05.530435 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:17:05.530435 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:17:06.690995 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:17:06.706579 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:17:10.453539 [info ] [MainThread]: Installed from version 1.1.1
[0m01:17:10.469076 [info ] [MainThread]: Updated version available: 1.3.3
[0m01:17:10.469076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0b56e411-da99-4dbd-a542-5d880583d4b1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532DCE3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002532EE11D10>]}
[0m01:17:10.469076 [info ] [MainThread]: 
[0m01:17:10.469076 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m01:17:10.469076 [debug] [MainThread]: Command `dbt deps` succeeded at 01:17:10.469076 after 8.54 seconds
[0m01:17:10.469076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025327065210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025327065910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025327065490>]}
[0m01:17:10.484698 [debug] [MainThread]: Flushing usage events
[0m01:17:12.022328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:17:17.040086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD43EB490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD4311D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD43E76D0>]}


============================== 01:17:17.055742 | 576aa3a0-3e65-4b30-b5ff-6b95c08c1f48 ==============================
[0m01:17:17.055742 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:17:17.055742 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt ls --resource-type model', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m01:17:18.719430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '576aa3a0-3e65-4b30-b5ff-6b95c08c1f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD5644B50>]}
[0m01:17:18.828778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '576aa3a0-3e65-4b30-b5ff-6b95c08c1f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD0C1A350>]}
[0m01:17:18.844361 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:17:19.644338 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:17:19.644338 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:17:19.644338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '576aa3a0-3e65-4b30-b5ff-6b95c08c1f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD4449250>]}
[0m01:17:22.778791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '576aa3a0-3e65-4b30-b5ff-6b95c08c1f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD5B97490>]}
[0m01:17:23.222805 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m01:17:23.298626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m01:17:23.907766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '576aa3a0-3e65-4b30-b5ff-6b95c08c1f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD5EABF10>]}
[0m01:17:23.908804 [info ] [MainThread]: Found 4 models, 13 data tests, 579 macros
[0m01:17:23.910763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '576aa3a0-3e65-4b30-b5ff-6b95c08c1f48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD5687DD0>]}
[0m01:17:23.912794 [info ] [MainThread]: medical_warehouse.marts.dimensions.dim_channels
[0m01:17:23.914439 [info ] [MainThread]: medical_warehouse.marts.dimensions.dim_dates
[0m01:17:23.916084 [info ] [MainThread]: medical_warehouse.marts.facts.fact_messages
[0m01:17:23.918088 [info ] [MainThread]: medical_warehouse.staging.stg_telegram_messages
[0m01:17:23.921558 [debug] [MainThread]: Command `dbt ls` succeeded at 01:17:23.920561 after 7.09 seconds
[0m01:17:23.922556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD446FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDD4185650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDCD765210>]}
[0m01:17:23.924588 [debug] [MainThread]: Flushing usage events
[0m01:17:25.494663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:05.579723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052205B550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020522058E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052205AFD0>]}


============================== 01:18:05.579723 | 74a1aa3c-4243-4eb1-ba9f-b656b257b1fe ==============================
[0m01:18:05.579723 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:18:05.595348 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m01:18:06.022630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74a1aa3c-4243-4eb1-ba9f-b656b257b1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205217C8790>]}
[0m01:18:06.141240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74a1aa3c-4243-4eb1-ba9f-b656b257b1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051E87A250>]}
[0m01:18:06.141240 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:18:06.755827 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:18:07.072596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:18:07.072596 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:18:07.072596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:18:07.155879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74a1aa3c-4243-4eb1-ba9f-b656b257b1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052366AE10>]}
[0m01:18:07.372689 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m01:18:07.372689 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m01:18:07.456556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74a1aa3c-4243-4eb1-ba9f-b656b257b1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051F6400D0>]}
[0m01:18:07.456556 [info ] [MainThread]: Found 4 models, 13 data tests, 579 macros
[0m01:18:07.456556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74a1aa3c-4243-4eb1-ba9f-b656b257b1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020522057C50>]}
[0m01:18:07.474672 [info ] [MainThread]: 
[0m01:18:07.475669 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:18:07.476850 [info ] [MainThread]: 
[0m01:18:07.480316 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:18:07.513322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m01:18:07.513322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse'
[0m01:18:08.605090 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m01:18:08.589335 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse"
[0m01:18:08.605720 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m01:18:08.605720 [debug] [ThreadPool]: On list_medical_warehouse: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse"} */

    select distinct nspname from pg_namespace
  
[0m01:18:08.605720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:08.605720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:12.088870 [debug] [ThreadPool]: SQL status: SELECT 10 in 3.485 seconds
[0m01:18:12.088870 [debug] [ThreadPool]: SQL status: SELECT 10 in 3.485 seconds
[0m01:18:12.088870 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m01:18:12.088870 [debug] [ThreadPool]: On list_medical_warehouse: Close
[0m01:18:12.104494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m01:18:12.104494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m01:18:12.120026 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m01:18:12.120026 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m01:18:12.120026 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m01:18:12.120026 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m01:18:12.120026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:12.120026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:12.854316 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.729 seconds
[0m01:18:12.854316 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.729 seconds
[0m01:18:12.854316 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m01:18:12.854316 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m01:18:12.869937 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m01:18:12.869937 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m01:18:12.885469 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:12.885469 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:18:12.885469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:13.244849 [debug] [MainThread]: SQL status: SELECT 5 in 0.348 seconds
[0m01:18:13.244849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74a1aa3c-4243-4eb1-ba9f-b656b257b1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002051EA4D050>]}
[0m01:18:13.244849 [debug] [MainThread]: On master: ROLLBACK
[0m01:18:13.244849 [debug] [MainThread]: On master: COMMIT
[0m01:18:13.244849 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:13.244849 [debug] [MainThread]: On master: COMMIT
[0m01:18:13.244849 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:18:13.244849 [debug] [MainThread]: On master: Close
[0m01:18:13.369819 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m01:18:13.369819 [info ] [Thread-1 (]: 1 of 4 START sql view model public_staging.stg_telegram_messages ............... [RUN]
[0m01:18:13.369819 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m01:18:13.369819 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m01:18:13.395705 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m01:18:13.406332 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m01:18:13.473573 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.stg_telegram_messages"
[0m01:18:13.490291 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:18:13.490291 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */

  create view "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_tmp"
    
    
  as (
    with source as (

    select
        id,
        channel_name,
        sender_id,
        message_text,
        message_date,
        raw_json
    from raw.telegram_messages

),

cleaned as (

    select
        cast(id as bigint)                    as message_pk,
        trim(channel_name)                    as channel_name,
        cast(sender_id as bigint)             as sender_id,
        cast(message_date as timestamp)       as message_date,
        nullif(trim(message_text), '')        as message_text,
        raw_json
    from source

)

select *
from cleaned
  );
[0m01:18:13.490291 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:18:14.062176 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.576 seconds
[0m01:18:14.089175 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:18:14.089175 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."public_staging"."stg_telegram_messages" rename to "stg_telegram_messages__dbt_backup"
[0m01:18:14.089175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:14.107121 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:18:14.109116 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
alter table "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_tmp" rename to "stg_telegram_messages"
[0m01:18:14.111111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:14.133636 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m01:18:14.149294 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:18:14.149294 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: COMMIT
[0m01:18:14.149294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m01:18:14.164883 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_backup"
[0m01:18:14.164883 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.stg_telegram_messages"
[0m01:18:14.164883 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.stg_telegram_messages"} */
drop view if exists "medical_warehouse"."public_staging"."stg_telegram_messages__dbt_backup" cascade
[0m01:18:14.323281 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.154 seconds
[0m01:18:14.338904 [debug] [Thread-1 (]: On model.medical_warehouse.stg_telegram_messages: Close
[0m01:18:14.338904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a1aa3c-4243-4eb1-ba9f-b656b257b1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052379DA10>]}
[0m01:18:14.338904 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public_staging.stg_telegram_messages .......... [[32mCREATE VIEW[0m in 0.97s]
[0m01:18:14.338904 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m01:18:14.441898 [debug] [Thread-3 (]: Began running node model.medical_warehouse.dim_channels
[0m01:18:14.442879 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_dates
[0m01:18:14.445018 [info ] [Thread-3 (]: 2 of 4 START sql view model public_marts.dim_channels .......................... [RUN]
[0m01:18:14.445018 [info ] [Thread-4 (]: 3 of 4 START sql view model public_marts.dim_dates ............................. [RUN]
[0m01:18:14.445018 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m01:18:14.445018 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_dates'
[0m01:18:14.445018 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.dim_channels
[0m01:18:14.445018 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_dates
[0m01:18:14.507426 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m01:18:14.507426 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m01:18:14.523137 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_dates
[0m01:18:14.524124 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.dim_channels
[0m01:18:14.533098 [debug] [Thread-4 (]: Writing runtime sql for node "model.medical_warehouse.dim_dates"
[0m01:18:14.543838 [debug] [Thread-3 (]: Writing runtime sql for node "model.medical_warehouse.dim_channels"
[0m01:18:14.548824 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:18:14.550821 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:18:14.551817 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */

  create view "medical_warehouse"."public_marts"."dim_dates__dbt_tmp"
    
    
  as (
    with dates as (

    select distinct
        cast(message_date as date) as date_day
    from "medical_warehouse"."public_staging"."stg_telegram_messages"
    where message_date is not null

)

select
    md5(cast(coalesce(cast(date_day as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as date_pk,
    date_day,
    extract(year from date_day)  as year,
    extract(month from date_day) as month,
    extract(day from date_day)   as day,
    extract(dow from date_day)   as day_of_week
from dates
  );
[0m01:18:14.553812 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */

  create view "medical_warehouse"."public_marts"."dim_channels__dbt_tmp"
    
    
  as (
    with source as (

    select
        channel_name
    from "medical_warehouse"."public_staging"."stg_telegram_messages"
    where channel_name is not null

),

deduplicated as (

    select distinct
        channel_name
    from source

)

select
    md5(cast(coalesce(cast(channel_name as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as channel_pk,
    channel_name
from deduplicated
  );
[0m01:18:14.555807 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:18:14.556858 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:18:14.784075 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.239 seconds
[0m01:18:14.799697 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:18:14.799697 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.255 seconds
[0m01:18:14.799697 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
alter table "medical_warehouse"."public_marts"."dim_channels__dbt_tmp" rename to "dim_channels"
[0m01:18:14.815318 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:18:14.815318 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
alter table "medical_warehouse"."public_marts"."dim_dates__dbt_tmp" rename to "dim_dates"
[0m01:18:14.830941 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:18:14.833426 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m01:18:14.839716 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m01:18:14.843709 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m01:18:14.845702 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:18:14.847698 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:18:14.849693 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: COMMIT
[0m01:18:14.851687 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: COMMIT
[0m01:18:14.855149 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m01:18:14.857821 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m01:18:14.869164 [debug] [Thread-3 (]: Applying DROP to: "medical_warehouse"."public_marts"."dim_channels__dbt_backup"
[0m01:18:14.881846 [debug] [Thread-4 (]: Applying DROP to: "medical_warehouse"."public_marts"."dim_dates__dbt_backup"
[0m01:18:14.891124 [debug] [Thread-3 (]: Using postgres connection "model.medical_warehouse.dim_channels"
[0m01:18:14.894115 [debug] [Thread-4 (]: Using postgres connection "model.medical_warehouse.dim_dates"
[0m01:18:14.896111 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_channels"} */
drop view if exists "medical_warehouse"."public_marts"."dim_channels__dbt_backup" cascade
[0m01:18:14.898103 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.dim_dates"} */
drop view if exists "medical_warehouse"."public_marts"."dim_dates__dbt_backup" cascade
[0m01:18:14.937399 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.037 seconds
[0m01:18:14.943480 [debug] [Thread-4 (]: On model.medical_warehouse.dim_dates: Close
[0m01:18:14.945476 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a1aa3c-4243-4eb1-ba9f-b656b257b1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020523A7E650>]}
[0m01:18:14.950463 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.050 seconds
[0m01:18:14.956553 [debug] [Thread-3 (]: On model.medical_warehouse.dim_channels: Close
[0m01:18:14.958825 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a1aa3c-4243-4eb1-ba9f-b656b257b1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020523C28DD0>]}
[0m01:18:14.948469 [info ] [Thread-4 (]: 3 of 4 OK created sql view model public_marts.dim_dates ........................ [[32mCREATE VIEW[0m in 0.50s]
[0m01:18:14.966625 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_dates
[0m01:18:14.961822 [info ] [Thread-3 (]: 2 of 4 OK created sql view model public_marts.dim_channels ..................... [[32mCREATE VIEW[0m in 0.51s]
[0m01:18:14.969614 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.dim_channels
[0m01:18:14.974413 [debug] [Thread-1 (]: Began running node model.medical_warehouse.fact_messages
[0m01:18:14.977405 [info ] [Thread-1 (]: 4 of 4 START sql view model public_marts.fact_messages ......................... [RUN]
[0m01:18:14.986166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now model.medical_warehouse.fact_messages)
[0m01:18:14.988606 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.fact_messages
[0m01:18:15.005961 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.fact_messages"
[0m01:18:15.030488 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.fact_messages
[0m01:18:15.053270 [debug] [Thread-1 (]: Writing runtime sql for node "model.medical_warehouse.fact_messages"
[0m01:18:15.063817 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m01:18:15.065813 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */

  create view "medical_warehouse"."public_marts"."fact_messages__dbt_tmp"
    
    
  as (
    with messages as (

    select
        message_pk,
        channel_name,
        message_date,
        sender_id,
        message_text
    from "medical_warehouse"."public_staging"."stg_telegram_messages"
    where message_date is not null

),

channels as (

    select
        channel_pk,
        channel_name
    from "medical_warehouse"."public_marts"."dim_channels"

)

select
    m.message_pk,
    c.channel_pk,
    m.message_date,
    m.sender_id,
    m.message_text
from messages m
left join channels c
    on m.channel_name = c.channel_name
  );
[0m01:18:15.066810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:15.408620 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.352 seconds
[0m01:18:15.424150 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m01:18:15.424150 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */
alter table "medical_warehouse"."public_marts"."fact_messages__dbt_tmp" rename to "fact_messages"
[0m01:18:15.424150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:18:15.424150 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: COMMIT
[0m01:18:15.424150 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m01:18:15.424150 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: COMMIT
[0m01:18:15.424150 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m01:18:15.439772 [debug] [Thread-1 (]: Applying DROP to: "medical_warehouse"."public_marts"."fact_messages__dbt_backup"
[0m01:18:15.439772 [debug] [Thread-1 (]: Using postgres connection "model.medical_warehouse.fact_messages"
[0m01:18:15.439772 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "model.medical_warehouse.fact_messages"} */
drop view if exists "medical_warehouse"."public_marts"."fact_messages__dbt_backup" cascade
[0m01:18:15.439772 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m01:18:15.439772 [debug] [Thread-1 (]: On model.medical_warehouse.fact_messages: Close
[0m01:18:15.439772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74a1aa3c-4243-4eb1-ba9f-b656b257b1fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205235F6050>]}
[0m01:18:15.455390 [info ] [Thread-1 (]: 4 of 4 OK created sql view model public_marts.fact_messages .................... [[32mCREATE VIEW[0m in 0.45s]
[0m01:18:15.455390 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.fact_messages
[0m01:18:15.463950 [debug] [MainThread]: On master: COMMIT
[0m01:18:15.465413 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:15.467410 [debug] [MainThread]: On master: COMMIT
[0m01:18:15.469405 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:15.670841 [debug] [MainThread]: SQL status: COMMIT in 0.202 seconds
[0m01:18:15.672172 [debug] [MainThread]: On master: Close
[0m01:18:15.674168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:15.675202 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m01:18:15.676196 [debug] [MainThread]: Connection 'list_medical_warehouse' was properly closed.
[0m01:18:15.677157 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m01:18:15.678191 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m01:18:15.679153 [debug] [MainThread]: Connection 'model.medical_warehouse.fact_messages' was properly closed.
[0m01:18:15.680185 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_channels' was properly closed.
[0m01:18:15.681187 [debug] [MainThread]: Connection 'model.medical_warehouse.dim_dates' was properly closed.
[0m01:18:15.688554 [info ] [MainThread]: 
[0m01:18:15.688554 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 8.20 seconds (8.20s).
[0m01:18:15.704176 [debug] [MainThread]: Command end result
[0m01:18:15.800062 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m01:18:15.805483 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m01:18:15.819447 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m01:18:15.820488 [info ] [MainThread]: 
[0m01:18:15.822440 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:15.823473 [info ] [MainThread]: 
[0m01:18:15.823473 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m01:18:15.828287 [debug] [MainThread]: Command `dbt run` succeeded at 01:18:15.828287 after 10.52 seconds
[0m01:18:15.829291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020522058E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020522056950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020522057F90>]}
[0m01:18:15.831280 [debug] [MainThread]: Flushing usage events
[0m01:18:17.543280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:18:22.294938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864E68BD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864E6882D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864E68A4D0>]}


============================== 01:18:22.310562 | 62f826fe-b79a-47c0-a488-5f05b2267fb2 ==============================
[0m01:18:22.310562 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:18:22.310562 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt test', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m01:18:22.676269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62f826fe-b79a-47c0-a488-5f05b2267fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864E342910>]}
[0m01:18:22.785616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62f826fe-b79a-47c0-a488-5f05b2267fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864AEB8290>]}
[0m01:18:22.785616 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:18:23.356138 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:18:23.656302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:18:23.656302 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:18:23.656302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:18:23.739449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62f826fe-b79a-47c0-a488-5f05b2267fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864FCB3690>]}
[0m01:18:23.956412 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m01:18:23.956412 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m01:18:24.074120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62f826fe-b79a-47c0-a488-5f05b2267fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864FEDBE10>]}
[0m01:18:24.074120 [info ] [MainThread]: Found 4 models, 13 data tests, 579 macros
[0m01:18:24.074120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f826fe-b79a-47c0-a488-5f05b2267fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864FB0AA90>]}
[0m01:18:24.074120 [info ] [MainThread]: 
[0m01:18:24.074120 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:18:24.087400 [info ] [MainThread]: 
[0m01:18:24.090391 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:18:24.103742 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m01:18:24.113818 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m01:18:24.332503 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m01:18:24.332503 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m01:18:24.332503 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m01:18:24.332503 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m01:18:24.332503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:24.332503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:24.551195 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.217 seconds
[0m01:18:24.551195 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.219 seconds
[0m01:18:24.551195 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m01:18:24.551195 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m01:18:24.551195 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m01:18:24.566819 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m01:18:24.582439 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:24.582439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:18:24.582439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:24.763553 [debug] [MainThread]: SQL status: SELECT 6 in 0.178 seconds
[0m01:18:24.763553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62f826fe-b79a-47c0-a488-5f05b2267fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864FAFBC10>]}
[0m01:18:24.763553 [debug] [MainThread]: On master: ROLLBACK
[0m01:18:24.763553 [debug] [MainThread]: On master: COMMIT
[0m01:18:24.763553 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:24.763553 [debug] [MainThread]: On master: COMMIT
[0m01:18:24.763553 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:18:24.763553 [debug] [MainThread]: On master: Close
[0m01:18:24.779140 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:18:24.779140 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m01:18:24.779140 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb
[0m01:18:24.779140 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m01:18:24.779140 [info ] [Thread-1 (]: 1 of 13 START test not_null_dim_channels_channel_name .......................... [RUN]
[0m01:18:24.779140 [info ] [Thread-2 (]: 2 of 13 START test not_null_dim_channels_channel_pk ............................ [RUN]
[0m01:18:24.779140 [info ] [Thread-3 (]: 3 of 13 START test not_null_dim_dates_date_day ................................. [RUN]
[0m01:18:24.779140 [info ] [Thread-4 (]: 4 of 13 START test not_null_fact_messages_channel_pk ........................... [RUN]
[0m01:18:24.794613 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b'
[0m01:18:24.796644 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43'
[0m01:18:24.797608 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb'
[0m01:18:24.798672 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48'
[0m01:18:24.798672 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:18:24.798672 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m01:18:24.798672 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb
[0m01:18:24.798672 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m01:18:24.861263 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:18:24.862059 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m01:18:24.868861 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb"
[0m01:18:24.878540 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m01:18:24.906711 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:18:24.906711 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m01:18:24.922332 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m01:18:24.937956 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb
[0m01:18:24.953623 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:18:24.953623 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m01:18:24.969236 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m01:18:24.969236 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb"
[0m01:18:24.969236 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:18:24.969236 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb"
[0m01:18:24.969236 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m01:18:24.969236 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_marts"."dim_channels"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m01:18:24.969236 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m01:18:24.984854 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from "medical_warehouse"."public_marts"."dim_dates"
where date_day is null



  
  
      
    ) dbt_internal_test
[0m01:18:24.984854 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_pk
from "medical_warehouse"."public_marts"."fact_messages"
where channel_pk is null



  
  
      
    ) dbt_internal_test
[0m01:18:24.984854 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:18:24.984854 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_pk
from "medical_warehouse"."public_marts"."dim_channels"
where channel_pk is null



  
  
      
    ) dbt_internal_test
[0m01:18:24.984854 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:18:24.984854 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:18:24.984854 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:18:25.823313 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.840 seconds
[0m01:18:25.823313 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.839 seconds
[0m01:18:25.823313 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: ROLLBACK
[0m01:18:25.839530 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb: ROLLBACK
[0m01:18:25.839530 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b: Close
[0m01:18:25.839530 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb: Close
[0m01:18:25.839530 [info ] [Thread-1 (]: 1 of 13 PASS not_null_dim_channels_channel_name ................................ [[32mPASS[0m in 1.06s]
[0m01:18:25.839530 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:18:25.839530 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m01:18:25.839530 [info ] [Thread-3 (]: 3 of 13 PASS not_null_dim_dates_date_day ....................................... [[32mPASS[0m in 1.04s]
[0m01:18:25.856139 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb
[0m01:18:25.856139 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m01:18:25.856139 [info ] [Thread-1 (]: 5 of 13 START test not_null_fact_messages_message_date ......................... [RUN]
[0m01:18:25.865857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf)
[0m01:18:25.862864 [info ] [Thread-3 (]: 6 of 13 START test not_null_fact_messages_message_pk ........................... [RUN]
[0m01:18:25.867897 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m01:18:25.867897 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb, now test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923)
[0m01:18:25.885487 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m01:18:25.891886 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m01:18:25.908254 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m01:18:25.916979 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m01:18:25.932902 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m01:18:25.946807 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m01:18:25.947806 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_date
from "medical_warehouse"."public_marts"."fact_messages"
where message_date is null



  
  
      
    ) dbt_internal_test
[0m01:18:25.949663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:25.958489 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m01:18:25.963639 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m01:18:25.976136 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m01:18:25.977138 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_warehouse"."public_marts"."fact_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m01:18:25.979128 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:18:26.021138 [debug] [Thread-4 (]: SQL status: SELECT 1 in 1.033 seconds
[0m01:18:26.021138 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48: ROLLBACK
[0m01:18:26.021138 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48: Close
[0m01:18:26.021138 [info ] [Thread-4 (]: 4 of 13 PASS not_null_fact_messages_channel_pk ................................. [[32mPASS[0m in 1.22s]
[0m01:18:26.036759 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m01:18:26.036759 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:18:26.036759 [info ] [Thread-4 (]: 7 of 13 START test not_null_stg_telegram_messages_channel_name ................. [RUN]
[0m01:18:26.036759 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48, now test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8)
[0m01:18:26.036759 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:18:26.055930 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:18:26.055930 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:18:26.081948 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:18:26.081948 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:18:26.088827 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select channel_name
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where channel_name is null



  
  
      
    ) dbt_internal_test
[0m01:18:26.090822 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:18:26.146135 [debug] [Thread-2 (]: SQL status: SELECT 1 in 1.152 seconds
[0m01:18:26.150124 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43: ROLLBACK
[0m01:18:26.152117 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43: Close
[0m01:18:26.155110 [info ] [Thread-2 (]: 2 of 13 PASS not_null_dim_channels_channel_pk .................................. [[32mPASS[0m in 1.36s]
[0m01:18:26.157151 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m01:18:26.157151 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m01:18:26.157151 [info ] [Thread-2 (]: 8 of 13 START test not_null_stg_telegram_messages_message_pk ................... [RUN]
[0m01:18:26.172773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43, now test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1)
[0m01:18:26.172773 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m01:18:26.188394 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m01:18:26.204015 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m01:18:26.219637 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m01:18:26.219637 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m01:18:26.219637 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select message_pk
from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is null



  
  
      
    ) dbt_internal_test
[0m01:18:26.219637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:18:26.280069 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.332 seconds
[0m01:18:26.280069 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf: ROLLBACK
[0m01:18:26.289382 [debug] [Thread-1 (]: On test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf: Close
[0m01:18:26.289382 [info ] [Thread-1 (]: 5 of 13 PASS not_null_fact_messages_message_date ............................... [[32mPASS[0m in 0.42s]
[0m01:18:26.289382 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m01:18:26.289382 [debug] [Thread-1 (]: Began running node test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c
[0m01:18:26.289382 [info ] [Thread-1 (]: 9 of 13 START test relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_  [RUN]
[0m01:18:26.289382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf, now test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c)
[0m01:18:26.307492 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c
[0m01:18:26.375484 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c"
[0m01:18:26.390481 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c
[0m01:18:26.390481 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c"
[0m01:18:26.406102 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c"
[0m01:18:26.406102 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select channel_pk as from_field
    from "medical_warehouse"."public_marts"."fact_messages"
    where channel_pk is not null
),

parent as (
    select channel_pk as to_field
    from "medical_warehouse"."public_marts"."dim_channels"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m01:18:26.421724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:26.484210 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.505 seconds
[0m01:18:26.484210 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923: ROLLBACK
[0m01:18:26.484210 [debug] [Thread-3 (]: On test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923: Close
[0m01:18:26.484210 [info ] [Thread-3 (]: 6 of 13 PASS not_null_fact_messages_message_pk ................................. [[32mPASS[0m in 0.62s]
[0m01:18:26.515451 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m01:18:26.515451 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m01:18:26.515451 [info ] [Thread-3 (]: 10 of 13 START test unique_dim_channels_channel_pk ............................. [RUN]
[0m01:18:26.532663 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923, now test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936)
[0m01:18:26.532663 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m01:18:26.574430 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.486 seconds
[0m01:18:26.574430 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: ROLLBACK
[0m01:18:26.574430 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m01:18:26.574430 [debug] [Thread-4 (]: On test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8: Close
[0m01:18:26.590128 [info ] [Thread-4 (]: 7 of 13 PASS not_null_stg_telegram_messages_channel_name ....................... [[32mPASS[0m in 0.55s]
[0m01:18:26.602078 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:18:26.604072 [debug] [Thread-4 (]: Began running node test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7
[0m01:18:26.608813 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m01:18:26.620779 [debug] [Thread-3 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m01:18:26.641233 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.418 seconds
[0m01:18:26.606816 [info ] [Thread-4 (]: 11 of 13 START test unique_dim_dates_date_day .................................. [RUN]
[0m01:18:26.650976 [debug] [Thread-3 (]: Using postgres connection "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m01:18:26.655963 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: ROLLBACK
[0m01:18:26.658957 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8, now test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7)
[0m01:18:26.660866 [debug] [Thread-3 (]: On test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    channel_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_marts"."dim_channels"
where channel_pk is not null
group by channel_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:18:26.660866 [debug] [Thread-2 (]: On test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1: Close
[0m01:18:26.660866 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7
[0m01:18:26.660866 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m01:18:26.674022 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7"
[0m01:18:26.698822 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7
[0m01:18:26.688848 [info ] [Thread-2 (]: 8 of 13 PASS not_null_stg_telegram_messages_message_pk ......................... [[32mPASS[0m in 0.50s]
[0m01:18:26.712272 [debug] [Thread-4 (]: Writing runtime sql for node "test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7"
[0m01:18:26.714266 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m01:18:26.717259 [debug] [Thread-2 (]: Began running node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m01:18:26.720253 [debug] [Thread-4 (]: Using postgres connection "test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7"
[0m01:18:26.723319 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_marts"."dim_dates"
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:18:26.719257 [info ] [Thread-2 (]: 12 of 13 START test unique_fact_messages_message_pk ............................ [RUN]
[0m01:18:26.725760 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m01:18:26.727757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1, now test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d)
[0m01:18:26.729750 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m01:18:26.757664 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m01:18:26.784429 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.362 seconds
[0m01:18:26.785427 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m01:18:26.791263 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c: ROLLBACK
[0m01:18:26.800240 [debug] [Thread-2 (]: Writing runtime sql for node "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m01:18:26.803231 [debug] [Thread-1 (]: On test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c: Close
[0m01:18:26.806223 [info ] [Thread-1 (]: 9 of 13 PASS relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_  [[32mPASS[0m in 0.52s]
[0m01:18:26.807268 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c
[0m01:18:26.807268 [debug] [Thread-2 (]: Using postgres connection "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m01:18:26.807268 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m01:18:26.807268 [debug] [Thread-2 (]: On test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_marts"."fact_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:18:26.822884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m01:18:26.807268 [info ] [Thread-1 (]: 13 of 13 START test unique_stg_telegram_messages_message_pk .................... [RUN]
[0m01:18:26.822884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c, now test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5)
[0m01:18:26.822884 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m01:18:26.840117 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m01:18:26.871772 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m01:18:26.873394 [debug] [Thread-1 (]: Writing runtime sql for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m01:18:27.049891 [debug] [Thread-1 (]: Using postgres connection "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m01:18:27.049891 [debug] [Thread-1 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "node_id": "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    message_pk as unique_field,
    count(*) as n_records

from "medical_warehouse"."public_staging"."stg_telegram_messages"
where message_pk is not null
group by message_pk
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m01:18:27.049891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:18:27.096649 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.435 seconds
[0m01:18:27.096649 [debug] [Thread-3 (]: On test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936: ROLLBACK
[0m01:18:27.096649 [debug] [Thread-3 (]: On test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936: Close
[0m01:18:27.112270 [info ] [Thread-3 (]: 10 of 13 PASS unique_dim_channels_channel_pk ................................... [[32mPASS[0m in 0.58s]
[0m01:18:27.112270 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m01:18:27.172716 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.447 seconds
[0m01:18:27.178468 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7: ROLLBACK
[0m01:18:27.180462 [debug] [Thread-4 (]: On test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7: Close
[0m01:18:27.182458 [info ] [Thread-4 (]: 11 of 13 PASS unique_dim_dates_date_day ........................................ [[32mPASS[0m in 0.52s]
[0m01:18:27.187445 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7
[0m01:18:27.239245 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.416 seconds
[0m01:18:27.242255 [debug] [Thread-2 (]: On test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d: ROLLBACK
[0m01:18:27.243236 [debug] [Thread-2 (]: On test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d: Close
[0m01:18:27.245230 [info ] [Thread-2 (]: 12 of 13 PASS unique_fact_messages_message_pk .................................. [[32mPASS[0m in 0.52s]
[0m01:18:27.248222 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m01:18:27.306827 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.243 seconds
[0m01:18:27.309818 [debug] [Thread-1 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: ROLLBACK
[0m01:18:27.310815 [debug] [Thread-1 (]: On test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5: Close
[0m01:18:27.311812 [info ] [Thread-1 (]: 13 of 13 PASS unique_stg_telegram_messages_message_pk .......................... [[32mPASS[0m in 0.49s]
[0m01:18:27.314806 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m01:18:27.316800 [debug] [MainThread]: On master: COMMIT
[0m01:18:27.317796 [debug] [MainThread]: Using postgres connection "master"
[0m01:18:27.318794 [debug] [MainThread]: On master: COMMIT
[0m01:18:27.319791 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:27.437408 [debug] [MainThread]: SQL status: COMMIT in 0.130 seconds
[0m01:18:27.437408 [debug] [MainThread]: On master: Close
[0m01:18:27.437408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:27.453028 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m01:18:27.453028 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m01:18:27.453028 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5' was properly closed.
[0m01:18:27.453028 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d' was properly closed.
[0m01:18:27.453028 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936' was properly closed.
[0m01:18:27.453028 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7' was properly closed.
[0m01:18:27.453028 [info ] [MainThread]: 
[0m01:18:27.453028 [info ] [MainThread]: Finished running 13 data tests in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m01:18:27.469816 [debug] [MainThread]: Command end result
[0m01:18:27.560870 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m01:18:27.565857 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m01:18:27.573872 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m01:18:27.573872 [info ] [MainThread]: 
[0m01:18:27.573872 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:18:27.573872 [info ] [MainThread]: 
[0m01:18:27.573872 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=13
[0m01:18:27.591011 [debug] [MainThread]: Command `dbt test` succeeded at 01:18:27.591011 after 5.49 seconds
[0m01:18:27.592007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864E70FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864E70FFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002864D7CF110>]}
[0m01:18:27.594263 [debug] [MainThread]: Flushing usage events
[0m01:18:29.096316 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:22:27.858904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C37CBA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C37C9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C37C8710>]}


============================== 01:22:27.921376 | f03433d1-fc3f-4324-8945-467d13056152 ==============================
[0m01:22:27.921376 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:22:27.921376 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt docs generate', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m01:22:29.145989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f03433d1-fc3f-4324-8945-467d13056152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C2FAE150>]}
[0m01:22:29.285843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f03433d1-fc3f-4324-8945-467d13056152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6BFFE84D0>]}
[0m01:22:29.288801 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m01:22:30.046202 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m01:22:30.771284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:22:30.771284 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m01:22:30.771284 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:22:30.849300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f03433d1-fc3f-4324-8945-467d13056152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C4DD0150>]}
[0m01:22:31.427380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f03433d1-fc3f-4324-8945-467d13056152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C4C5C4D0>]}
[0m01:22:31.442945 [info ] [MainThread]: Found 4 models, 13 data tests, 579 macros
[0m01:22:31.442945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f03433d1-fc3f-4324-8945-467d13056152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C4DF7BD0>]}
[0m01:22:31.442945 [info ] [MainThread]: 
[0m01:22:31.442945 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:22:31.442945 [info ] [MainThread]: 
[0m01:22:31.442945 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:22:31.479394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_marts'
[0m01:22:31.479394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_medical_warehouse_public_staging'
[0m01:22:31.936123 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_marts"
[0m01:22:31.937120 [debug] [ThreadPool]: Using postgres connection "list_medical_warehouse_public_staging"
[0m01:22:31.937120 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_marts"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_marts'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_marts'
  
[0m01:22:31.938812 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "list_medical_warehouse_public_staging"} */
select
      'medical_warehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_staging'
    union all
    select
      'medical_warehouse' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_staging'
  
[0m01:22:31.939820 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:31.940811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:33.033836 [debug] [ThreadPool]: SQL status: SELECT 3 in 1.098 seconds
[0m01:22:33.033836 [debug] [ThreadPool]: SQL status: SELECT 1 in 1.098 seconds
[0m01:22:33.033836 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: ROLLBACK
[0m01:22:33.033836 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: ROLLBACK
[0m01:22:33.047184 [debug] [ThreadPool]: On list_medical_warehouse_public_staging: Close
[0m01:22:33.047184 [debug] [ThreadPool]: On list_medical_warehouse_public_marts: Close
[0m01:22:33.079490 [debug] [MainThread]: Using postgres connection "master"
[0m01:22:33.079490 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m01:22:33.079490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:22:33.329518 [debug] [MainThread]: SQL status: SELECT 6 in 0.249 seconds
[0m01:22:33.345107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f03433d1-fc3f-4324-8945-467d13056152', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C52C5B50>]}
[0m01:22:33.345107 [debug] [MainThread]: On master: ROLLBACK
[0m01:22:33.345107 [debug] [MainThread]: On master: Close
[0m01:22:33.407632 [debug] [Thread-1 (]: Began running node model.medical_warehouse.stg_telegram_messages
[0m01:22:33.423182 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.medical_warehouse.stg_telegram_messages'
[0m01:22:33.423182 [debug] [Thread-1 (]: Began compiling node model.medical_warehouse.stg_telegram_messages
[0m01:22:33.438777 [debug] [Thread-1 (]: Writing injected SQL for node "model.medical_warehouse.stg_telegram_messages"
[0m01:22:33.438777 [debug] [Thread-1 (]: Began executing node model.medical_warehouse.stg_telegram_messages
[0m01:22:33.438777 [debug] [Thread-1 (]: Finished running node model.medical_warehouse.stg_telegram_messages
[0m01:22:33.438777 [debug] [Thread-3 (]: Began running node model.medical_warehouse.dim_channels
[0m01:22:33.454396 [debug] [Thread-4 (]: Began running node model.medical_warehouse.dim_dates
[0m01:22:33.454396 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:22:33.454396 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m01:22:33.454396 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_channels'
[0m01:22:33.454396 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.medical_warehouse.dim_dates'
[0m01:22:33.454396 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8'
[0m01:22:33.454396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.stg_telegram_messages, now test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1)
[0m01:22:33.454396 [debug] [Thread-3 (]: Began compiling node model.medical_warehouse.dim_channels
[0m01:22:33.454396 [debug] [Thread-4 (]: Began compiling node model.medical_warehouse.dim_dates
[0m01:22:33.454396 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:22:33.454396 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m01:22:33.563780 [debug] [Thread-3 (]: Writing injected SQL for node "model.medical_warehouse.dim_channels"
[0m01:22:33.563780 [debug] [Thread-4 (]: Writing injected SQL for node "model.medical_warehouse.dim_dates"
[0m01:22:33.594992 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8"
[0m01:22:33.610611 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1"
[0m01:22:33.610611 [debug] [Thread-3 (]: Began executing node model.medical_warehouse.dim_channels
[0m01:22:33.610611 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:22:33.610611 [debug] [Thread-4 (]: Began executing node model.medical_warehouse.dim_dates
[0m01:22:33.610611 [debug] [Thread-3 (]: Finished running node model.medical_warehouse.dim_channels
[0m01:22:33.610611 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m01:22:33.610611 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8
[0m01:22:33.610611 [debug] [Thread-4 (]: Finished running node model.medical_warehouse.dim_dates
[0m01:22:33.626233 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m01:22:33.626233 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1
[0m01:22:33.626233 [debug] [Thread-2 (]: Began running node model.medical_warehouse.fact_messages
[0m01:22:33.626233 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:22:33.626233 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_channels, now test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5)
[0m01:22:33.626233 [debug] [Thread-1 (]: Began running node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m01:22:33.626233 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_channel_name.38886ae8d8, now model.medical_warehouse.fact_messages)
[0m01:22:33.626233 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.dim_dates, now test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b)
[0m01:22:33.626233 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m01:22:33.626233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_stg_telegram_messages_message_pk.a69a444ed1, now test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43)
[0m01:22:33.641854 [debug] [Thread-2 (]: Began compiling node model.medical_warehouse.fact_messages
[0m01:22:33.641854 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:22:33.657476 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5"
[0m01:22:33.657476 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m01:22:33.657476 [debug] [Thread-2 (]: Writing injected SQL for node "model.medical_warehouse.fact_messages"
[0m01:22:33.673130 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b"
[0m01:22:33.673130 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43"
[0m01:22:33.673130 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m01:22:33.688717 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5
[0m01:22:33.688717 [debug] [Thread-3 (]: Began running node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m01:22:33.688717 [debug] [Thread-2 (]: Began executing node model.medical_warehouse.fact_messages
[0m01:22:33.688717 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m01:22:33.688717 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_stg_telegram_messages_message_pk.7e3bbbb6d5, now test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936)
[0m01:22:33.688717 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:22:33.704341 [debug] [Thread-2 (]: Finished running node model.medical_warehouse.fact_messages
[0m01:22:33.704341 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43
[0m01:22:33.704341 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m01:22:33.704341 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b
[0m01:22:33.704341 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb
[0m01:22:33.704341 [debug] [Thread-1 (]: Began running node test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7
[0m01:22:33.719959 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936"
[0m01:22:33.719959 [debug] [Thread-4 (]: Began running node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m01:22:33.719959 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.medical_warehouse.fact_messages, now test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb)
[0m01:22:33.719959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_pk.be608b1d43, now test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7)
[0m01:22:33.719959 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_channels_channel_name.3be3fa8f5b, now test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48)
[0m01:22:33.735580 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m01:22:33.719959 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb
[0m01:22:33.735580 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7
[0m01:22:33.735580 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m01:22:33.735580 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936
[0m01:22:33.735580 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb"
[0m01:22:33.751199 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7"
[0m01:22:33.766823 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48"
[0m01:22:33.766823 [debug] [Thread-3 (]: Began running node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m01:22:33.766823 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_channels_channel_pk.9033eee936, now test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf)
[0m01:22:33.766823 [debug] [Thread-3 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m01:22:33.766823 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb
[0m01:22:33.766823 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7
[0m01:22:33.766823 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m01:22:33.782482 [debug] [Thread-3 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf"
[0m01:22:33.782482 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb
[0m01:22:33.782482 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7
[0m01:22:33.782482 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48
[0m01:22:33.782482 [debug] [Thread-2 (]: Began running node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m01:22:33.782482 [debug] [Thread-1 (]: Began running node test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c
[0m01:22:33.782482 [debug] [Thread-3 (]: Began executing node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m01:22:33.782482 [debug] [Thread-4 (]: Began running node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m01:22:33.798068 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_dim_dates_date_day.1717af99fb, now test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923)
[0m01:22:33.798068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.unique_dim_dates_date_day.5e9dfa95c7, now test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c)
[0m01:22:33.798068 [debug] [Thread-3 (]: Finished running node test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf
[0m01:22:33.798068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.medical_warehouse.not_null_fact_messages_channel_pk.a3d58e5d48, now test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d)
[0m01:22:33.798068 [debug] [Thread-2 (]: Began compiling node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m01:22:33.798068 [debug] [Thread-1 (]: Began compiling node test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c
[0m01:22:33.798068 [debug] [Thread-4 (]: Began compiling node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m01:22:33.798068 [debug] [Thread-2 (]: Writing injected SQL for node "test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923"
[0m01:22:33.829310 [debug] [Thread-1 (]: Writing injected SQL for node "test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c"
[0m01:22:33.829310 [debug] [Thread-4 (]: Writing injected SQL for node "test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d"
[0m01:22:33.829310 [debug] [Thread-2 (]: Began executing node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m01:22:33.829310 [debug] [Thread-2 (]: Finished running node test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923
[0m01:22:33.829310 [debug] [Thread-1 (]: Began executing node test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c
[0m01:22:33.829310 [debug] [Thread-4 (]: Began executing node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m01:22:33.844929 [debug] [Thread-1 (]: Finished running node test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c
[0m01:22:33.844929 [debug] [Thread-4 (]: Finished running node test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d
[0m01:22:33.844929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:22:33.844929 [debug] [MainThread]: Connection 'list_medical_warehouse_public_marts' was properly closed.
[0m01:22:33.844929 [debug] [MainThread]: Connection 'list_medical_warehouse_public_staging' was properly closed.
[0m01:22:33.844929 [debug] [MainThread]: Connection 'test.medical_warehouse.relationships_fact_messages_channel_pk__channel_pk__ref_dim_channels_.54041ac58c' was properly closed.
[0m01:22:33.844929 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_fact_messages_message_date.92b1133bcf' was properly closed.
[0m01:22:33.844929 [debug] [MainThread]: Connection 'test.medical_warehouse.unique_fact_messages_message_pk.f2930adb7d' was properly closed.
[0m01:22:33.844929 [debug] [MainThread]: Connection 'test.medical_warehouse.not_null_fact_messages_message_pk.e37fdff923' was properly closed.
[0m01:22:33.860584 [debug] [MainThread]: Command end result
[0m01:22:34.032391 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m01:22:34.048005 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m01:22:34.063630 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\run_results.json
[0m01:22:34.094909 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m01:22:34.094909 [info ] [MainThread]: Building catalog
[0m01:22:34.117310 [debug] [ThreadPool]: Acquiring new postgres connection 'medical_warehouse.information_schema'
[0m01:22:34.135569 [debug] [ThreadPool]: Using postgres connection "medical_warehouse.information_schema"
[0m01:22:34.135569 [debug] [ThreadPool]: On medical_warehouse.information_schema: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "medical_warehouse", "target_name": "dev", "connection_name": "medical_warehouse.information_schema"} */

    
    

    select
        'medical_warehouse' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_staging') and
           upper(tbl.relname) = upper('stg_telegram_messages')) or (upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('fact_messages')) or (upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('dim_channels')) or (upper(sch.nspname) = upper('public_marts') and
           upper(tbl.relname) = upper('dim_dates')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m01:22:34.135569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:22:34.560532 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.416 seconds
[0m01:22:34.565257 [debug] [ThreadPool]: On medical_warehouse.information_schema: ROLLBACK
[0m01:22:34.566257 [debug] [ThreadPool]: On medical_warehouse.information_schema: Close
[0m01:22:34.600464 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\catalog.json
[0m01:22:34.713517 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\manifest.json
[0m01:22:34.713517 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\semantic_manifest.json
[0m01:22:34.713517 [info ] [MainThread]: Catalog written to C:\Users\bia\Desktop\medical-telegram-warehouse\medical_warehouse\target\catalog.json
[0m01:22:34.737101 [debug] [MainThread]: Command `dbt docs generate` succeeded at 01:22:34.736101 after 7.23 seconds
[0m01:22:34.737845 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m01:22:34.737845 [debug] [MainThread]: Connection 'medical_warehouse.information_schema' was properly closed.
[0m01:22:34.737845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C52BB850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C52BBB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6BCDB36D0>]}
[0m01:22:34.737845 [debug] [MainThread]: Flushing usage events
[0m01:22:37.854800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:22:43.379457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2A9FB6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2AA30550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2A9F8090>]}


============================== 01:22:43.395042 | 0083e201-246d-4917-898d-d1c340c3bd06 ==============================
[0m01:22:43.395042 [info ] [MainThread]: Running with dbt=1.11.2
[0m01:22:43.395042 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt docs serve', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m01:22:43.767520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0083e201-246d-4917-898d-d1c340c3bd06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2BBD8050>]}
[0m01:22:43.876871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0083e201-246d-4917-898d-d1c340c3bd06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD27228750>]}
[0m01:22:45.271923 [error] [MainThread]: Encountered an error:
[WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions
[0m01:22:45.380104 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 456, in __init__
    self.server_bind()
  File "C:\Users\bia\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
PermissionError: [WinError 10013] An attempt was made to access a socket in a way forbidden by its access permissions

[0m01:22:45.396664 [debug] [MainThread]: Command `dbt docs serve` failed at 01:22:45.396664 after 2.21 seconds
[0m01:22:45.396664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2AA83E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2AA83F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2A9FBC90>]}
[0m01:22:45.396664 [debug] [MainThread]: Flushing usage events
[0m01:22:47.357323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:21:46.564511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CB9C38910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CB9C393D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CB9C3AED0>]}


============================== 08:21:46.673973 | 50b0ae1b-2bf8-426c-82f7-fe0119087f71 ==============================
[0m08:21:46.673973 [info ] [MainThread]: Running with dbt=1.11.2
[0m08:21:46.673973 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse', 'invocation_command': 'dbt docs serve --port 8081', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'C:\\Users\\bia\\Desktop\\medical-telegram-warehouse\\medical_warehouse\\logs'}
[0m08:21:50.884894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50b0ae1b-2bf8-426c-82f7-fe0119087f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBAD59450>]}
[0m08:21:51.064838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50b0ae1b-2bf8-426c-82f7-fe0119087f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CB6468310>]}
[0m08:50:04.390982 [error] [MainThread]: Encountered an error:

[0m08:50:07.397345 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\bia\Desktop\medical-telegram-warehouse\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\bia\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\bia\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m08:50:08.447360 [debug] [MainThread]: Command `dbt docs serve` failed at 08:50:08.230624 after 1702.57 seconds
[0m08:50:11.221255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CB9C40990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CBAFD4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019CB99D5810>]}
[0m08:50:11.751338 [debug] [MainThread]: Flushing usage events
[0m08:50:41.746826 [debug] [MainThread]: An error was encountered while trying to flush usage events
